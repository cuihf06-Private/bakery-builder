<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ğŸ é¢åŒ…å·¥åŠæé€Ÿç‰ˆ</title>
  <style>
    /* ==================== å…¨å±€é‡ç½® ==================== */
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    /* ==================== å“åº”å¼æ ¹å­—ä½“å¤§å° ==================== */
    /* åŸºäºè§†å£å®½åº¦åŠ¨æ€è°ƒæ•´å­—ä½“å¤§å° */
    html {
      font-size: calc(14px + 0.4vw); /* åŸºç¡€å­—ä½“ï¼š14px + è§†å£å®½åº¦çš„0.4% */
      height: 100vh; /* å æ»¡æ•´ä¸ªè§†å£é«˜åº¦ */
      overflow: hidden; /* ç¦æ­¢é¡µé¢æ»šåŠ¨ */
    }

    /* å°å±å¹•ï¼ˆå®½åº¦<768pxï¼‰å­—ä½“è°ƒæ•´ */
    @media (max-width: 768px) {
      html {
        font-size: calc(12px + 0.5vw); /* å°å±åŸºç¡€å­—ä½“ï¼š12px + è§†å£å®½åº¦çš„0.5% */
      }
    }

    /* å¤§å±å¹•ï¼ˆå®½åº¦>=1920pxï¼‰å­—ä½“å›ºå®š */
    @media (min-width: 1920px) {
      html {
        font-size: 20px; /* å¤§å±å›ºå®šå­—ä½“å¤§å° */
      }
    }

    /* ==================== é¡µé¢ä¸»ä½“ ==================== */
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: linear-gradient(135deg, #F5DEB3 0%, #DEB887 100%); /* æ¸å˜èƒŒæ™¯è‰² */
      height: 100vh; /* å æ»¡æ•´ä¸ªè§†å£é«˜åº¦ */
      overflow: hidden; /* ç¦æ­¢é¡µé¢æ»šåŠ¨ */
      display: flex;
      flex-direction: column; /* å‚ç›´æ’åˆ—ï¼šé¡¶æ  + æ¸¸æˆåŒº */
    }

    /* ==================== é¡¶éƒ¨çŠ¶æ€æ  ==================== */
    /* å›ºå®šå å±å¹•çºµå‘8%é«˜åº¦ */
    .header {
      background: #8B4513; /* æ£•è‰²èƒŒæ™¯ */
      color: white;
      height: 8vh; /* å è§†å£é«˜åº¦çš„8% */
      min-height: 8vh; /* æœ€å°é«˜åº¦8vhï¼Œé˜²æ­¢å‹ç¼© */
      max-height: 8vh; /* æœ€å¤§é«˜åº¦8vhï¼Œé˜²æ­¢æ‹‰ä¼¸ */
      padding: 0 1.2rem; /* å·¦å³å†…è¾¹è·1.2rem */
      display: flex;
      justify-content: space-between; /* å­å…ƒç´ ä¸¤ç«¯å¯¹é½ */
      align-items: center; /* å­å…ƒç´ å‚ç›´å±…ä¸­ */
      box-shadow: 0 0.12rem 0.6rem rgba(0,0,0,0.3); /* åº•éƒ¨é˜´å½±ï¼šå‚ç›´åç§»0.12remï¼Œæ¨¡ç³Š0.6rem */
      flex-wrap: nowrap; /* ä¸æ¢è¡Œ */
      gap: 0.5rem; /* å­å…ƒç´ é—´è·0.5rem */
      flex-shrink: 0; /* ä¸å…è®¸å‹ç¼© */
    }

    /* é¡¶æ ä¸­çš„å•ä¸ªé¡¹ç›®ï¼ˆé‡‘å¸ã€å±€æ•°ç­‰ï¼‰ */
    .header-item {
      display: flex;
      align-items: center; /* å‚ç›´å±…ä¸­ */
      gap: 0.5rem; /* å›¾æ ‡ä¸æ–‡å­—é—´è·0.5rem */
      font-size: 0.9rem; /* æ–‡å­—å¤§å°0.9rem */
      font-weight: bold;
      white-space: nowrap; /* ä¸æ¢è¡Œ */
    }

    /* é¡¶æ é¡¹ç›®ä¸­çš„å›¾æ ‡ */
    .header-item span {
      font-size: 1.2rem; /* å›¾æ ‡å¤§å°1.2rem */
    }

    /* è®¡æ—¶å™¨æ ·å¼ */
    .timer {
      background: #D2691E; /* æ·±æ©™è‰²èƒŒæ™¯ */
      padding: 0.3rem 0.9rem; /* ä¸Šä¸‹0.3remï¼Œå·¦å³0.9rem */
      border-radius: 1.2rem; /* åœ†è§’1.2rem */
      font-size: 1rem; /* å­—ä½“å¤§å°1rem */
      white-space: nowrap; /* ä¸æ¢è¡Œ */
    }

    /* ==================== ä¸»æ¸¸æˆåŒº ==================== */
    /* å æ®å‰©ä½™92%é«˜åº¦ */
    #game {
      display: flex;
      height: 92vh; /* å è§†å£é«˜åº¦çš„92%ï¼ˆ100% - é¡¶æ 8%ï¼‰ */
      padding: 0.2rem; /* å†…è¾¹è·0.2rem */
      gap: 0.2rem; /* å››ä¸ªåŒºåŸŸä¹‹é—´çš„é—´è·0.2rem */
      flex-wrap: nowrap; /* ä¸æ¢è¡Œ */
      overflow: hidden; /* éšè—æº¢å‡º */
      flex-shrink: 0; /* ä¸å…è®¸å‹ç¼© */
    }

    /* ==================== å››æ å¸ƒå±€ ==================== */
    /* å†œç”°åŒºã€åˆ¶ä½œåŒºã€ææ–™åŒºã€å”®å–åŒº - æ¨ªå‘å„å 24.5% */
    .field, .kitchen, .market, .shop {
      background: rgba(255, 255, 255, 0.9); /* åŠé€æ˜ç™½è‰²èƒŒæ™¯ */
      border-radius: 0.4rem; /* åœ†è§’0.4rem */
      padding: 0.4rem; /* å†…è¾¹è·0.4rem */
      box-shadow: 0 0.25rem 0.9rem rgba(0,0,0,0.1); /* é˜´å½±ï¼šå‚ç›´åç§»0.25remï¼Œæ¨¡ç³Š0.9rem */
      overflow-y: auto; /* çºµå‘æ»šåŠ¨ */
      overflow-x: hidden; /* æ¨ªå‘éšè—æº¢å‡º */
      width: 24.5%; /* å®½åº¦å 24.5% */
      min-width: 24.5%; /* æœ€å°å®½åº¦24.5%ï¼Œé˜²æ­¢å‹ç¼© */
      max-width: 24.5%; /* æœ€å¤§å®½åº¦24.5%ï¼Œé˜²æ­¢æ‹‰ä¼¸ */
      height: 100%; /* é«˜åº¦å æ»¡çˆ¶å®¹å™¨ */
      display: flex;
      flex-direction: column; /* å‚ç›´æ’åˆ—å­å…ƒç´  */
    }

    /* å±å¹•é«˜åº¦<800pxæ—¶ï¼Œå‡å°å››æ å†…è¾¹è· */
    @media (max-height: 800px) {
      .field, .kitchen, .market, .shop {
        padding: 0.3rem; /* å†…è¾¹è·ç¼©å°åˆ°0.3rem */
      }
    }

    /* å±å¹•é«˜åº¦<600pxæ—¶ï¼Œè¿›ä¸€æ­¥å‡å°å››æ å†…è¾¹è· */
    @media (max-height: 600px) {
      .field, .kitchen, .market, .shop {
        padding: 0.25rem; /* å†…è¾¹è·ç¼©å°åˆ°0.25rem */
      }
    }

    /* ==================== åŒºåŸŸæ ‡é¢˜ ==================== */
    /* æ¯ä¸ªåŒºåŸŸçš„æ ‡é¢˜ï¼ˆ"å†œç”°åŒº"ã€"åˆ¶ä½œåŒº"ç­‰ï¼‰ - å æœ¬åŒºåŸŸçºµå‘6% */
    .section-title {
      text-align: center; /* æ–‡å­—å±…ä¸­ */
      font-size: 1.1rem; /* å­—ä½“å¤§å°1.1rem */
      font-weight: bold;
      color: #8B4513; /* æ£•è‰²æ–‡å­— */
      margin-bottom: 0.5rem; /* åº•éƒ¨å¤–è¾¹è·0.5rem */
      padding-bottom: 0.3rem; /* åº•éƒ¨å†…è¾¹è·0.3rem */
      border-bottom: 0.12rem solid #DEB887; /* åº•éƒ¨è¾¹æ¡†ï¼šå®½åº¦0.12rem */
      height: 6%; /* å çˆ¶å®¹å™¨é«˜åº¦çš„6% */
      min-height: 6%; /* æœ€å°é«˜åº¦6%ï¼Œé˜²æ­¢å‹ç¼© */
      max-height: 6%; /* æœ€å¤§é«˜åº¦6%ï¼Œé˜²æ­¢æ‹‰ä¼¸ */
      flex-shrink: 0; /* ä¸å…è®¸å‹ç¼© */
      display: flex;
      align-items: center; /* å‚ç›´å±…ä¸­ */
      justify-content: center; /* æ°´å¹³å±…ä¸­ */
    }

    /* å±å¹•é«˜åº¦<800pxæ—¶ï¼Œç¼©å°æ ‡é¢˜ */
    @media (max-height: 800px) {
      .section-title {
        font-size: 1rem; /* å­—ä½“ç¼©å°åˆ°1rem */
        margin-bottom: 0.3rem; /* åº•éƒ¨å¤–è¾¹è·ç¼©å°åˆ°0.3rem */
        padding-bottom: 0.2rem; /* åº•éƒ¨å†…è¾¹è·ç¼©å°åˆ°0.2rem */
      }
    }

    /* å±å¹•é«˜åº¦<600pxæ—¶ï¼Œè¿›ä¸€æ­¥ç¼©å°æ ‡é¢˜ */
    @media (max-height: 600px) {
      .section-title {
        font-size: 0.9rem; /* å­—ä½“ç¼©å°åˆ°0.9rem */
        margin-bottom: 0.2rem; /* åº•éƒ¨å¤–è¾¹è·ç¼©å°åˆ°0.2rem */
        padding-bottom: 0.15rem; /* åº•éƒ¨å†…è¾¹è·ç¼©å°åˆ°0.15rem */
      }
    }

    /* ==================== å†œç”°åŒº ==================== */
    .field {
      gap: 0.3rem; /* å†œç”°åŒºå­å…ƒç´ ä¹‹é—´çš„é—´è·0.3rem */
    }

    /* å±å¹•é«˜åº¦<800pxæ—¶ï¼Œç¼©å°å†œç”°åŒºé—´è· */
    @media (max-height: 800px) {
      .field {
        gap: 0.2rem; /* é—´è·ç¼©å°åˆ°0.2rem */
      }
    }

    /* å±å¹•é«˜åº¦<600pxæ—¶ï¼Œè¿›ä¸€æ­¥ç¼©å°å†œç”°åŒºé—´è· */
    @media (max-height: 600px) {
      .field {
        gap: 0.15rem; /* é—´è·ç¼©å°åˆ°0.15rem */
      }
    }

    /* ==================== ç§å­é€‰æ‹©æ  ==================== */
    /* 2x2ç½‘æ ¼å¸ƒå±€ï¼šå°éº¦/å¥¶ç‰›ä¸€è¡Œï¼Œç”˜è”—/æ¯é¸¡ä¸€è¡Œ */
    .seeds-bar {
      display: grid;
      grid-template-columns: repeat(2, 1fr); /* 2åˆ—ï¼Œæ¯åˆ—ç­‰å®½ */
      grid-template-rows: repeat(2, 1fr); /* 2è¡Œï¼Œæ¯è¡Œç­‰é«˜ */
      gap: 0.4rem; /* ç½‘æ ¼é—´è·0.4rem */
      margin-bottom: 0.3rem; /* åº•éƒ¨å¤–è¾¹è·0.3rem */
      padding: 0.5rem; /* å†…è¾¹è·0.5rem */
      background: #FFF8DC; /* æµ…é»„è‰²èƒŒæ™¯ */
      border-radius: 0.6rem; /* åœ†è§’0.6rem */
      flex-shrink: 0; /* ä¸å…è®¸å‹ç¼© */
    }

    /* å±å¹•é«˜åº¦<800pxæ—¶ï¼Œç¼©å°ç§å­æ  */
    @media (max-height: 800px) {
      .seeds-bar {
        margin-bottom: 0.2rem; /* åº•éƒ¨å¤–è¾¹è·ç¼©å°åˆ°0.2rem */
        padding: 0.4rem; /* å†…è¾¹è·ç¼©å°åˆ°0.4rem */
        gap: 0.3rem; /* ç½‘æ ¼é—´è·ç¼©å°åˆ°0.3rem */
      }
    }

    /* å±å¹•é«˜åº¦<600pxæ—¶ï¼Œè¿›ä¸€æ­¥ç¼©å°ç§å­æ  */
    @media (max-height: 600px) {
      .seeds-bar {
        margin-bottom: 0.15rem; /* åº•éƒ¨å¤–è¾¹è·ç¼©å°åˆ°0.15rem */
        padding: 0.3rem; /* å†…è¾¹è·ç¼©å°åˆ°0.3rem */
        gap: 0.2rem; /* ç½‘æ ¼é—´è·ç¼©å°åˆ°0.2rem */
      }
    }

    /* ==================== å•ä¸ªç§å­é¡¹ ==================== */
    .seed-item {
      display: flex;
      align-items: center; /* å‚ç›´å±…ä¸­ */
      justify-content: center; /* æ°´å¹³å±…ä¸­ */
      gap: 0.25rem; /* å›¾æ ‡ä¸æ–‡å­—é—´è·0.25rem */
      padding: 0.3rem 0.4rem; /* ä¸Šä¸‹0.3remï¼Œå·¦å³0.4rem */
      background: white; /* ç™½è‰²èƒŒæ™¯ */
      border-radius: 1.2rem; /* åœ†è§’1.2rem */
      border: 0.12rem solid #DEB887; /* è¾¹æ¡†å®½åº¦0.12rem */
      cursor: pointer; /* é¼ æ ‡æŒ‡é’ˆ */
      transition: all 0.3s; /* è¿‡æ¸¡åŠ¨ç”»0.3ç§’ */
      font-size: 0.75rem; /* å­—ä½“å¤§å°0.75rem */
      white-space: nowrap; /* ä¸æ¢è¡Œ */
      overflow: hidden; /* éšè—æº¢å‡º */
    }

    /* å±å¹•é«˜åº¦<800pxæ—¶ï¼Œç¼©å°ç§å­é¡¹ */
    @media (max-height: 800px) {
      .seed-item {
        padding: 0.25rem 0.35rem; /* ä¸Šä¸‹0.25remï¼Œå·¦å³0.35rem */
        font-size: 0.7rem; /* å­—ä½“ç¼©å°åˆ°0.7rem */
        gap: 0.2rem; /* é—´è·ç¼©å°åˆ°0.2rem */
      }
      .seed-item span:first-child {
        font-size: 1.3rem; /* emojiå›¾æ ‡ç¼©å°åˆ°1.3rem */
      }
    }

    /* å±å¹•é«˜åº¦<600pxæ—¶ï¼Œè¿›ä¸€æ­¥ç¼©å°ç§å­é¡¹ */
    @media (max-height: 600px) {
      .seed-item {
        padding: 0.2rem 0.3rem; /* ä¸Šä¸‹0.2remï¼Œå·¦å³0.3rem */
        font-size: 0.65rem; /* å­—ä½“ç¼©å°åˆ°0.65rem */
        gap: 0.15rem; /* é—´è·ç¼©å°åˆ°0.15rem */
      }
      .seed-item span:first-child {
        font-size: 1.1rem; /* emojiå›¾æ ‡ç¼©å°åˆ°1.1rem */
      }
    }

    .seed-item span {
      flex-shrink: 0; /* ä¸å…è®¸å‹ç¼© */
    }

    /* ç§å­é¡¹ä¸­çš„emojiå›¾æ ‡ */
    .seed-item span:first-child {
      font-size: 1.2rem; /* emojiå›¾æ ‡å¤§å°1.2rem */
    }

    /* ==================== ç§å­é¡¹ç½‘æ ¼å®šä½ ==================== */
    /* ç¬¬1ä¸ªç§å­ï¼ˆå°éº¦ï¼‰ï¼šç¬¬1åˆ—ç¬¬1è¡Œ */
    .seed-item:nth-child(1) {
      grid-column: 1;
      grid-row: 1;
    }

    /* ç¬¬2ä¸ªç§å­ï¼ˆå¥¶ç‰›ï¼‰ï¼šç¬¬2åˆ—ç¬¬1è¡Œ */
    .seed-item:nth-child(2) {
      grid-column: 2;
      grid-row: 1;
    }

    /* ç¬¬3ä¸ªç§å­ï¼ˆç”˜è”—ï¼‰ï¼šç¬¬1åˆ—ç¬¬2è¡Œ */
    .seed-item:nth-child(3) {
      grid-column: 1;
      grid-row: 2;
    }

    /* ç¬¬4ä¸ªç§å­ï¼ˆæ¯é¸¡ï¼‰ï¼šç¬¬2åˆ—ç¬¬2è¡Œ */
    .seed-item:nth-child(4) {
      grid-column: 2;
      grid-row: 2;
    }

    /* ==================== ç§å­é¡¹äº¤äº’çŠ¶æ€ ==================== */
    /* é¼ æ ‡æ‚¬åœæ•ˆæœ */
    .seed-item:hover {
      transform: scale(1.05); /* æ”¾å¤§åˆ°105% */
      border-color: #8B4513; /* è¾¹æ¡†å˜ä¸ºæ·±æ£•è‰² */
    }

    /* é”å®šçŠ¶æ€ï¼ˆæœªè§£é”çš„ç§å­ï¼‰ */
    .seed-item.locked {
      opacity: 0.5; /* åŠé€æ˜ */
      cursor: not-allowed; /* ç¦æ­¢å…‰æ ‡ */
    }

    /* é€‰ä¸­çŠ¶æ€ */
    .seed-item.selected {
      background: #F5DEB3; /* æµ…æ£•è‰²èƒŒæ™¯ */
      border-color: #8B4513; /* æ·±æ£•è‰²è¾¹æ¡† */
      box-shadow: 0 0 0.5rem rgba(139, 69, 19, 0.4); /* å‘å…‰æ•ˆæœï¼šæ¨¡ç³Š0.5rem */
    }

    /* "æ— é™"æ ‡è®° */
    .seed-item .unlimited {
      font-size: 0.6rem; /* å­—ä½“å¤§å°0.6rem */
      color: #2E8B57; /* ç»¿è‰²æ–‡å­— */
      font-weight: bold;
      flex-shrink: 0; /* ä¸å…è®¸å‹ç¼© */
    }

    /* ==================== å†œç”°ä¹å®«æ ¼ ==================== */
    /* 3x3ç½‘æ ¼å¸ƒå±€ï¼Œä¿æŒæ­£æ–¹å½¢ */
    .farm-grid {
      display: grid;
      grid-template-columns: repeat(3, 1fr); /* 3åˆ—ï¼Œæ¯åˆ—ç­‰å®½ */
      grid-template-rows: repeat(3, 1fr); /* 3è¡Œï¼Œæ¯è¡Œç­‰é«˜ */
      gap: 0.5rem; /* ç½‘æ ¼é—´è·0.5rem */
      flex: 0 1 auto; /* å…è®¸ç¼©å°ä½†ä¸æ”¾å¤§ */
      align-content: start; /* å†…å®¹é¡¶éƒ¨å¯¹é½ */
      justify-content: center; /* å†…å®¹æ°´å¹³å±…ä¸­ */
      min-height: 0; /* æœ€å°é«˜åº¦0ï¼Œå…è®¸å®Œå…¨å‹ç¼© */
      width: 100%; /* å®½åº¦å æ»¡çˆ¶å®¹å™¨ */
      aspect-ratio: 1; /* å®½é«˜æ¯”1:1ï¼Œä¿æŒæ­£æ–¹å½¢ */
      max-width: 100%; /* æœ€å¤§å®½åº¦100% */
      margin: 0 auto; /* æ°´å¹³å±…ä¸­ */
    }

    /* å±å¹•é«˜åº¦<800pxæ—¶ï¼Œç¼©å°ä¹å®«æ ¼é—´è· */
    @media (max-height: 800px) {
      .farm-grid {
        gap: 0.4rem; /* é—´è·ç¼©å°åˆ°0.4rem */
      }
    }

    /* å±å¹•é«˜åº¦<700pxæ—¶ï¼Œè¿›ä¸€æ­¥ç¼©å°ä¹å®«æ ¼é—´è· */
    @media (max-height: 700px) {
      .farm-grid {
        gap: 0.35rem; /* é—´è·ç¼©å°åˆ°0.35rem */
      }
    }

    /* å±å¹•é«˜åº¦<600pxæ—¶ï¼Œç»§ç»­ç¼©å°ä¹å®«æ ¼é—´è· */
    @media (max-height: 600px) {
      .farm-grid {
        gap: 0.3rem; /* é—´è·ç¼©å°åˆ°0.3rem */
      }
    }

    /* å±å¹•é«˜åº¦<500pxæ—¶ï¼Œæœ€å°ä¹å®«æ ¼é—´è· */
    @media (max-height: 500px) {
      .farm-grid {
        gap: 0.25rem; /* é—´è·ç¼©å°åˆ°0.25rem */
      }
    }

    /* ==================== å•ä¸ªå†œç”°æ ¼å­ ==================== */
    .farm-plot {
      aspect-ratio: 1; /* å®½é«˜æ¯”1:1ï¼Œä¿æŒæ­£æ–¹å½¢ */
      background: #D2691E; /* æ·±æ©™è‰²èƒŒæ™¯ï¼ˆç©ºåœ°ï¼‰ */
      border-radius: 0.6rem; /* åœ†è§’0.6rem */
      display: flex;
      flex-direction: column; /* å‚ç›´æ’åˆ—å­å…ƒç´  */
      align-items: center; /* æ°´å¹³å±…ä¸­ */
      justify-content: center; /* å‚ç›´å±…ä¸­ */
      cursor: pointer; /* é¼ æ ‡æŒ‡é’ˆ */
      transition: all 0.3s; /* è¿‡æ¸¡åŠ¨ç”»0.3ç§’ */
      border: 0.18rem solid transparent; /* é€æ˜è¾¹æ¡†ï¼Œå®½åº¦0.18rem */
      position: relative; /* ç›¸å¯¹å®šä½ï¼Œç”¨äºå­å…ƒç´ ç»å¯¹å®šä½ */
      overflow: hidden; /* éšè—æº¢å‡º */
      min-height: 0; /* æœ€å°é«˜åº¦0ï¼Œå…è®¸å®Œå…¨å‹ç¼© */
      min-width: 0; /* æœ€å°å®½åº¦0ï¼Œå…è®¸å®Œå…¨å‹ç¼© */
      width: 100%; /* å®½åº¦å æ»¡çˆ¶å®¹å™¨ */
      height: 100%; /* é«˜åº¦å æ»¡çˆ¶å®¹å™¨ */
    }

    /* å±å¹•é«˜åº¦<800pxæ—¶ï¼Œç¼©å°å†œç”°æ ¼å­ */
    @media (max-height: 800px) {
      .farm-plot {
        border-radius: 0.5rem; /* åœ†è§’ç¼©å°åˆ°0.5rem */
        border-width: 0.15rem; /* è¾¹æ¡†å®½åº¦ç¼©å°åˆ°0.15rem */
      }
    }

    /* å±å¹•é«˜åº¦<700pxæ—¶ï¼Œè¿›ä¸€æ­¥ç¼©å°å†œç”°æ ¼å­ */
    @media (max-height: 700px) {
      .farm-plot {
        border-radius: 0.45rem; /* åœ†è§’ç¼©å°åˆ°0.45rem */
        border-width: 0.14rem; /* è¾¹æ¡†å®½åº¦ç¼©å°åˆ°0.14rem */
      }
    }

    /* å±å¹•é«˜åº¦<600pxæ—¶ï¼Œç»§ç»­ç¼©å°å†œç”°æ ¼å­ */
    @media (max-height: 600px) {
      .farm-plot {
        border-radius: 0.4rem; /* åœ†è§’ç¼©å°åˆ°0.4rem */
        border-width: 0.12rem; /* è¾¹æ¡†å®½åº¦ç¼©å°åˆ°0.12rem */
      }
    }

    /* å±å¹•é«˜åº¦<500pxæ—¶ï¼Œæœ€å°å†œç”°æ ¼å­ */
    @media (max-height: 500px) {
      .farm-plot {
        border-radius: 0.35rem; /* åœ†è§’ç¼©å°åˆ°0.35rem */
        border-width: 0.1rem; /* è¾¹æ¡†å®½åº¦ç¼©å°åˆ°0.1rem */
      }
    }

    /* ==================== å†œç”°æ ¼å­äº¤äº’çŠ¶æ€ ==================== */
    /* é¼ æ ‡æ‚¬åœæ•ˆæœ */
    .farm-plot:hover {
      transform: scale(1.02); /* æ”¾å¤§åˆ°102% */
      border-color: #8B4513; /* è¾¹æ¡†å˜ä¸ºæ·±æ£•è‰² */
    }

    /* å·²ç§æ¤çŠ¶æ€ */
    .farm-plot.planted {
      background: #8B4513; /* æ·±æ£•è‰²èƒŒæ™¯ */
    }

    /* æˆç†Ÿå¯æ”¶è·çŠ¶æ€ */
    .farm-plot.ready {
      animation: blink 1s infinite; /* é—ªçƒåŠ¨ç”»ï¼Œ1ç§’å¾ªç¯ */
      border-color: #FFD700; /* é‡‘è‰²è¾¹æ¡† */
    }

    /* é—ªçƒåŠ¨ç”»å®šä¹‰ */
    @keyframes blink {
      0%, 100% { box-shadow: 0 0 0.6rem #FFD700; } /* å¼€å§‹å’Œç»“æŸï¼šå‘å…‰0.6rem */
      50% { box-shadow: 0 0 1.5rem #FFD700; } /* ä¸­é—´ï¼šå‘å…‰1.5rem */
    }

    /* ==================== ä½œç‰©å›¾æ ‡ ==================== */
    .crop-icon {
      font-size: 2.64rem; /* å›¾æ ‡å¤§å°2.64rem (2.2 * 1.2) */
      margin-bottom: 0.2rem; /* åº•éƒ¨å¤–è¾¹è·0.2rem */
    }

    /* å±å¹•é«˜åº¦<800pxæ—¶ï¼Œç¼©å°ä½œç‰©å›¾æ ‡ */
    @media (max-height: 800px) {
      .crop-icon {
        font-size: 2.28rem; /* å›¾æ ‡ç¼©å°åˆ°2.28rem (1.9 * 1.2) */
        margin-bottom: 0.15rem; /* åº•éƒ¨å¤–è¾¹è·ç¼©å°åˆ°0.15rem */
      }
    }

    /* å±å¹•é«˜åº¦<700pxæ—¶ï¼Œè¿›ä¸€æ­¥ç¼©å°ä½œç‰©å›¾æ ‡ */
    @media (max-height: 700px) {
      .crop-icon {
        font-size: 2.1rem; /* å›¾æ ‡ç¼©å°åˆ°2.1rem (1.75 * 1.2) */
        margin-bottom: 0.12rem; /* åº•éƒ¨å¤–è¾¹è·ç¼©å°åˆ°0.12rem */
      }
    }

    /* å±å¹•é«˜åº¦<600pxæ—¶ï¼Œç»§ç»­ç¼©å°ä½œç‰©å›¾æ ‡ */
    @media (max-height: 600px) {
      .crop-icon {
        font-size: 1.92rem; /* å›¾æ ‡ç¼©å°åˆ°1.92rem (1.6 * 1.2) */
        margin-bottom: 0.1rem; /* åº•éƒ¨å¤–è¾¹è·ç¼©å°åˆ°0.1rem */
      }
    }

    /* å±å¹•é«˜åº¦<500pxæ—¶ï¼Œæœ€å°ä½œç‰©å›¾æ ‡ */
    @media (max-height: 500px) {
      .crop-icon {
        font-size: 1.62rem; /* å›¾æ ‡ç¼©å°åˆ°1.62rem (1.35 * 1.2) */
        margin-bottom: 0.08rem; /* åº•éƒ¨å¤–è¾¹è·ç¼©å°åˆ°0.08rem */
      }
    }

    /* ==================== ç”Ÿé•¿è¿›åº¦æ¡ ==================== */
    .progress-bar {
      width: 80%; /* å®½åº¦å æ ¼å­çš„80% */
      height: 0.3rem; /* é«˜åº¦0.3rem */
      background: rgba(255,255,255,0.3); /* åŠé€æ˜ç™½è‰²èƒŒæ™¯ */
      border-radius: 0.18rem; /* åœ†è§’0.18rem */
      overflow: hidden; /* éšè—æº¢å‡º */
    }

    /* å±å¹•é«˜åº¦<700pxæ—¶ï¼Œç¼©å°è¿›åº¦æ¡ */
    @media (max-height: 700px) {
      .progress-bar {
        height: 0.25rem; /* é«˜åº¦ç¼©å°åˆ°0.25rem */
        width: 75%; /* å®½åº¦ç¼©å°åˆ°75% */
      }
    }

    /* å±å¹•é«˜åº¦<500pxæ—¶ï¼Œæœ€å°è¿›åº¦æ¡ */
    @media (max-height: 500px) {
      .progress-bar {
        height: 0.2rem; /* é«˜åº¦ç¼©å°åˆ°0.2rem */
        width: 70%; /* å®½åº¦ç¼©å°åˆ°70% */
      }
    }

    /* è¿›åº¦æ¡å¡«å……éƒ¨åˆ† */
    .progress-fill {
      height: 100%; /* é«˜åº¦å æ»¡è¿›åº¦æ¡ */
      background: #90EE90; /* æµ…ç»¿è‰² */
      border-radius: 0.18rem; /* åœ†è§’0.18rem */
      transition: width 0.3s; /* å®½åº¦å˜åŒ–è¿‡æ¸¡0.3ç§’ */
    }

    /* ==================== æ ¼å­çŠ¶æ€æ–‡å­— ==================== */
    .plot-status {
      font-size: 0.6rem; /* å­—ä½“å¤§å°0.6rem */
      color: white; /* ç™½è‰²æ–‡å­— */
      margin-top: 0.12rem; /* é¡¶éƒ¨å¤–è¾¹è·0.12rem */
    }

    /* å±å¹•é«˜åº¦<800pxæ—¶ï¼Œç¼©å°çŠ¶æ€æ–‡å­— */
    @media (max-height: 800px) {
      .plot-status {
        font-size: 0.55rem; /* å­—ä½“ç¼©å°åˆ°0.55rem */
        margin-top: 0.1rem; /* é¡¶éƒ¨å¤–è¾¹è·ç¼©å°åˆ°0.1rem */
      }
    }

    /* å±å¹•é«˜åº¦<700pxæ—¶ï¼Œè¿›ä¸€æ­¥ç¼©å°çŠ¶æ€æ–‡å­— */
    @media (max-height: 700px) {
      .plot-status {
        font-size: 0.52rem; /* å­—ä½“ç¼©å°åˆ°0.52rem */
        margin-top: 0.09rem; /* é¡¶éƒ¨å¤–è¾¹è·ç¼©å°åˆ°0.09rem */
      }
    }

    /* å±å¹•é«˜åº¦<600pxæ—¶ï¼Œç»§ç»­ç¼©å°çŠ¶æ€æ–‡å­— */
    @media (max-height: 600px) {
      .plot-status {
        font-size: 0.5rem; /* å­—ä½“ç¼©å°åˆ°0.5rem */
        margin-top: 0.08rem; /* é¡¶éƒ¨å¤–è¾¹è·ç¼©å°åˆ°0.08rem */
      }
    }

    /* å±å¹•é«˜åº¦<500pxæ—¶ï¼Œæœ€å°çŠ¶æ€æ–‡å­— */
    @media (max-height: 500px) {
      .plot-status {
        font-size: 0.45rem; /* å­—ä½“ç¼©å°åˆ°0.45rem */
        margin-top: 0.06rem; /* é¡¶éƒ¨å¤–è¾¹è·ç¼©å°åˆ°0.06rem */
      }
    }

    /* ==================== åŸæ–™ä»“åº“ï¼ˆææ–™åŒºï¼‰ ==================== */
    .inventory-box {
      background: #FFF8DC; /* æµ…é»„è‰²èƒŒæ™¯ */
      border-radius: 0.6rem; /* åœ†è§’0.6rem */
      padding: 0.4rem 0.6rem; /* ä¸Šä¸‹0.4remï¼Œå·¦å³0.6rem */
      margin-bottom: 0.5rem; /* åº•éƒ¨å¤–è¾¹è·0.5rem */
      flex-shrink: 0; /* ä¸å…è®¸å‹ç¼© */
      display: flex;
      flex-direction: column; /* å‚ç›´æ’åˆ—å­å…ƒç´  */
      min-height: auto; /* æœ€å°é«˜åº¦è‡ªåŠ¨ï¼Œæ ¹æ®å†…å®¹è°ƒæ•´ */
    }

    /* ä»“åº“/é…æ–¹/åˆ¶ä½œæ ‡é¢˜ */
    .inventory-title {
      font-size: 0.8rem; /* å­—ä½“å¤§å°0.8rem */
      color: #8B4513; /* æ£•è‰²æ–‡å­— */
      font-weight: bold;
      flex-shrink: 0; /* ä¸å…è®¸å‹ç¼© */
      white-space: nowrap; /* ä¸æ¢è¡Œ */
      margin-bottom: 0.3rem; /* åº•éƒ¨å¤–è¾¹è·0.3rem */
    }

    /* åŸæ–™é¡¹ç›®å®¹å™¨ */
    .inventory-items {
      display: flex;
      flex-wrap: wrap; /* å…è®¸æ¢è¡Œ */
      gap: 0.1rem; /* é¡¹ç›®é—´è·0.1rem */
      align-content: flex-start; /* å†…å®¹é¡¶éƒ¨å¯¹é½ */
      width: 100%; /* å®½åº¦å æ»¡çˆ¶å®¹å™¨ */
    }

    /* ==================== å•ä¸ªåŸæ–™é¡¹ ==================== */
    .inv-item {
      width: auto; /* å®½åº¦è‡ªåŠ¨ */
      height: auto; /* é«˜åº¦è‡ªåŠ¨ */
      padding: 0.05rem; /* å†…è¾¹è·0.05rem */
      background: transparent; /* é€æ˜èƒŒæ™¯ */
      border-radius: 0; /* æ— åœ†è§’ */
      display: flex;
      align-items: center; /* å‚ç›´å±…ä¸­ */
      justify-content: center; /* æ°´å¹³å±…ä¸­ */
      font-size: 1rem; /* å›¾æ ‡å¤§å°1rem */
      border: none; /* æ— è¾¹æ¡† */
      cursor: default; /* é»˜è®¤å…‰æ ‡ */
      transition: none; /* æ— è¿‡æ¸¡åŠ¨ç”» */
      position: relative; /* ç›¸å¯¹å®šä½ï¼Œç”¨äºæ•°é‡æ ‡ç­¾ç»å¯¹å®šä½ */
      flex-shrink: 0; /* ä¸å…è®¸å‹ç¼© */
    }

    /* å±å¹•é«˜åº¦<800pxæ—¶ï¼Œç¼©å°åŸæ–™é¡¹ */
    @media (max-height: 800px) {
      .inv-item {
        font-size: 0.9rem; /* å›¾æ ‡ç¼©å°åˆ°0.9rem */
      }
      .inv-item .count {
        font-size: 0.55rem; /* æ•°é‡æ–‡å­—ç¼©å°åˆ°0.55rem */
      }
    }

    /* å±å¹•é«˜åº¦<600pxæ—¶ï¼Œè¿›ä¸€æ­¥ç¼©å°åŸæ–™é¡¹ */
    @media (max-height: 600px) {
      .inv-item {
        font-size: 0.8rem; /* å›¾æ ‡ç¼©å°åˆ°0.8rem */
      }
      .inv-item .count {
        font-size: 0.5rem; /* æ•°é‡æ–‡å­—ç¼©å°åˆ°0.5rem */
      }
    }

    /* åŸæ–™é¡¹æ‚¬åœæ•ˆæœï¼ˆç¦ç”¨ï¼‰ */
    .inv-item:hover {
      transform: none; /* æ— å˜æ¢ */
      border-color: transparent; /* é€æ˜è¾¹æ¡† */
    }

    /* åŸæ–™é¡¹é€‰ä¸­çŠ¶æ€ï¼ˆç¦ç”¨ï¼‰ */
    /* åŸæ–™é¡¹é€‰ä¸­çŠ¶æ€ï¼ˆç¦ç”¨ï¼‰ */
    .inv-item.selected {
      background: transparent; /* é€æ˜èƒŒæ™¯ */
      border-color: transparent; /* é€æ˜è¾¹æ¡† */
      box-shadow: none; /* æ— é˜´å½± */
    }

    /* åŸæ–™æ•°é‡æ ‡ç­¾ */
    .inv-item .count {
      position: absolute; /* ç»å¯¹å®šä½ */
      bottom: 0; /* åº•éƒ¨å¯¹é½ */
      right: 0; /* å³ä¾§å¯¹é½ */
      background: transparent; /* é€æ˜èƒŒæ™¯ */
      color: #8B4513; /* æ£•è‰²æ–‡å­— */
      font-size: 0.6rem; /* å­—ä½“å¤§å°0.6rem */
      padding: 0; /* æ— å†…è¾¹è· */
      border-radius: 0; /* æ— åœ†è§’ */
      font-weight: bold;
    }

    /* ==================== é…æ–¹ä¹¦ï¼ˆåˆ¶ä½œåŒºï¼‰ ==================== */
    .recipes-box {
      background: #FFF8DC; /* æµ…é»„è‰²èƒŒæ™¯ */
      border-radius: 0.6rem; /* åœ†è§’0.6rem */
      padding: 0.6rem; /* å†…è¾¹è·0.6rem */
      margin-bottom: 0.75rem; /* åº•éƒ¨å¤–è¾¹è·0.75rem */
      display: flex;
      flex-direction: column; /* å‚ç›´æ’åˆ—å­å…ƒç´  */
    }

    /* ==================== å•ä¸ªé…æ–¹é¡¹ ==================== */
    /* æ¯ä¸ªé…æ–¹å å±å¹•çºµå‘9%é«˜åº¦ (10% * 0.9) */
    .recipe-item {
      display: flex;
      align-items: center; /* å‚ç›´å±…ä¸­ */
      gap: 0.3rem; /* å­å…ƒç´ é—´è·0.3rem */
      padding: 0.36rem; /* å†…è¾¹è·0.36rem (0.4 * 0.9) */
      margin-bottom: 0.36rem; /* åº•éƒ¨å¤–è¾¹è·0.36rem (0.4 * 0.9) */
      background: white; /* ç™½è‰²èƒŒæ™¯ */
      border-radius: 0.5rem; /* åœ†è§’0.5rem */
      border: 0.12rem solid #DEB887; /* è¾¹æ¡†å®½åº¦0.12rem */
      cursor: pointer; /* é¼ æ ‡æŒ‡é’ˆ */
      transition: all 0.3s; /* è¿‡æ¸¡åŠ¨ç”»0.3ç§’ */
      font-size: 0.8rem; /* å­—ä½“å¤§å°0.8rem */
      height: 9vh; /* å è§†å£é«˜åº¦çš„9% (10vh * 0.9) */
      min-height: 9vh; /* æœ€å°é«˜åº¦9vhï¼Œé˜²æ­¢å‹ç¼© */
      max-height: 9vh; /* æœ€å¤§é«˜åº¦9vhï¼Œé˜²æ­¢æ‹‰ä¼¸ */
      flex-shrink: 0; /* ä¸å…è®¸å‹ç¼© */
    }

    /* æœ€åä¸€ä¸ªé…æ–¹é¡¹æ— åº•éƒ¨å¤–è¾¹è· */
    .recipe-item:last-child {
      margin-bottom: 0;
    }

    /* ç¬¬äº”ä¸ªé…æ–¹é¡¹ï¼šç¼©çª„æ¨ªå‘é—´è· */
    .recipe-item:nth-child(5) {
      gap: 0.05rem; /* å­å…ƒç´ é—´è·ç¼©å°åˆ°0.05remï¼Œå‡ ä¹æ²¡æœ‰é—´è· */
    }

    .recipe-item:nth-child(5) .recipe-ingredients {
      gap: 0.05rem; /* åŸæ–™å›¾æ ‡é—´è·ç¼©å°åˆ°0.05rem */
    }

    /* é…æ–¹é¡¹é¼ æ ‡æ‚¬åœæ•ˆæœ */
    .recipe-item:hover {
      border-color: #8B4513; /* è¾¹æ¡†å˜ä¸ºæ·±æ£•è‰² */
      transform: translateX(0.18rem); /* å‘å³ç§»åŠ¨0.18rem */
    }

    /* å¯åˆ¶ä½œçŠ¶æ€ï¼ˆåŸæ–™å……è¶³ï¼‰ */
    .recipe-item.can-craft {
      border-color: #90EE90; /* æµ…ç»¿è‰²è¾¹æ¡† */
      background: #F0FFF0; /* æµ…ç»¿è‰²èƒŒæ™¯ */
    }

    /* ==================== é…æ–¹åŸæ–™åˆ—è¡¨ ==================== */
    .recipe-ingredients {
      display: flex;
      gap: 0.3rem; /* åŸæ–™å›¾æ ‡é—´è·0.3rem */
      flex-shrink: 0; /* ä¸å…è®¸å‹ç¼© */
      align-items: center; /* å‚ç›´å±…ä¸­ */
    }

    /* å•ä¸ªåŸæ–™å›¾æ ‡ */
    .recipe-ing {
      font-size: 2rem; /* å›¾æ ‡å¤§å°2rem */
      flex-shrink: 0; /* ä¸å…è®¸å‹ç¼© */
      line-height: 1; /* è¡Œé«˜1ï¼Œç´§å‡‘æ˜¾ç¤º */
    }

    /* é…æ–¹ç®­å¤´ */
    .recipe-arrow {
      font-size: 1.5rem; /* ç®­å¤´å¤§å°1.5rem */
      color: #8B4513; /* æ£•è‰² */
      flex-shrink: 0; /* ä¸å…è®¸å‹ç¼© */
    }

    /* é…æ–¹ç»“æœå›¾æ ‡ */
    .recipe-result {
      font-size: 2.4rem; /* å›¾æ ‡å¤§å°2.4rem */
      margin-left: auto; /* è‡ªåŠ¨å·¦è¾¹è·ï¼Œæ¨åˆ°å³ä¾§ */
      flex-shrink: 0; /* ä¸å…è®¸å‹ç¼© */
      line-height: 1; /* è¡Œé«˜1ï¼Œç´§å‡‘æ˜¾ç¤º */
    }

    /* é…æ–¹åˆ¶ä½œæ—¶é—´ */
    .recipe-time {
      font-size: 0.7rem; /* å­—ä½“å¤§å°0.7rem */
      color: #666; /* ç°è‰²æ–‡å­— */
      flex-shrink: 0; /* ä¸å…è®¸å‹ç¼© */
    }

    /* ==================== é…æ–¹å›¾æ ‡å“åº”å¼ï¼ˆæ¨ªå‘ï¼‰ ==================== */
    /* å±å¹•å®½åº¦<1400pxæ—¶ï¼Œç¼©å°é…æ–¹å›¾æ ‡ */
    @media (max-width: 1400px) {
      .recipe-ingredients {
        gap: 0.25rem; /* é—´è·ç¼©å°åˆ°0.25rem */
      }
      .recipe-ing {
        font-size: 1.8rem; /* åŸæ–™å›¾æ ‡ç¼©å°åˆ°1.8rem */
      }
      .recipe-arrow {
        font-size: 1.2rem; /* ç®­å¤´ç¼©å°åˆ°1.2rem */
      }
      .recipe-result {
        font-size: 2.2rem; /* ç»“æœå›¾æ ‡ç¼©å°åˆ°2.2rem */
      }
    }

    /* å±å¹•å®½åº¦<1200pxæ—¶ï¼Œè¿›ä¸€æ­¥ç¼©å°é…æ–¹å›¾æ ‡ */
    @media (max-width: 1200px) {
      .recipe-ingredients {
        gap: 0.2rem; /* é—´è·ç¼©å°åˆ°0.2rem */
      }
      .recipe-ing {
        font-size: 1.6rem; /* åŸæ–™å›¾æ ‡ç¼©å°åˆ°1.6rem */
      }
      .recipe-arrow {
        font-size: 1.1rem; /* ç®­å¤´ç¼©å°åˆ°1.1rem */
      }
      .recipe-result {
        font-size: 2rem; /* ç»“æœå›¾æ ‡ç¼©å°åˆ°2rem */
      }
    }

    /* å±å¹•å®½åº¦<1000pxæ—¶ï¼Œæœ€å°é…æ–¹å›¾æ ‡ */
    @media (max-width: 1000px) {
      .recipe-ingredients {
        gap: 0.15rem; /* é—´è·ç¼©å°åˆ°0.15rem */
      }
      .recipe-ing {
        font-size: 1.4rem; /* åŸæ–™å›¾æ ‡ç¼©å°åˆ°1.4rem */
      }
      .recipe-arrow {
        font-size: 1rem; /* ç®­å¤´ç¼©å°åˆ°1rem */
      }
      .recipe-result {
        font-size: 1.8rem; /* ç»“æœå›¾æ ‡ç¼©å°åˆ°1.8rem */
      }
    }

    /* ==================== åˆ¶ä½œä¸­é˜Ÿåˆ—ï¼ˆææ–™åŒºï¼‰ ==================== */
    .crafting-queue {
      background: #FFF8DC; /* æµ…é»„è‰²èƒŒæ™¯ */
      border-radius: 0.6rem; /* åœ†è§’0.6rem */
      padding: 0.6rem; /* å†…è¾¹è·0.6rem */
      margin-bottom: 0.5rem; /* åº•éƒ¨å¤–è¾¹è·0.5rem */
      flex-shrink: 0; /* ä¸å…è®¸å‹ç¼© */
    }

    /* å•ä¸ªåˆ¶ä½œä¸­é¡¹ç›® */
    .crafting-item {
      display: flex;
      align-items: center; /* å‚ç›´å±…ä¸­ */
      gap: 0.5rem; /* å­å…ƒç´ é—´è·0.5rem */
      padding: 0.4rem; /* å†…è¾¹è·0.4rem */
      margin-bottom: 0.4rem; /* åº•éƒ¨å¤–è¾¹è·0.4rem */
      background: white; /* ç™½è‰²èƒŒæ™¯ */
      border-radius: 0.5rem; /* åœ†è§’0.5rem */
    }

    /* åˆ¶ä½œè¿›åº¦æ¡å®¹å™¨ */
    .crafting-progress {
      flex: 1; /* å æ®å‰©ä½™ç©ºé—´ */
      height: 0.4rem; /* é«˜åº¦0.4rem */
      background: #eee; /* æµ…ç°è‰²èƒŒæ™¯ */
      border-radius: 0.18rem; /* åœ†è§’0.18rem */
      overflow: hidden; /* éšè—æº¢å‡º */
    }

    /* åˆ¶ä½œè¿›åº¦æ¡å¡«å…… */
    .crafting-fill {
      height: 100%; /* é«˜åº¦å æ»¡è¿›åº¦æ¡ */
      background: linear-gradient(90deg, #F5DEB3, #8B4513); /* æ¸å˜è‰²ï¼šæµ…æ£•åˆ°æ·±æ£• */
      border-radius: 0.18rem; /* åœ†è§’0.18rem */
      transition: width 0.3s; /* å®½åº¦å˜åŒ–è¿‡æ¸¡0.3ç§’ */
    }

    /* ==================== å¸‚åœºè´­ä¹°åŒºï¼ˆææ–™åŒºï¼‰ ==================== */
    .market-items {
      display: flex;
      flex-direction: column; /* å‚ç›´æ’åˆ— */
      gap: 0.3rem; /* é¡¹ç›®é—´è·0.3rem */
    }

    /* å•ä¸ªå¸‚åœºè´­ä¹°é¡¹ */
    .market-item {
      display: flex;
      align-items: center; /* å‚ç›´å±…ä¸­ */
      gap: 0.4rem; /* å­å…ƒç´ é—´è·0.4rem */
      padding: 0.4rem; /* å†…è¾¹è·0.4rem */
      background: white; /* ç™½è‰²èƒŒæ™¯ */
      border-radius: 0.4rem; /* åœ†è§’0.4rem */
      border: 0.12rem solid #DEB887; /* è¾¹æ¡†å®½åº¦0.12rem */
      transition: all 0.3s; /* è¿‡æ¸¡åŠ¨ç”»0.3ç§’ */
    }

    /* å¸‚åœºé¡¹é¼ æ ‡æ‚¬åœæ•ˆæœ */
    .market-item:hover {
      border-color: #8B4513; /* è¾¹æ¡†å˜ä¸ºæ·±æ£•è‰² */
      transform: translateX(0.18rem); /* å‘å³ç§»åŠ¨0.18rem */
    }

    /* å¸‚åœºé¡¹å›¾æ ‡ */
    .market-item-icon {
      font-size: 1.5rem; /* å›¾æ ‡å¤§å°1.5rem */
      width: 2rem; /* å®½åº¦2rem */
      height: 2rem; /* é«˜åº¦2rem */
      display: flex;
      align-items: center; /* å‚ç›´å±…ä¸­ */
      justify-content: center; /* æ°´å¹³å±…ä¸­ */
      background: #F5DEB3; /* æµ…æ£•è‰²èƒŒæ™¯ */
      border-radius: 0.3rem; /* åœ†è§’0.3rem */
      flex-shrink: 0; /* ä¸å…è®¸å‹ç¼© */
    }

    /* å¸‚åœºé¡¹ä¿¡æ¯å®¹å™¨ */
    .market-item-info {
      flex: 1; /* å æ®å‰©ä½™ç©ºé—´ */
      min-width: 0; /* æœ€å°å®½åº¦0ï¼Œå…è®¸å®Œå…¨å‹ç¼© */
    }

    /* å¸‚åœºé¡¹åç§° */
    .market-item-name {
      font-weight: bold;
      color: #8B4513; /* æ£•è‰²æ–‡å­— */
      font-size: 0.75rem; /* å­—ä½“å¤§å°0.75rem */
    }

    /* å¸‚åœºé¡¹æè¿° */
    .market-item-desc {
      font-size: 0.65rem; /* å­—ä½“å¤§å°0.65rem */
      color: #666; /* ç°è‰²æ–‡å­— */
      white-space: nowrap; /* ä¸æ¢è¡Œ */
      overflow: hidden; /* éšè—æº¢å‡º */
      text-overflow: ellipsis; /* æº¢å‡ºæ˜¾ç¤ºçœç•¥å· */
    }

    /* å¸‚åœºè´­ä¹°æŒ‰é’® */
    .market-btn {
      padding: 0.3rem 0.6rem; /* ä¸Šä¸‹0.3remï¼Œå·¦å³0.6rem */
      background: #90EE90; /* æµ…ç»¿è‰²èƒŒæ™¯ */
      border: none; /* æ— è¾¹æ¡† */
      border-radius: 0.6rem; /* åœ†è§’0.6rem */
      cursor: pointer; /* é¼ æ ‡æŒ‡é’ˆ */
      font-weight: bold;
      font-size: 0.7rem; /* å­—ä½“å¤§å°0.7rem */
      color: #2E8B57; /* æ·±ç»¿è‰²æ–‡å­— */
      transition: all 0.3s; /* è¿‡æ¸¡åŠ¨ç”»0.3ç§’ */
      white-space: nowrap; /* ä¸æ¢è¡Œ */
      flex-shrink: 0; /* ä¸å…è®¸å‹ç¼© */
    }

    /* å¸‚åœºæŒ‰é’®é¼ æ ‡æ‚¬åœæ•ˆæœ */
    .market-btn:hover {
      background: #7FDD7F; /* æ·±ç»¿è‰²èƒŒæ™¯ */
      transform: scale(1.05); /* æ”¾å¤§åˆ°105% */
    }

    /* å¸‚åœºæŒ‰é’®ç¦ç”¨çŠ¶æ€ */
    .market-btn:disabled {
      background: #ccc; /* ç°è‰²èƒŒæ™¯ */
      color: #999; /* æµ…ç°è‰²æ–‡å­— */
      cursor: not-allowed; /* ç¦æ­¢å…‰æ ‡ */
      transform: none; /* æ— å˜æ¢ */
    }

    /* ==================== å¸‚åœºåŒºå“åº”å¼ï¼ˆçºµå‘ï¼‰ ==================== */
    /* å±å¹•é«˜åº¦<800pxæ—¶ï¼Œç¼©å°å¸‚åœºé¡¹ */
    @media (max-height: 800px) {
      .market-items {
        gap: 0.25rem; /* é—´è·ç¼©å°åˆ°0.25rem */
      }
      .market-item {
        padding: 0.35rem; /* å†…è¾¹è·ç¼©å°åˆ°0.35rem */
        gap: 0.35rem; /* å­å…ƒç´ é—´è·ç¼©å°åˆ°0.35rem */
      }
      .market-item-icon {
        font-size: 1.3rem; /* å›¾æ ‡ç¼©å°åˆ°1.3rem */
        width: 1.8rem; /* å®½åº¦ç¼©å°åˆ°1.8rem */
        height: 1.8rem; /* é«˜åº¦ç¼©å°åˆ°1.8rem */
      }
      .market-item-name {
        font-size: 0.7rem; /* åç§°å­—ä½“ç¼©å°åˆ°0.7rem */
      }
      .market-item-desc {
        font-size: 0.6rem; /* æè¿°å­—ä½“ç¼©å°åˆ°0.6rem */
      }
      .market-btn {
        padding: 0.25rem 0.5rem; /* æŒ‰é’®å†…è¾¹è·ç¼©å° */
        font-size: 0.65rem; /* æŒ‰é’®å­—ä½“ç¼©å°åˆ°0.65rem */
      }
    }

    /* å±å¹•é«˜åº¦<600pxæ—¶ï¼Œè¿›ä¸€æ­¥ç¼©å°å¸‚åœºé¡¹ */
    @media (max-height: 600px) {
      .market-items {
        gap: 0.2rem; /* é—´è·ç¼©å°åˆ°0.2rem */
      }
      .market-item {
        padding: 0.3rem; /* å†…è¾¹è·ç¼©å°åˆ°0.3rem */
        gap: 0.3rem; /* å­å…ƒç´ é—´è·ç¼©å°åˆ°0.3rem */
      }
      .market-item-icon {
        font-size: 1.2rem; /* å›¾æ ‡ç¼©å°åˆ°1.2rem */
        width: 1.6rem; /* å®½åº¦ç¼©å°åˆ°1.6rem */
        height: 1.6rem; /* é«˜åº¦ç¼©å°åˆ°1.6rem */
      }
      .market-item-name {
        font-size: 0.65rem; /* åç§°å­—ä½“ç¼©å°åˆ°0.65rem */
      }
      .market-item-desc {
        font-size: 0.55rem; /* æè¿°å­—ä½“ç¼©å°åˆ°0.55rem */
      }
      .market-btn {
        padding: 0.2rem 0.4rem; /* æŒ‰é’®å†…è¾¹è·ç¼©å° */
        font-size: 0.6rem; /* æŒ‰é’®å­—ä½“ç¼©å°åˆ°0.6rem */
      }
    }

    /* ==================== å”®å–åŒº - æŸœå° ==================== */
    .counter-box {
      background: #FFF8DC; /* æµ…é»„è‰²èƒŒæ™¯ */
      border-radius: 0.6rem; /* åœ†è§’0.6rem */
      padding: 0.4rem 0.6rem; /* ä¸Šä¸‹0.4remï¼Œå·¦å³0.6rem */
      margin-bottom: 0.5rem; /* åº•éƒ¨å¤–è¾¹è·0.5rem */
      flex-shrink: 0; /* ä¸å…è®¸å‹ç¼© */
      display: flex;
      flex-direction: column; /* å‚ç›´æ’åˆ—å­å…ƒç´  */
      min-height: auto; /* æœ€å°é«˜åº¦è‡ªåŠ¨ï¼Œæ ¹æ®å†…å®¹è°ƒæ•´ */
    }

    /* æŸœå°é¢åŒ…å®¹å™¨ */
    .counter-items {
      display: flex;
      flex-wrap: wrap; /* å…è®¸æ¢è¡Œ */
      gap: 0.1rem; /* é¡¹ç›®é—´è·0.1rem */
      align-content: flex-start; /* å†…å®¹é¡¶éƒ¨å¯¹é½ */
      width: 100%; /* å®½åº¦å æ»¡çˆ¶å®¹å™¨ */
    }

    /* å•ä¸ªæŸœå°é¢åŒ…é¡¹ */
    .counter-item {
      width: 1.55rem; /* å®½åº¦1.55rem (3.1 / 2) */
      height: 1.55rem; /* é«˜åº¦1.55rem (3.1 / 2) */
      display: flex;
      align-items: center; /* æ°´å¹³å±…ä¸­ */
      justify-content: center; /* å‚ç›´å±…ä¸­ */
      position: relative; /* ç›¸å¯¹å®šä½ï¼Œç”¨äºä»·æ ¼æ ‡ç­¾ç»å¯¹å®šä½ */
      cursor: default; /* é»˜è®¤å…‰æ ‡ï¼Œä¸å¯ç‚¹å‡» */
    }

    /* é¢åŒ…å›¾æ ‡ */
    .counter-item .bread-icon {
      font-size: 1.25rem; /* å›¾æ ‡å¤§å°1.25rem (2.5 / 2) */
    }

    /* é¢åŒ…ä»·æ ¼ - å åŠ åœ¨å³ä¸‹è§’ */
    .counter-item .bread-price {
      position: absolute; /* ç»å¯¹å®šä½ */
      bottom: 0.05rem; /* è·ç¦»åº•éƒ¨0.05rem */
      right: 0.05rem; /* è·ç¦»å³ä¾§0.05rem */
      background: rgba(139, 69, 19, 0.85); /* åŠé€æ˜æ·±æ£•è‰²èƒŒæ™¯ */
      color: white; /* ç™½è‰²æ–‡å­— */
      font-size: 0.3rem; /* å­—ä½“å¤§å°0.3rem (0.6 / 2) */
      padding: 0.05rem 0.125rem; /* ä¸Šä¸‹0.05remï¼Œå·¦å³0.125rem */
      border-radius: 0.15rem; /* åœ†è§’0.15rem (0.3 / 2) */
      font-weight: bold;
      display: flex;
      align-items: center;
      gap: 0.05rem; /* å›¾æ ‡å’Œæ•°å­—é—´è· */
    }

    /* é¢åŒ…æ•°é‡æ ‡ç­¾ */
    .counter-item .count {
      position: absolute; /* ç»å¯¹å®šä½ */
      top: 0.03rem; /* è·ç¦»é¡¶éƒ¨0.03rem (0.06 / 2) */
      right: 0.03rem; /* è·ç¦»å³ä¾§0.03rem (0.06 / 2) */
      background: #8B4513; /* æ·±æ£•è‰²èƒŒæ™¯ */
      color: white; /* ç™½è‰²æ–‡å­— */
      font-size: 0.275rem; /* å­—ä½“å¤§å°0.275rem (0.55 / 2) */
      padding: 0.03rem 0.125rem; /* ä¸Šä¸‹0.03remï¼Œå·¦å³0.125rem */
      border-radius: 0.25rem; /* åœ†è§’0.25rem (0.5 / 2) */
    }

    /* ==================== å”®å–åŒº - é¡¾å®¢ ==================== */
    .customers-box {
      background: #FFF8DC; /* æµ…é»„è‰²èƒŒæ™¯ */
      border-radius: 0.6rem; /* åœ†è§’0.6rem */
      padding: 0.6rem; /* å†…è¾¹è·0.6rem */
    }

    /* å•ä¸ªé¡¾å®¢é¡¹ */
    .customer {
      display: flex;
      align-items: center; /* å‚ç›´å±…ä¸­ */
      gap: 0.25rem; /* å­å…ƒç´ é—´è·0.25rem (0.5 / 2) */
      padding: 0.25rem; /* å†…è¾¹è·0.25rem (0.5 / 2) */
      margin-bottom: 0.25rem; /* åº•éƒ¨å¤–è¾¹è·0.25rem (0.5 / 2) */
      background: white; /* ç™½è‰²èƒŒæ™¯ */
      border-radius: 0.3rem; /* åœ†è§’0.3rem (0.6 / 2) */
      border: 0.06rem solid #DEB887; /* è¾¹æ¡†å®½åº¦0.06rem (0.12 / 2) */
      animation: slideIn 0.5s ease; /* æ»‘å…¥åŠ¨ç”»ï¼ŒæŒç»­0.5ç§’ */
    }

    /* é¡¾å®¢æ»‘å…¥åŠ¨ç”»å®šä¹‰ */
    @keyframes slideIn {
      from { transform: translateX(100%); opacity: 0; } /* ä»å³ä¾§100%ä½ç½®ï¼Œé€æ˜ */
      to { transform: translateX(0); opacity: 1; } /* åˆ°åŸä½ç½®ï¼Œä¸é€æ˜ */
    }

    /* é¡¾å®¢å¤´åƒ */
    .customer-avatar {
      font-size: 1rem; /* å›¾æ ‡å¤§å°1rem (2 / 2) */
      width: 1.25rem; /* å®½åº¦1.25rem (2.5 / 2) */
      height: 1.25rem; /* é«˜åº¦1.25rem (2.5 / 2) */
      display: flex;
      align-items: center; /* å‚ç›´å±…ä¸­ */
      justify-content: center; /* æ°´å¹³å±…ä¸­ */
      background: #F5DEB3; /* æµ…æ£•è‰²èƒŒæ™¯ */
      border-radius: 50%; /* åœ†å½¢ */
    }

    /* é¡¾å®¢ä¿¡æ¯å®¹å™¨ */
    .customer-info {
      flex: 1; /* å æ®å‰©ä½™ç©ºé—´ */
    }

    /* é¡¾å®¢å§“å */
    .customer-name {
      font-weight: bold;
      color: #8B4513; /* æ£•è‰²æ–‡å­— */
      font-size: 0.6rem; /* å­—ä½“å¤§å°0.6rem */
    }

    /* é¡¾å®¢éœ€æ±‚ */
    .customer-want {
      font-size: 0.55rem; /* å­—ä½“å¤§å°0.55rem */
      color: #666; /* ç°è‰²æ–‡å­— */
      display: flex;
      align-items: center; /* å‚ç›´å±…ä¸­ */
      gap: 0.09rem; /* å­å…ƒç´ é—´è·0.09rem (0.18 / 2) */
    }

    /* é¡¾å®¢éœ€æ±‚å›¾æ ‡ */
    .customer-want-emoji {
      font-size: 0.8rem; /* å›¾æ ‡å¤§å°0.8rem */
    }

    /* é¡¾å®¢å‡ºå”®æŒ‰é’® */
    .customer-btn {
      padding: 0.2rem 0.375rem; /* ä¸Šä¸‹0.2remï¼Œå·¦å³0.375rem (0.4 / 2, 0.75 / 2) */
      background: #90EE90; /* æµ…ç»¿è‰²èƒŒæ™¯ */
      border: none; /* æ— è¾¹æ¡† */
      border-radius: 0.45rem; /* åœ†è§’0.45rem (0.9 / 2) */
      cursor: pointer; /* é¼ æ ‡æŒ‡é’ˆ */
      font-weight: bold;
      font-size: 0.55rem; /* å­—ä½“å¤§å°0.55rem */
      color: #2E8B57; /* æ·±ç»¿è‰²æ–‡å­— */
      transition: all 0.3s; /* è¿‡æ¸¡åŠ¨ç”»0.3ç§’ */
    }

    /* é¡¾å®¢æŒ‰é’®é¼ æ ‡æ‚¬åœæ•ˆæœ */
    .customer-btn:hover {
      background: #7FDD7F; /* æ·±ç»¿è‰²èƒŒæ™¯ */
      transform: scale(1.05); /* æ”¾å¤§åˆ°105% */
    }

    /* é¡¾å®¢æŒ‰é’®ç¦ç”¨çŠ¶æ€ */
    .customer-btn:disabled {
      background: #ccc; /* ç°è‰²èƒŒæ™¯ */
      color: #999; /* æµ…ç°è‰²æ–‡å­— */
      cursor: not-allowed; /* ç¦æ­¢å…‰æ ‡ */
      transform: none; /* æ— å˜æ¢ */
    }

    /* ==================== å¼¹çª—ç³»ç»Ÿ ==================== */
    .modal-overlay {
      position: fixed; /* å›ºå®šå®šä½ */
      top: 0; /* é¡¶éƒ¨å¯¹é½ */
      left: 0; /* å·¦ä¾§å¯¹é½ */
      right: 0; /* å³ä¾§å¯¹é½ */
      bottom: 0; /* åº•éƒ¨å¯¹é½ */
      background: rgba(0,0,0,0.7); /* åŠé€æ˜é»‘è‰²èƒŒæ™¯ï¼Œé€æ˜åº¦70% */
      display: flex;
      align-items: center; /* å‚ç›´å±…ä¸­ */
      justify-content: center; /* æ°´å¹³å±…ä¸­ */
      z-index: 1000; /* å±‚çº§1000ï¼Œæ˜¾ç¤ºåœ¨æœ€ä¸Šå±‚ */
      opacity: 0; /* åˆå§‹é€æ˜ */
      visibility: hidden; /* åˆå§‹éšè— */
      transition: all 0.3s; /* è¿‡æ¸¡åŠ¨ç”»0.3ç§’ */
      padding: 1rem; /* å†…è¾¹è·1rem */
    }

    /* å¼¹çª—æ¿€æ´»çŠ¶æ€ */
    .modal-overlay.active {
      opacity: 1; /* å®Œå…¨ä¸é€æ˜ */
      visibility: visible; /* å¯è§ */
    }

    /* å¼¹çª—ä¸»ä½“ */
    .modal {
      background: white; /* ç™½è‰²èƒŒæ™¯ */
      border-radius: 1.2rem; /* åœ†è§’1.2rem */
      padding: 1.5rem; /* å†…è¾¹è·1.5rem */
      max-width: 31rem; /* æœ€å¤§å®½åº¦31rem */
      width: 90%; /* å®½åº¦å 90% */
      text-align: center; /* æ–‡å­—å±…ä¸­ */
      transform: scale(0.8); /* åˆå§‹ç¼©å°åˆ°80% */
      transition: all 0.3s; /* è¿‡æ¸¡åŠ¨ç”»0.3ç§’ */
      max-height: 90vh; /* æœ€å¤§é«˜åº¦90vh */
      overflow-y: auto; /* çºµå‘æ»šåŠ¨ */
    }

    /* å¼¹çª—æ¿€æ´»æ—¶çš„ä¸»ä½“ */
    .modal-overlay.active .modal {
      transform: scale(1); /* æ¢å¤åˆ°100% */
    }

    /* å¼¹çª—æ ‡é¢˜ */
    .modal-title {
      font-size: 1.5rem; /* å­—ä½“å¤§å°1.5rem */
      color: #8B4513; /* æ£•è‰²æ–‡å­— */
      margin-bottom: 0.9rem; /* åº•éƒ¨å¤–è¾¹è·0.9rem */
    }

    /* å¼¹çª—å†…å®¹ */
    .modal-content {
      font-size: 1rem; /* å­—ä½“å¤§å°1rem */
      color: #666; /* ç°è‰²æ–‡å­— */
      margin-bottom: 0.9rem; /* åº•éƒ¨å¤–è¾¹è·0.9rem */
    }

    /* å¼¹çª—ç»Ÿè®¡æ•°æ®å®¹å™¨ */
    .modal-stats {
      background: #FFF8DC; /* æµ…é»„è‰²èƒŒæ™¯ */
      border-radius: 0.9rem; /* åœ†è§’0.9rem */
      padding: 0.9rem; /* å†…è¾¹è·0.9rem */
      margin-bottom: 0.9rem; /* åº•éƒ¨å¤–è¾¹è·0.9rem */
    }

    /* ç»Ÿè®¡æ•°æ®è¡Œ */
    .stat-row {
      display: flex;
      justify-content: space-between; /* ä¸¤ç«¯å¯¹é½ */
      padding: 0.5rem 0; /* ä¸Šä¸‹0.5remï¼Œå·¦å³0 */
      border-bottom: 0.06rem solid #DEB887; /* åº•éƒ¨è¾¹æ¡†ï¼šå®½åº¦0.06rem */
      font-size: 0.85rem; /* å­—ä½“å¤§å°0.85rem */
    }

    /* æœ€åä¸€è¡Œç»Ÿè®¡æ•°æ®æ— åº•éƒ¨è¾¹æ¡† */
    .stat-row:last-child {
      border-bottom: none; /* æ— åº•éƒ¨è¾¹æ¡† */
    }

    /* å¼¹çª—æŒ‰é’® */
    .modal-btn {
      padding: 0.75rem 2.2rem; /* ä¸Šä¸‹0.75remï¼Œå·¦å³2.2rem */
      background: #8B4513; /* æ·±æ£•è‰²èƒŒæ™¯ */
      color: white; /* ç™½è‰²æ–‡å­— */
      border: none; /* æ— è¾¹æ¡† */
      border-radius: 1.5rem; /* åœ†è§’1.5rem */
      font-size: 1rem; /* å­—ä½“å¤§å°1rem */
      cursor: pointer; /* é¼ æ ‡æŒ‡é’ˆ */
      transition: all 0.3s; /* è¿‡æ¸¡åŠ¨ç”»0.3ç§’ */
    }

    /* å¼¹çª—æŒ‰é’®é¼ æ ‡æ‚¬åœæ•ˆæœ */
    .modal-btn:hover {
      background: #A0522D; /* æµ…æ£•è‰²èƒŒæ™¯ */
      transform: scale(1.05); /* æ”¾å¤§åˆ°105% */
    }

    /* ==================== å‡çº§å•†åº— ==================== */
    .upgrade-shop {
      margin-top: 0.9rem; /* é¡¶éƒ¨å¤–è¾¹è·0.9rem */
    }

    /* å•ä¸ªå‡çº§é¡¹ */
    .upgrade-item {
      display: flex;
      align-items: center; /* å‚ç›´å±…ä¸­ */
      gap: 0.75rem; /* å­å…ƒç´ é—´è·0.75rem */
      padding: 0.75rem; /* å†…è¾¹è·0.75rem */
      margin-bottom: 0.5rem; /* åº•éƒ¨å¤–è¾¹è·0.5rem */
      background: #FFF8DC; /* æµ…é»„è‰²èƒŒæ™¯ */
      border-radius: 0.6rem; /* åœ†è§’0.6rem */
      border: 0.12rem solid #DEB887; /* è¾¹æ¡†å®½åº¦0.12rem */
    }

    /* å‡çº§å›¾æ ‡ */
    .upgrade-icon {
      font-size: 1.9rem; /* å›¾æ ‡å¤§å°1.9rem */
    }

    /* å‡çº§ä¿¡æ¯å®¹å™¨ */
    .upgrade-info {
      flex: 1; /* å æ®å‰©ä½™ç©ºé—´ */
      text-align: left; /* æ–‡å­—å·¦å¯¹é½ */
    }

    /* å‡çº§åç§° */
    .upgrade-name {
      font-weight: bold;
      color: #8B4513; /* æ£•è‰²æ–‡å­— */
      font-size: 0.85rem; /* å­—ä½“å¤§å°0.85rem */
    }

    /* å‡çº§æè¿° */
    .upgrade-desc {
      font-size: 0.75rem; /* å­—ä½“å¤§å°0.75rem */
      color: #666; /* ç°è‰²æ–‡å­— */
    }

    /* å‡çº§è´­ä¹°æŒ‰é’® */
    .upgrade-btn {
      padding: 0.4rem 0.9rem; /* ä¸Šä¸‹0.4remï¼Œå·¦å³0.9rem */
      background: #90EE90; /* æµ…ç»¿è‰²èƒŒæ™¯ */
      border: none; /* æ— è¾¹æ¡† */
      border-radius: 0.9rem; /* åœ†è§’0.9rem */
      cursor: pointer; /* é¼ æ ‡æŒ‡é’ˆ */
      font-weight: bold;
      font-size: 0.75rem; /* å­—ä½“å¤§å°0.75rem */
      transition: all 0.3s; /* è¿‡æ¸¡åŠ¨ç”»0.3ç§’ */
    }

    /* å‡çº§æŒ‰é’®é¼ æ ‡æ‚¬åœæ•ˆæœ */
    .upgrade-btn:hover {
      background: #7FDD7F; /* æ·±ç»¿è‰²èƒŒæ™¯ */
    }

    /* å‡çº§æŒ‰é’®ç¦ç”¨çŠ¶æ€ */
    .upgrade-btn:disabled {
      background: #ccc; /* ç°è‰²èƒŒæ™¯ */
      cursor: not-allowed; /* ç¦æ­¢å…‰æ ‡ */
    }

    /* ==================== æç¤ºä¿¡æ¯ï¼ˆToastï¼‰ ==================== */
    .toast {
      position: fixed; /* å›ºå®šå®šä½ */
      bottom: 1.2rem; /* è·ç¦»åº•éƒ¨1.2rem */
      left: 50%; /* å·¦ä¾§50% */
      transform: translateX(-50%); /* å‘å·¦åç§»50%ï¼Œå®ç°æ°´å¹³å±…ä¸­ */
      background: #8B4513; /* æ·±æ£•è‰²èƒŒæ™¯ */
      color: white; /* ç™½è‰²æ–‡å­— */
      padding: 0.6rem 1.5rem; /* ä¸Šä¸‹0.6remï¼Œå·¦å³1.5rem */
      border-radius: 1.5rem; /* åœ†è§’1.5rem */
      font-size: 0.85rem; /* å­—ä½“å¤§å°0.85rem */
      z-index: 1001; /* å±‚çº§1001ï¼Œæ˜¾ç¤ºåœ¨å¼¹çª—ä¹‹ä¸Š */
      opacity: 0; /* åˆå§‹é€æ˜ */
      transition: opacity 0.3s; /* é€æ˜åº¦è¿‡æ¸¡0.3ç§’ */
      max-width: 90%; /* æœ€å¤§å®½åº¦90% */
      text-align: center; /* æ–‡å­—å±…ä¸­ */
    }

    /* æç¤ºä¿¡æ¯æ˜¾ç¤ºçŠ¶æ€ */
    .toast.show {
      opacity: 1; /* å®Œå…¨ä¸é€æ˜ */
    }

    /* ==================== é€‰ä¸­æç¤º ==================== */
    .selection-hint {
      font-size: 0.7rem; /* å­—ä½“å¤§å°0.7rem */
      color: #8B4513; /* æ£•è‰²æ–‡å­— */
      text-align: center; /* æ–‡å­—å±…ä¸­ */
      margin-bottom: 0.3rem; /* åº•éƒ¨å¤–è¾¹è·0.3rem */
      padding: 0.2rem; /* å†…è¾¹è·0.2rem */
      background: rgba(245, 222, 179, 0.5); /* åŠé€æ˜æµ…æ£•è‰²èƒŒæ™¯ï¼Œé€æ˜åº¦50% */
      border-radius: 0.3rem; /* åœ†è§’0.3rem */
      flex-shrink: 0; /* ä¸å…è®¸å‹ç¼© */
      white-space: nowrap; /* ä¸æ¢è¡Œ */
      overflow: hidden; /* éšè—æº¢å‡º */
      text-overflow: ellipsis; /* æº¢å‡ºæ˜¾ç¤ºçœç•¥å· */
    }

    /* å±å¹•é«˜åº¦<800pxæ—¶ï¼Œç¼©å°é€‰ä¸­æç¤º */
    @media (max-height: 800px) {
      .selection-hint {
        margin-bottom: 0.2rem; /* åº•éƒ¨å¤–è¾¹è·ç¼©å°åˆ°0.2rem */
        padding: 0.15rem; /* å†…è¾¹è·ç¼©å°åˆ°0.15rem */
        font-size: 0.65rem; /* å­—ä½“ç¼©å°åˆ°0.65rem */
      }
    }

    /* å±å¹•é«˜åº¦<600pxæ—¶ï¼Œè¿›ä¸€æ­¥ç¼©å°é€‰ä¸­æç¤º */
    @media (max-height: 600px) {
      .selection-hint {
        margin-bottom: 0.15rem; /* åº•éƒ¨å¤–è¾¹è·ç¼©å°åˆ°0.15rem */
        padding: 0.1rem; /* å†…è¾¹è·ç¼©å°åˆ°0.1rem */
        font-size: 0.6rem; /* å­—ä½“ç¼©å°åˆ°0.6rem */
      }
    }

    /* ==================== æ°´äº•ï¼ˆåˆ¶ä½œåŒºï¼‰ ==================== */
    .well-box {
      background: #E0F7FA; /* æµ…è“è‰²èƒŒæ™¯ */
      border-radius: 0.6rem; /* åœ†è§’0.6rem */
      padding: 0.4rem 0.6rem; /* ä¸Šä¸‹0.4remï¼Œå·¦å³0.6rem */
      margin-bottom: 0.5rem; /* åº•éƒ¨å¤–è¾¹è·0.5rem */
      border: 0.12rem solid #4DD0E1; /* è¾¹æ¡†å®½åº¦0.12remï¼Œè“è‰² */
      flex-shrink: 0; /* ä¸å…è®¸å‹ç¼© */
      height: 10%; /* å çˆ¶å®¹å™¨é«˜åº¦çš„10% */
      min-height: 10%; /* æœ€å°é«˜åº¦10%ï¼Œé˜²æ­¢å‹ç¼© */
      max-height: 10%; /* æœ€å¤§é«˜åº¦10%ï¼Œé˜²æ­¢æ‹‰ä¼¸ */
      display: flex;
      align-items: center; /* å‚ç›´å±…ä¸­ */
      justify-content: space-between; /* ä¸¤ç«¯å¯¹é½ */
      gap: 0.5rem; /* å­å…ƒç´ é—´è·0.5rem */
    }

    /* æ°´äº•æ ‡é¢˜ */
    .well-title {
      font-size: 0.85rem; /* å­—ä½“å¤§å°0.85rem */
      color: #00838F; /* æ·±è“è‰²æ–‡å­— */
      font-weight: bold;
      white-space: nowrap; /* ä¸æ¢è¡Œ */
      flex-shrink: 0; /* ä¸å…è®¸å‹ç¼© */
    }

    /* æ°´äº•æŒ‰é’® */
    .well-btn {
      padding: 0.3rem 0.8rem; /* ä¸Šä¸‹0.3remï¼Œå·¦å³0.8rem */
      background: #4DD0E1; /* è“è‰²èƒŒæ™¯ */
      border: none; /* æ— è¾¹æ¡† */
      border-radius: 1.2rem; /* åœ†è§’1.2rem */
      cursor: pointer; /* é¼ æ ‡æŒ‡é’ˆ */
      font-weight: bold;
      color: white; /* ç™½è‰²æ–‡å­— */
      font-size: 0.75rem; /* å­—ä½“å¤§å°0.75rem */
      transition: all 0.3s; /* è¿‡æ¸¡åŠ¨ç”»0.3ç§’ */
      white-space: nowrap; /* ä¸æ¢è¡Œ */
      flex-shrink: 0; /* ä¸å…è®¸å‹ç¼© */
      max-height: 100%; /* æœ€å¤§é«˜åº¦100% */
      height: auto; /* é«˜åº¦è‡ªåŠ¨ */
      display: flex;
      align-items: center; /* å‚ç›´å±…ä¸­ */
      justify-content: center; /* æ°´å¹³å±…ä¸­ */
    }

    /* æ°´äº•æŒ‰é’®é¼ æ ‡æ‚¬åœæ•ˆæœ */
    .well-btn:hover {
      background: #26C6DA; /* æ·±è“è‰²èƒŒæ™¯ */
      transform: scale(1.05); /* æ”¾å¤§åˆ°105% */
    }

    /* æ°´äº•æŒ‰é’®ç¦ç”¨çŠ¶æ€ */
    .well-btn:disabled {
      background: #ccc; /* ç°è‰²èƒŒæ™¯ */
      cursor: not-allowed; /* ç¦æ­¢å…‰æ ‡ */
      transform: none; /* æ— å˜æ¢ */
    }

    /* æ°´äº•è¿›åº¦æ¡ */
    .well-progress {
      display: none; /* é»˜è®¤éšè— */
      width: 100%; /* å®½åº¦100% */
      height: 0.3rem; /* é«˜åº¦0.3rem */
      background: #B2EBF2; /* æµ…è“è‰²èƒŒæ™¯ */
      border-radius: 0.18rem; /* åœ†è§’0.18rem */
      overflow: hidden; /* éšè—æº¢å‡º */
      position: absolute; /* ç»å¯¹å®šä½ */
      bottom: 0.2rem; /* è·ç¦»åº•éƒ¨0.2rem */
      left: 0.6rem; /* è·ç¦»å·¦ä¾§0.6rem */
      right: 0.6rem; /* è·ç¦»å³ä¾§0.6rem */
      width: calc(100% - 1.2rem); /* å®½åº¦ï¼š100% - å·¦å³è¾¹è·1.2rem */
    }

    /* æ‰“æ°´ä¸­çŠ¶æ€æ˜¾ç¤ºè¿›åº¦æ¡ */
    .well-box.fetching .well-progress {
      display: block; /* æ˜¾ç¤ºè¿›åº¦æ¡ */
    }

    /* æ°´äº•è¿›åº¦æ¡å¡«å…… */
    .well-progress-fill {
      height: 100%; /* é«˜åº¦å æ»¡è¿›åº¦æ¡ */
      background: #00BCD4; /* æ·±è“è‰² */
      border-radius: 0.18rem; /* åœ†è§’0.18rem */
      transition: width 0.3s; /* å®½åº¦å˜åŒ–è¿‡æ¸¡0.3ç§’ */
    }

    /* ==================== å“åº”å¼æ–­ç‚¹ - å±å¹•é«˜åº¦<800px ==================== */
    /* å‹ç¼©åˆ¶ä½œåŒºå’Œææ–™åŒºçš„é—´è· */
    @media (max-height: 800px) {
      .well-box {
        margin-bottom: 0.4rem; /* æ°´äº•åº•éƒ¨å¤–è¾¹è·ç¼©å°åˆ°0.4rem */
      }
      .inventory-box {
        margin-bottom: 0.4rem; /* åŸæ–™ä»“åº“åº•éƒ¨å¤–è¾¹è·ç¼©å°åˆ°0.4rem */
      }
      .inventory-title {
        margin-bottom: 0.25rem; /* æ ‡é¢˜åº•éƒ¨å¤–è¾¹è·ç¼©å°åˆ°0.25rem */
      }
      .recipes-box {
        margin-bottom: 0.6rem; /* é…æ–¹ä¹¦åº•éƒ¨å¤–è¾¹è·ç¼©å°åˆ°0.6rem */
        padding: 0.5rem; /* é…æ–¹ä¹¦å†…è¾¹è·ç¼©å°åˆ°0.5rem */
      }
      .recipe-item {
        padding: 0.35rem; /* é…æ–¹é¡¹å†…è¾¹è·ç¼©å°åˆ°0.35rem */
        margin-bottom: 0.35rem; /* é…æ–¹é¡¹åº•éƒ¨å¤–è¾¹è·ç¼©å°åˆ°0.35rem */
        gap: 0.25rem; /* é…æ–¹é¡¹å­å…ƒç´ é—´è·ç¼©å°åˆ°0.25rem */
      }
      .recipe-ing {
        font-size: 1.8rem; /* åŸæ–™å›¾æ ‡ç¼©å°åˆ°1.8rem */
      }
      .recipe-arrow {
        font-size: 1.2rem; /* ç®­å¤´ç¼©å°åˆ°1.2rem */
      }
      .recipe-result {
        font-size: 2.2rem; /* ç»“æœå›¾æ ‡ç¼©å°åˆ°2.2rem */
      }
      .recipe-time {
        font-size: 0.65rem; /* æ—¶é—´æ–‡å­—ç¼©å°åˆ°0.65rem */
      }
      .crafting-queue {
        margin-bottom: 0.4rem; /* åˆ¶ä½œä¸­é˜Ÿåˆ—åº•éƒ¨å¤–è¾¹è·ç¼©å°åˆ°0.4rem */
      }
    }

    /* ==================== å“åº”å¼æ–­ç‚¹ - å±å¹•é«˜åº¦<700px ==================== */
    @media (max-height: 700px) {
      .well-box {
        margin-bottom: 0.3rem; /* æ°´äº•åº•éƒ¨å¤–è¾¹è·ç¼©å°åˆ°0.3rem */
      }
      .inventory-box {
        margin-bottom: 0.3rem; /* åŸæ–™ä»“åº“åº•éƒ¨å¤–è¾¹è·ç¼©å°åˆ°0.3rem */
      }
      .inventory-title {
        margin-bottom: 0.2rem; /* æ ‡é¢˜åº•éƒ¨å¤–è¾¹è·ç¼©å°åˆ°0.2rem */
      }
      .recipes-box {
        margin-bottom: 0.5rem; /* é…æ–¹ä¹¦åº•éƒ¨å¤–è¾¹è·ç¼©å°åˆ°0.5rem */
        padding: 0.4rem; /* é…æ–¹ä¹¦å†…è¾¹è·ç¼©å°åˆ°0.4rem */
      }
      .recipe-item {
        padding: 0.3rem; /* é…æ–¹é¡¹å†…è¾¹è·ç¼©å°åˆ°0.3rem */
        margin-bottom: 0.3rem; /* é…æ–¹é¡¹åº•éƒ¨å¤–è¾¹è·ç¼©å°åˆ°0.3rem */
        gap: 0.2rem; /* é…æ–¹é¡¹å­å…ƒç´ é—´è·ç¼©å°åˆ°0.2rem */
      }
      .recipe-ing {
        font-size: 1.6rem; /* åŸæ–™å›¾æ ‡ç¼©å°åˆ°1.6rem */
      }
      .recipe-arrow {
        font-size: 1.1rem; /* ç®­å¤´ç¼©å°åˆ°1.1rem */
      }
      .recipe-result {
        font-size: 2rem; /* ç»“æœå›¾æ ‡ç¼©å°åˆ°2rem */
      }
      .recipe-time {
        font-size: 0.6rem; /* æ—¶é—´æ–‡å­—ç¼©å°åˆ°0.6rem */
      }
      .crafting-queue {
        margin-bottom: 0.3rem; /* åˆ¶ä½œä¸­é˜Ÿåˆ—åº•éƒ¨å¤–è¾¹è·ç¼©å°åˆ°0.3rem */
      }
    }

    /* ==================== å“åº”å¼æ–­ç‚¹ - å±å¹•é«˜åº¦<600px ==================== */
    @media (max-height: 600px) {
      .well-box {
        margin-bottom: 0.25rem; /* æ°´äº•åº•éƒ¨å¤–è¾¹è·ç¼©å°åˆ°0.25rem */
      }
      .inventory-box {
        margin-bottom: 0.25rem; /* åŸæ–™ä»“åº“åº•éƒ¨å¤–è¾¹è·ç¼©å°åˆ°0.25rem */
      }
      .inventory-title {
        margin-bottom: 0.15rem; /* æ ‡é¢˜åº•éƒ¨å¤–è¾¹è·ç¼©å°åˆ°0.15rem */
      }
      .recipes-box {
        margin-bottom: 0.4rem; /* é…æ–¹ä¹¦åº•éƒ¨å¤–è¾¹è·ç¼©å°åˆ°0.4rem */
        padding: 0.35rem; /* é…æ–¹ä¹¦å†…è¾¹è·ç¼©å°åˆ°0.35rem */
      }
      .recipe-item {
        padding: 0.25rem; /* é…æ–¹é¡¹å†…è¾¹è·ç¼©å°åˆ°0.25rem */
        margin-bottom: 0.25rem; /* é…æ–¹é¡¹åº•éƒ¨å¤–è¾¹è·ç¼©å°åˆ°0.25rem */
        gap: 0.18rem; /* é…æ–¹é¡¹å­å…ƒç´ é—´è·ç¼©å°åˆ°0.18rem */
      }
      .recipe-ing {
        font-size: 1.4rem; /* åŸæ–™å›¾æ ‡ç¼©å°åˆ°1.4rem */
      }
      .recipe-arrow {
        font-size: 1rem; /* ç®­å¤´ç¼©å°åˆ°1rem */
      }
      .recipe-result {
        font-size: 1.8rem; /* ç»“æœå›¾æ ‡ç¼©å°åˆ°1.8rem */
      }
      .recipe-time {
        font-size: 0.55rem; /* æ—¶é—´æ–‡å­—ç¼©å°åˆ°0.55rem */
      }
      .crafting-queue {
        margin-bottom: 0.25rem; /* åˆ¶ä½œä¸­é˜Ÿåˆ—åº•éƒ¨å¤–è¾¹è·ç¼©å°åˆ°0.25rem */
      }
    }

    /* ==================== å“åº”å¼æ–­ç‚¹ - å±å¹•é«˜åº¦<500px ==================== */
    @media (max-height: 500px) {
      .well-box {
        margin-bottom: 0.2rem; /* æ°´äº•åº•éƒ¨å¤–è¾¹è·ç¼©å°åˆ°0.2rem */
      }
      .inventory-box {
        margin-bottom: 0.2rem; /* åŸæ–™ä»“åº“åº•éƒ¨å¤–è¾¹è·ç¼©å°åˆ°0.2rem */
      }
      .inventory-title {
        margin-bottom: 0.1rem; /* æ ‡é¢˜åº•éƒ¨å¤–è¾¹è·ç¼©å°åˆ°0.1rem */
      }
      .recipes-box {
        margin-bottom: 0.3rem; /* é…æ–¹ä¹¦åº•éƒ¨å¤–è¾¹è·ç¼©å°åˆ°0.3rem */
        padding: 0.3rem; /* é…æ–¹ä¹¦å†…è¾¹è·ç¼©å°åˆ°0.3rem */
      }
      .recipe-item {
        padding: 0.2rem; /* é…æ–¹é¡¹å†…è¾¹è·ç¼©å°åˆ°0.2rem */
        margin-bottom: 0.2rem; /* é…æ–¹é¡¹åº•éƒ¨å¤–è¾¹è·ç¼©å°åˆ°0.2rem */
        gap: 0.15rem; /* é…æ–¹é¡¹å­å…ƒç´ é—´è·ç¼©å°åˆ°0.15rem */
      }
      .recipe-ing {
        font-size: 1.2rem; /* åŸæ–™å›¾æ ‡ç¼©å°åˆ°1.2rem */
      }
      .recipe-arrow {
        font-size: 0.9rem; /* ç®­å¤´ç¼©å°åˆ°0.9rem */
      }
      .recipe-result {
        font-size: 1.6rem; /* ç»“æœå›¾æ ‡ç¼©å°åˆ°1.6rem */
      }
      .recipe-time {
        font-size: 0.5rem; /* æ—¶é—´æ–‡å­—ç¼©å°åˆ°0.5rem */
      }
      .crafting-queue {
        margin-bottom: 0.2rem; /* åˆ¶ä½œä¸­é˜Ÿåˆ—åº•éƒ¨å¤–è¾¹è·ç¼©å°åˆ°0.2rem */
      }
    }
  </style>
</head>
<body>
  <!-- é¡¶éƒ¨çŠ¶æ€æ  -->
  <div class="header">
    <div class="header-item">
      <span>ğŸ’°</span>
      <span id="gold-display">100</span>
    </div>
    <div class="header-item">
      <span>ğŸ†</span>
      <span>ç¬¬ <span id="round-display">1</span> å±€</span>
    </div>
    <div class="timer">
      â±ï¸ <span id="time-display">5:00</span>
    </div>
    <div class="header-item">
      <button id="save-btn" style="padding:0.25rem 0.75rem;border-radius:0.5rem;background:#FFD700;color:#8B4513;font-weight:bold;border:none;cursor:pointer;margin-right:0.4rem;font-size:0.85rem;" onclick="saveGameWithUser()">å­˜æ¡£</button>
      <button id="load-btn" style="padding:0.25rem 0.75rem;border-radius:0.5rem;background:#90EE90;color:#2E8B57;font-weight:bold;border:none;cursor:pointer;font-size:0.85rem;" onclick="showLoadDialog()">è¯»æ¡£</button>
    </div>
  </div>

  <!-- ä¸»æ¸¸æˆåŒº -->
  <div id="game">
    <!-- å†œç”°åŒº -->
    <div class="field">
      <div class="section-title">ğŸŒ¾ å†œç”°åŒº</div>
      <div class="selection-hint">ç‚¹å‡»é€‰æ‹©ä½œç‰©ï¼Œå†ç‚¹å‡»ç©ºåœ°ç§æ¤ï¼ˆæ— é™ï¼‰</div>
      <div class="seeds-bar" id="seeds-bar">
        <!-- ç§å­æ åŠ¨æ€ç”Ÿæˆ -->
      </div>
      <div class="farm-grid" id="farm-grid">
        <!-- å†œç”°æ ¼å­åŠ¨æ€ç”Ÿæˆ -->
      </div>
    </div>

    <!-- åˆ¶ä½œåŒº -->
    <div class="kitchen">
      <div class="section-title">ğŸ‘¨â€ğŸ³ åˆ¶ä½œåŒº</div>

      <!-- æ°´äº• -->
      <div class="well-box">
        <div class="well-title">ğŸš° æ°´äº•</div>
        <button class="well-btn" id="well-btn" onclick="fetchWater()">å…è´¹æ‰“æ°´</button>
        <div class="well-progress" id="well-progress" style="display:none;">
          <div class="well-progress-fill" id="well-progress-fill" style="width: 0%"></div>
        </div>
      </div>

      <div class="recipes-box">
        <div class="inventory-title">ğŸ“– é…æ–¹ä¹¦ï¼ˆç‚¹å‡»åˆ¶ä½œï¼‰</div>
        <div id="recipes-list">
          <!-- é…æ–¹åŠ¨æ€ç”Ÿæˆ -->
        </div>
      </div>
    </div>

    <!-- ææ–™åŒº -->
    <div class="market">
      <div class="section-title">ğŸª ææ–™åŒº</div>

      <div class="inventory-box">
        <div class="inventory-title">ğŸ“¦ åŸæ–™ä»“åº“</div>
        <div class="inventory-items" id="inventory-items">
          <div style="color: #999; font-size: 0.7rem;">å»æ‰“æ°´æˆ–è´­ä¹°</div>
        </div>
      </div>

      <div class="crafting-queue">
        <div class="inventory-title">â³ åˆ¶ä½œä¸­</div>
        <div id="crafting-list">
          <div style="color: #999; font-size: 0.75rem;">æš‚æ— åˆ¶ä½œä¸­çš„ç‰©å“</div>
        </div>
      </div>

      <div class="selection-hint">èŠ±é’±è´­ä¹°åŸæ–™ï¼Œçœæ—¶çœåŠ›</div>
      <div class="market-items" id="market-items">
        <!-- å¸‚åœºç‰©å“åŠ¨æ€ç”Ÿæˆ -->
      </div>
    </div>

    <!-- å”®å–åŒº -->
    <div class="shop">
      <div class="section-title">ğŸ’° å”®å–åŒº</div>
      
      <div class="counter-box">
        <div class="inventory-title">ğŸ¥ æŸœå°ï¼ˆç‚¹å‡»é€‰æ‹©ï¼‰</div>
        <div class="counter-items" id="counter-items">
          <div style="color: #999; font-size: 0.75rem; width: 100%; text-align: center;">æš‚æ— é¢åŒ…</div>
        </div>
      </div>
      
      <div class="customers-box">
        <div class="inventory-title">ğŸ‘¥ é¡¾å®¢ï¼ˆç‚¹å‡»å‡ºå”®ï¼‰</div>
        <div id="customers-list">
          <div style="color: #999; font-size: 0.75rem; text-align: center; padding: 0.9rem;">ç­‰å¾…é¡¾å®¢å…‰ä¸´...</div>
        </div>
      </div>
    </div>
  </div>

  <!-- æ¸¸æˆç»“æŸå¼¹çª— -->
  <div class="modal-overlay" id="game-over-modal">
    <div class="modal">
      <div class="modal-title">ğŸ‰ æœ¬å±€ç»“æŸï¼</div>
      <div class="modal-content">
        <div class="modal-stats">
          <div class="stat-row">
            <span>â±ï¸ æ¸¸æˆæ—¶é•¿</span>
            <span>5:00</span>
          </div>
          <div class="stat-row">
            <span>ğŸ’° æœ¬å±€æ”¶ç›Š</span>
            <span id="round-gold">0</span>
          </div>
          <div class="stat-row">
            <span>ğŸ å”®å‡ºé¢åŒ…</span>
            <span id="round-breads">0</span>
          </div>
          <div class="stat-row">
            <span>ğŸ’µ æ€»é‡‘å¸</span>
            <span id="total-gold">0</span>
          </div>
        </div>
      </div>
      <button class="modal-btn" onclick="nextRound()">ä¸‹ä¸€å±€ â†’</button>
    </div>
  </div>

  <!-- å‡çº§å•†åº—å¼¹çª— -->
  <div class="modal-overlay" id="upgrade-modal">
    <div class="modal">
      <div class="modal-title">ğŸª å‡çº§å•†åº—</div>
      <div class="modal-content">
        ç”¨é‡‘å¸è´­ä¹°æ°¸ä¹…å‡çº§ï¼Œè®©ä¸‹ä¸€å±€æ›´è½»æ¾ï¼
      </div>
      <div class="upgrade-shop" id="upgrade-shop">
        <!-- å‡çº§é¡¹åŠ¨æ€ç”Ÿæˆ -->
      </div>
      <button class="modal-btn" onclick="startNextRound()">å¼€å§‹ä¸‹ä¸€å±€</button>
    </div>
  </div>

  <!-- æç¤ºä¿¡æ¯ -->
  <div class="toast" id="toast"></div>

  <script>
    // ==================== æ¸¸æˆé…ç½® ====================
    // ========== å¤šç”¨æˆ·å¤šå…³å¡å­˜æ¡£åŠŸèƒ½ ==========

    /**
     * ä¿å­˜æ¸¸æˆè¿›åº¦ï¼ˆå¸¦ç”¨æˆ·åï¼‰
     * åŠŸèƒ½ï¼šå¼¹å‡ºç”¨æˆ·åè¾“å…¥æ¡†ï¼Œå°†å½“å‰æ¸¸æˆçŠ¶æ€ä¿å­˜åˆ°localStorage
     * å­˜æ¡£å†…å®¹ï¼šç”¨æˆ·åã€ä¿å­˜æ—¶é—´ã€å½“å‰å…³å¡æ•°ã€å®Œæ•´æ¸¸æˆçŠ¶æ€
     */
    function saveGameWithUser() {
      // å¼¹å‡ºè‡ªå®šä¹‰ç”¨æˆ·åè¾“å…¥æ¡†ï¼Œç­‰å¾…ç”¨æˆ·è¾“å…¥
      showUsernameModal(function(username) {
        // å¦‚æœç”¨æˆ·æœªè¾“å…¥ç”¨æˆ·åæˆ–ç‚¹å‡»å–æ¶ˆï¼Œåˆ™ç»ˆæ­¢å­˜æ¡£
        if (!username) { showToast('æœªè¾“å…¥ç”¨æˆ·åï¼Œå­˜æ¡£å–æ¶ˆ'); return; }

        // å°†ç”¨æˆ·åä¿å­˜åˆ°localStorageï¼Œä½œä¸º"ä¸Šæ¬¡ä½¿ç”¨çš„ç”¨æˆ·å"ï¼Œä¸‹æ¬¡å­˜æ¡£æ—¶è‡ªåŠ¨å¡«å……
        localStorage.setItem('bakery_last_user', username);

        // è·å–å½“å‰æ—¶é—´å¹¶æ ¼å¼åŒ–ä¸ºæœ¬åœ°æ—¶é—´å­—ç¬¦ä¸²ï¼ˆå¦‚ï¼š2026/2/15 ä¸‹åˆ3:45:30ï¼‰
        const now = new Date();
        const saveTime = now.toLocaleString();

        // æ„å»ºå­˜æ¡£å¯¹è±¡ï¼ŒåŒ…å«æ‰€æœ‰éœ€è¦ä¿å­˜çš„ä¿¡æ¯
        const saveObj = {
          username,                                      // ç”¨æˆ·å
          time: saveTime,                                // å­˜æ¡£æ—¶é—´
          round: state.round,                            // å½“å‰å…³å¡æ•°
          state: JSON.parse(JSON.stringify(state))       // æ·±æ‹·è´æ¸¸æˆçŠ¶æ€ï¼Œé¿å…å¼•ç”¨é—®é¢˜
        };

        // ä»localStorageè¯»å–ç°æœ‰å­˜æ¡£åˆ—è¡¨ï¼ˆå¦‚æœä¸å­˜åœ¨åˆ™åˆå§‹åŒ–ä¸ºç©ºæ•°ç»„ï¼‰
        let saves = [];
        try { saves = JSON.parse(localStorage.getItem('bakery_saves')||'[]'); } catch {}

        // å°†æ–°å­˜æ¡£è¿½åŠ åˆ°å­˜æ¡£åˆ—è¡¨æœ«å°¾
        saves.push(saveObj);

        // å°†æ›´æ–°åçš„å­˜æ¡£åˆ—è¡¨ä¿å­˜å›localStorage
        localStorage.setItem('bakery_saves', JSON.stringify(saves));

        // æ˜¾ç¤ºå­˜æ¡£æˆåŠŸæç¤º
        showToast('å­˜æ¡£æˆåŠŸï¼ç”¨æˆ·åï¼š' + username + 'ï¼Œç¬¬' + state.round + 'å…³');
      });
    }

    /**
     * æ˜¾ç¤ºç”¨æˆ·åè¾“å…¥æ¨¡æ€æ¡†
     * @param {Function} onSubmit - å›è°ƒå‡½æ•°ï¼Œç”¨æˆ·ç‚¹å‡»ç¡®å®šæˆ–å–æ¶ˆåè°ƒç”¨ï¼Œå‚æ•°ä¸ºç”¨æˆ·åï¼ˆå–æ¶ˆæ—¶ä¸ºnullï¼‰
     * åŠŸèƒ½ï¼šåˆ›å»ºä¸€ä¸ªç¾è§‚çš„æ¨¡æ€æ¡†ï¼Œè®©ç”¨æˆ·è¾“å…¥ç”¨æˆ·å
     */
    function showUsernameModal(onSubmit) {
      // ä»localStorageè¯»å–ä¸Šæ¬¡ä½¿ç”¨çš„ç”¨æˆ·åï¼Œå¦‚æœä¸å­˜åœ¨åˆ™ä¸ºç©ºå­—ç¬¦ä¸²
      let lastUser = localStorage.getItem('bakery_last_user') || '';

      // é¿å…é‡å¤å¼¹å‡ºï¼šå¦‚æœæ¨¡æ€æ¡†å·²å­˜åœ¨ï¼Œåˆ™ç›´æ¥è¿”å›
      if (document.getElementById('username-modal-bg')) return;

      // æ„å»ºæ¨¡æ€æ¡†HTMLç»“æ„
      let html = `<div class="modal-overlay active" id="username-modal-bg" style="z-index:2001;">
        <div class="modal">
          <div class="modal-title">è¯·è¾“å…¥ç”¨æˆ·å</div>
          <div class="modal-content">
            <input id="username-input" type="text" value="${lastUser.replace(/"/g,'&quot;')}" placeholder="ç”¨æˆ·å" style="width:80%;padding:0.5rem 0.75rem;font-size:1rem;border-radius:0.5rem;border:0.06rem solid #DEB887;outline:none;" maxlength="16" autofocus />
          </div>
          <div style="margin-top:0.6rem;">
            <button class="modal-btn" id="username-ok-btn">ç¡®å®š</button>
            <button class="modal-btn" style="background:#ccc;color:#333;margin-left:0.75rem;" id="username-cancel-btn">å–æ¶ˆ</button>
          </div>
        </div>
      </div>`;
      // å†…è”æ ·å¼è¯´æ˜ï¼š
      // z-index:2001 - å±‚çº§è®¾ä¸º2001ï¼Œç¡®ä¿åœ¨å…¶ä»–å¼¹çª—ä¹‹ä¸Š
      // width:80% - è¾“å…¥æ¡†å®½åº¦å çˆ¶å®¹å™¨çš„80%
      // padding:0.5rem 0.75rem - è¾“å…¥æ¡†å†…è¾¹è·ï¼šä¸Šä¸‹0.5remï¼Œå·¦å³0.75rem
      // font-size:1rem - è¾“å…¥æ¡†å­—ä½“å¤§å°1rem
      // border-radius:0.5rem - è¾“å…¥æ¡†åœ†è§’åŠå¾„0.5rem
      // border:0.06rem solid #DEB887 - è¾¹æ¡†å®½åº¦0.06remï¼Œé¢œè‰²ä¸ºæµ…æ£•è‰²
      // maxlength="16" - ç”¨æˆ·åæœ€å¤§é•¿åº¦é™åˆ¶ä¸º16ä¸ªå­—ç¬¦
      // margin-top:0.6rem - æŒ‰é’®åŒºåŸŸé¡¶éƒ¨å¤–è¾¹è·0.6rem
      // margin-left:0.75rem - å–æ¶ˆæŒ‰é’®å·¦ä¾§å¤–è¾¹è·0.75rem

      // åˆ›å»ºDOMå…ƒç´ å¹¶æ’å…¥åˆ°é¡µé¢
      const modal = document.createElement('div');
      modal.innerHTML = html;
      document.body.appendChild(modal);

      // äº‹ä»¶ç»‘å®šï¼šå»¶è¿Ÿ100æ¯«ç§’åè‡ªåŠ¨èšç„¦åˆ°è¾“å…¥æ¡†ï¼Œæ–¹ä¾¿ç”¨æˆ·ç›´æ¥è¾“å…¥
      setTimeout(()=>{
        document.getElementById('username-input').focus();
      }, 100);

      // ç»‘å®š"ç¡®å®š"æŒ‰é’®ç‚¹å‡»äº‹ä»¶
      document.getElementById('username-ok-btn').onclick = function() {
        // è·å–è¾“å…¥æ¡†çš„å€¼å¹¶å»é™¤é¦–å°¾ç©ºæ ¼
        const val = document.getElementById('username-input').value.trim();
        // å…³é—­æ¨¡æ€æ¡†
        closeUsernameModal();
        // è°ƒç”¨å›è°ƒå‡½æ•°ï¼Œä¼ å…¥ç”¨æˆ·å
        onSubmit(val);
      };

      // ç»‘å®š"å–æ¶ˆ"æŒ‰é’®ç‚¹å‡»äº‹ä»¶
      document.getElementById('username-cancel-btn').onclick = function() {
        // å…³é—­æ¨¡æ€æ¡†
        closeUsernameModal();
        // è°ƒç”¨å›è°ƒå‡½æ•°ï¼Œä¼ å…¥nullè¡¨ç¤ºå–æ¶ˆ
        onSubmit(null);
      };

      // ç»‘å®šè¾“å…¥æ¡†å›è½¦é”®äº‹ä»¶ï¼šæŒ‰å›è½¦ç­‰åŒäºç‚¹å‡»ç¡®å®šæŒ‰é’®
      document.getElementById('username-input').onkeydown = function(e) {
        if (e.key === 'Enter') document.getElementById('username-ok-btn').click();
      };

      // å®šä¹‰å…³é—­æ¨¡æ€æ¡†çš„å…¨å±€å‡½æ•°
      window.closeUsernameModal = function() {
        // ä»DOMä¸­ç§»é™¤æ¨¡æ€æ¡†å…ƒç´ 
        if (modal && modal.parentNode) modal.parentNode.removeChild(modal);
      };
    }

    /**
     * æ˜¾ç¤ºè¯»æ¡£å¯¹è¯æ¡†
     * åŠŸèƒ½ï¼šä»localStorageè¯»å–æ‰€æœ‰å­˜æ¡£ï¼Œä»¥è¡¨æ ¼å½¢å¼å±•ç¤ºï¼Œè®©ç”¨æˆ·é€‰æ‹©è¦è¯»å–çš„å­˜æ¡£
     */
    function showLoadDialog() {
      // ä»localStorageè¯»å–å­˜æ¡£åˆ—è¡¨
      let saves = [];
      try { saves = JSON.parse(localStorage.getItem('bakery_saves')||'[]'); } catch {}

      // å¦‚æœæ²¡æœ‰å­˜æ¡£ï¼Œæ˜¾ç¤ºæç¤ºå¹¶è¿”å›
      if (!saves.length) { showToast('æ²¡æœ‰å¯ç”¨å­˜æ¡£'); return; }

      // æ„å»ºè¯»æ¡£å¯¹è¯æ¡†HTMLç»“æ„
      let html = '<div id="load-modal-bg" style="position:fixed;top:0;left:0;width:100vw;height:100vh;background:rgba(0,0,0,0.5);z-index:2000;display:flex;align-items:center;justify-content:center;">';
      // å†…è”æ ·å¼è¯´æ˜ï¼š
      // position:fixed - å›ºå®šå®šä½ï¼Œç›¸å¯¹äºæµè§ˆå™¨çª—å£
      // top:0;left:0 - ä»å·¦ä¸Šè§’å¼€å§‹
      // width:100vw;height:100vh - å®½é«˜å æ»¡æ•´ä¸ªè§†å£
      // background:rgba(0,0,0,0.5) - åŠé€æ˜é»‘è‰²èƒŒæ™¯ï¼ˆé€æ˜åº¦50%ï¼‰
      // z-index:2000 - å±‚çº§2000ï¼Œç¡®ä¿åœ¨æ¸¸æˆç•Œé¢ä¹‹ä¸Š
      // display:flex;align-items:center;justify-content:center - ä½¿ç”¨flexå¸ƒå±€ï¼Œå†…å®¹å±…ä¸­

      html += '<div style="background:#fff;padding:1.5rem 1.1rem;border-radius:1rem;min-width:16rem;max-width:90vw;max-height:80vh;overflow:auto;">';
      // å†…è”æ ·å¼è¯´æ˜ï¼š
      // background:#fff - ç™½è‰²èƒŒæ™¯
      // padding:1.5rem 1.1rem - å†…è¾¹è·ï¼šä¸Šä¸‹1.5remï¼Œå·¦å³1.1rem
      // border-radius:1rem - åœ†è§’åŠå¾„1rem
      // min-width:16rem - æœ€å°å®½åº¦16rem
      // max-width:90vw - æœ€å¤§å®½åº¦ä¸ºè§†å£å®½åº¦çš„90%
      // max-height:80vh - æœ€å¤§é«˜åº¦ä¸ºè§†å£é«˜åº¦çš„80%
      // overflow:auto - å†…å®¹è¶…å‡ºæ—¶æ˜¾ç¤ºæ»šåŠ¨æ¡

      html += '<div style="font-size:1.1rem;font-weight:bold;color:#8B4513;margin-bottom:0.6rem;">é€‰æ‹©å­˜æ¡£</div>';
      // æ ‡é¢˜æ ·å¼ï¼šå­—ä½“å¤§å°1.1remï¼ŒåŠ ç²—ï¼Œæ£•è‰²ï¼Œåº•éƒ¨å¤–è¾¹è·0.6rem

      html += '<table style="width:100%;font-size:0.85rem;margin-bottom:0.6rem;">';
      // è¡¨æ ¼æ ·å¼ï¼šå®½åº¦100%ï¼Œå­—ä½“å¤§å°0.85remï¼Œåº•éƒ¨å¤–è¾¹è·0.6rem

      html += '<tr><th>ç”¨æˆ·å</th><th>å…³å¡</th><th>æ—¶é—´</th><th></th></tr>';
      // è¡¨å¤´ï¼šç”¨æˆ·åã€å…³å¡ã€æ—¶é—´ã€æ“ä½œåˆ—

      // éå†æ‰€æœ‰å­˜æ¡£ï¼Œç”Ÿæˆè¡¨æ ¼è¡Œ
      saves.forEach((s, i) => {
        html += `<tr><td>${s.username}</td><td>${s.round}</td><td>${s.time}</td><td><button onclick="loadGameFromList(${i})" style='padding:0.12rem 0.5rem;border-radius:0.4rem;background:#90EE90;color:#2E8B57;border:none;cursor:pointer;font-size:0.75rem;'>è¯»æ¡£</button></td></tr>`;
        // æŒ‰é’®æ ·å¼è¯´æ˜ï¼š
        // padding:0.12rem 0.5rem - å†…è¾¹è·ï¼šä¸Šä¸‹0.12remï¼Œå·¦å³0.5rem
        // border-radius:0.4rem - åœ†è§’åŠå¾„0.4rem
        // background:#90EE90 - æµ…ç»¿è‰²èƒŒæ™¯
        // color:#2E8B57 - æ·±ç»¿è‰²æ–‡å­—
        // font-size:0.75rem - å­—ä½“å¤§å°0.75rem
      });

      html += '</table>';
      html += '<button onclick="closeLoadModal()" style="padding:0.4rem 1.1rem;border-radius:0.5rem;background:#ccc;color:#333;border:none;cursor:pointer;font-size:0.85rem;">å–æ¶ˆ</button>';
      // å–æ¶ˆæŒ‰é’®æ ·å¼ï¼šå†…è¾¹è·0.4rem 1.1remï¼Œåœ†è§’0.5remï¼Œç°è‰²èƒŒæ™¯ï¼Œå­—ä½“0.85rem

      html += '</div></div>';

      // åˆ›å»ºDOMå…ƒç´ å¹¶æ’å…¥åˆ°é¡µé¢
      const modal = document.createElement('div');
      modal.innerHTML = html;
      document.body.appendChild(modal);

      // å®šä¹‰å…³é—­è¯»æ¡£å¯¹è¯æ¡†çš„å…¨å±€å‡½æ•°
      window.closeLoadModal = function() { document.body.removeChild(modal); };
    }

    /**
     * ä»å­˜æ¡£åˆ—è¡¨ä¸­è¯»å–æŒ‡å®šå­˜æ¡£
     * @param {number} idx - å­˜æ¡£åœ¨åˆ—è¡¨ä¸­çš„ç´¢å¼•ï¼ˆä»0å¼€å§‹ï¼‰
     * åŠŸèƒ½ï¼šè¯»å–æŒ‡å®šç´¢å¼•çš„å­˜æ¡£ï¼Œæ¢å¤æ¸¸æˆçŠ¶æ€åˆ°è¯¥å…³å¡çš„åˆå§‹çŠ¶æ€
     */
    function loadGameFromList(idx) {
      // ä»localStorageè¯»å–å­˜æ¡£åˆ—è¡¨
      let saves = [];
      try { saves = JSON.parse(localStorage.getItem('bakery_saves')||'[]'); } catch {}

      // æ£€æŸ¥å­˜æ¡£æ˜¯å¦å­˜åœ¨
      if (!saves[idx]) { showToast('å­˜æ¡£ä¸å­˜åœ¨'); return; }

      // è·å–æŒ‡å®šç´¢å¼•çš„å­˜æ¡£
      const save = saves[idx];

      // æ¢å¤åˆ°è¯¥å…³å¡æœªå¼€å§‹çŠ¶æ€ï¼ˆä¿ç•™æ°¸ä¹…å‡çº§å’Œé‡‘å¸ï¼Œé‡ç½®æœ¬å±€çŠ¶æ€ï¼‰
      restoreGameToRoundStart(save.state, save.round);

      // å…³é—­è¯»æ¡£å¯¹è¯æ¡†
      closeLoadModal();

      // æ˜¾ç¤ºè¯»æ¡£æˆåŠŸæç¤º
      showToast('å·²è¯»æ¡£ï¼š' + save.username + ' ç¬¬' + save.round + 'å…³');
    }

    // å°†å‡½æ•°æš´éœ²åˆ°å…¨å±€ä½œç”¨åŸŸï¼Œä¾›HTML onclickè°ƒç”¨
    window.showLoadDialog = showLoadDialog;
    window.loadGameFromList = loadGameFromList;

    /**
     * æ¢å¤æ¸¸æˆåˆ°æŒ‡å®šå…³å¡çš„åˆå§‹çŠ¶æ€
     * @param {Object} savedState - ä¿å­˜çš„æ¸¸æˆçŠ¶æ€å¯¹è±¡
     * @param {number} round - è¦æ¢å¤åˆ°çš„å…³å¡æ•°
     * åŠŸèƒ½ï¼šåªæ¢å¤æ°¸ä¹…å‡çº§ã€é‡‘å¸ã€å…³å¡æ•°ï¼Œé‡ç½®æœ¬å±€çŠ¶æ€ï¼ˆä½œç‰©ã€åº“å­˜ã€åˆ¶ä½œé˜Ÿåˆ—ç­‰ï¼‰
     */
    function restoreGameToRoundStart(savedState, round) {
      // æ¢å¤é‡‘å¸æ•°é‡
      state.gold = savedState.gold;

      // æ¢å¤å…³å¡æ•°
      state.round = round;

      // æ·±æ‹·è´æ¢å¤æ°¸ä¹…å‡çº§æ•°æ®ï¼ˆç”Ÿé•¿é€Ÿåº¦ã€åˆ¶ä½œé€Ÿåº¦ã€æ°´äº•é€Ÿåº¦ã€å·²è§£é”ä½œç‰©ï¼‰
      state.permanent = JSON.parse(JSON.stringify(savedState.permanent));

      // é‡ç½®æœ¬å±€çŠ¶æ€
      state.time = 300;                                    // é‡ç½®æ—¶é—´ä¸º300ç§’ï¼ˆ5åˆ†é’Ÿï¼‰
      state.isPlaying = true;                              // è®¾ç½®æ¸¸æˆä¸ºè¿›è¡Œä¸­çŠ¶æ€
      state.crops = [];                                    // æ¸…ç©ºå†œç”°ä½œç‰©æ•°ç»„
      state.inventory = {};                                // æ¸…ç©ºåº“å­˜å¯¹è±¡
      state.crafting = [];                                 // æ¸…ç©ºåˆ¶ä½œé˜Ÿåˆ—æ•°ç»„
      state.counter = {};                                  // æ¸…ç©ºæŸœå°é¢åŒ…å¯¹è±¡
      state.customers = [];                                // æ¸…ç©ºé¡¾å®¢æ•°ç»„
      state.well = { fetching: false, finishTime: 0 };     // é‡ç½®æ°´äº•çŠ¶æ€ï¼šæœªåœ¨æ‰“æ°´ï¼Œå®Œæˆæ—¶é—´ä¸º0
      state.selectedSeed = null;                           // æ¸…ç©ºé€‰ä¸­çš„ç§å­
      state.selectedIngredient = null;                     // æ¸…ç©ºé€‰ä¸­çš„åŸæ–™
      state.selectedBread = null;                          // æ¸…ç©ºé€‰ä¸­çš„é¢åŒ…
      state.stats = { breadsSold: 0, goldEarned: 0 };      // é‡ç½®æœ¬å±€ç»Ÿè®¡ï¼šå”®å‡ºé¢åŒ…æ•°0ï¼Œèµšå–é‡‘å¸æ•°0

      // æ›´æ–°UIæ˜¾ç¤º
      updateUI();

      // æ›´æ–°è®¡æ—¶å™¨æ˜¾ç¤º
      updateTimer();

      // å¯åŠ¨æ¸¸æˆå¾ªç¯
      startGameLoop();
    }

    /**
     * é¡µé¢åŠ è½½æ—¶è‡ªåŠ¨ä»æœ€æ–°å­˜æ¡£æ¢å¤
     * åŠŸèƒ½ï¼šåœ¨é¡µé¢åŠ è½½æ—¶ï¼Œè‡ªåŠ¨è¯»å–æœ€åä¸€ä¸ªå­˜æ¡£å¹¶æ¢å¤æ¸¸æˆçŠ¶æ€
     */
    function tryAutoLoad() {
      // ä»localStorageè¯»å–å­˜æ¡£åˆ—è¡¨
      let saves = [];
      try { saves = JSON.parse(localStorage.getItem('bakery_saves')||'[]'); } catch {}

      // å¦‚æœå­˜åœ¨å­˜æ¡£ï¼Œåˆ™è‡ªåŠ¨åŠ è½½æœ€åä¸€ä¸ªå­˜æ¡£
      if (saves.length) {
        const save = saves[saves.length-1];  // è·å–æ•°ç»„æœ€åä¸€ä¸ªå…ƒç´ ï¼ˆæœ€æ–°å­˜æ¡£ï¼‰
        restoreGameToRoundStart(save.state, save.round);
        showToast('å·²è‡ªåŠ¨åŠ è½½ä¸Šæ¬¡å­˜æ¡£ï¼š' + save.username + ' ç¬¬' + save.round + 'å…³');
      }
    }

    // ==================== æ¸¸æˆæ•°æ®é…ç½® ====================

    /**
     * ä½œç‰©æ•°æ®é…ç½®
     * æ¯ç§ä½œç‰©åŒ…å«ï¼šåç§°ã€è¡¨æƒ…ç¬¦å·ã€ç”Ÿé•¿æ—¶é—´ï¼ˆç§’ï¼‰ã€äº§å‡ºç‰©å“ã€äº§å‡ºæ•°é‡
     */
    const CROP_DATA = {
      wheat: { name: 'å°éº¦', emoji: 'ğŸŒ¾', growTime: 5, output: 'flour', outputCount: 2 },
      // å°éº¦ï¼šç”Ÿé•¿æ—¶é—´5ç§’ï¼Œäº§å‡º2ä¸ªé¢ç²‰
      cow: { name: 'å¥¶ç‰›', emoji: 'ğŸ„', growTime: 10, output: 'milk', outputCount: 1 },
      // å¥¶ç‰›ï¼šç”Ÿé•¿æ—¶é—´10ç§’ï¼Œäº§å‡º1ä¸ªç‰›å¥¶
      sugarcane: { name: 'ç”˜è”—', emoji: 'ğŸ‹', growTime: 8, output: 'sugar', outputCount: 1 },
      // ç”˜è”—ï¼šç”Ÿé•¿æ—¶é—´8ç§’ï¼Œäº§å‡º1ä¸ªç³–
      chicken: { name: 'æ¯é¸¡', emoji: 'ğŸ”', growTime: 12, output: 'egg', outputCount: 1 }
      // æ¯é¸¡ï¼šç”Ÿé•¿æ—¶é—´12ç§’ï¼Œäº§å‡º1ä¸ªé¸¡è›‹
    };

    /**
     * ç‰©å“æ•°æ®é…ç½®
     * æ¯ç§ç‰©å“åŒ…å«ï¼šåç§°ã€è¡¨æƒ…ç¬¦å·ã€ä»·æ ¼ï¼ˆå¦‚æœæ˜¯æˆå“é¢åŒ…ï¼‰
     */
    const ITEM_DATA = {
      // åŸæ–™ç±»ç‰©å“ï¼ˆæ— ä»·æ ¼ï¼‰
      flour: { name: 'é¢ç²‰', emoji: 'ğŸŒ¾' },
      milk: { name: 'ç‰›å¥¶', emoji: 'ğŸ¥›' },
      sugar: { name: 'ç³–', emoji: 'ğŸ¬' },
      egg: { name: 'é¸¡è›‹', emoji: 'ğŸ¥š' },
      water: { name: 'æ°´', emoji: 'ğŸ’§' },

      // ä¸­é—´äº§ç‰©ï¼ˆæ— ä»·æ ¼ï¼‰
      dough: { name: 'é¢å›¢', emoji: 'ğŸ¥Ÿ' },
      butter_dough: { name: 'é»„æ²¹é¢å›¢', emoji: 'ğŸ§ˆ' },
      cake_batter: { name: 'è›‹ç³•ç³Š', emoji: 'ğŸ¥£' },

      // æˆå“é¢åŒ…ï¼ˆæœ‰ä»·æ ¼ï¼Œå¯å‡ºå”®ï¼‰
      white_bread: { name: 'ç™½é¢åŒ…', emoji: 'ğŸ', price: 20 },
      // ç™½é¢åŒ…å”®ä»·ï¼š20é‡‘å¸
      butter_bread: { name: 'é»„æ²¹é¢åŒ…', emoji: 'ğŸ¥', price: 50 },
      // é»„æ²¹é¢åŒ…å”®ä»·ï¼š50é‡‘å¸
      sweet_bread: { name: 'ç”œé¢åŒ…', emoji: 'ğŸ¥–', price: 80 },
      // ç”œé¢åŒ…å”®ä»·ï¼š80é‡‘å¸
      cake: { name: 'è›‹ç³•', emoji: 'ğŸ°', price: 150 }
      // è›‹ç³•å”®ä»·ï¼š150é‡‘å¸
    };

    /**
     * é…æ–¹æ•°æ®é…ç½®
     * æ¯ä¸ªé…æ–¹åŒ…å«ï¼šIDã€åç§°ã€æ‰€éœ€åŸæ–™æ•°ç»„ã€åˆ¶ä½œæ—¶é—´ï¼ˆç§’ï¼‰ã€äº§å‡ºç‰©å“
     */
    const RECIPES = [
      { id: 'dough', name: 'é¢å›¢', ingredients: ['flour', 'water'], time: 1, output: 'dough' },
      // é¢å›¢é…æ–¹ï¼šéœ€è¦é¢ç²‰+æ°´ï¼Œåˆ¶ä½œæ—¶é—´1ç§’ï¼Œäº§å‡ºé¢å›¢

      { id: 'white_bread', name: 'ç™½é¢åŒ…', ingredients: ['dough'], time: 2, output: 'white_bread' },
      // ç™½é¢åŒ…é…æ–¹ï¼šéœ€è¦é¢å›¢ï¼Œåˆ¶ä½œæ—¶é—´2ç§’ï¼Œäº§å‡ºç™½é¢åŒ…

      { id: 'butter_dough', name: 'é»„æ²¹é¢å›¢', ingredients: ['dough', 'milk'], time: 2, output: 'butter_dough' },
      // é»„æ²¹é¢å›¢é…æ–¹ï¼šéœ€è¦é¢å›¢+ç‰›å¥¶ï¼Œåˆ¶ä½œæ—¶é—´2ç§’ï¼Œäº§å‡ºé»„æ²¹é¢å›¢

      { id: 'butter_bread', name: 'é»„æ²¹é¢åŒ…', ingredients: ['butter_dough'], time: 3, output: 'butter_bread' },
      // é»„æ²¹é¢åŒ…é…æ–¹ï¼šéœ€è¦é»„æ²¹é¢å›¢ï¼Œåˆ¶ä½œæ—¶é—´3ç§’ï¼Œäº§å‡ºé»„æ²¹é¢åŒ…

      { id: 'cake_batter', name: 'è›‹ç³•ç³Š', ingredients: ['dough', 'sugar', 'egg'], time: 3, output: 'cake_batter' },
      // è›‹ç³•ç³Šé…æ–¹ï¼šéœ€è¦é¢å›¢+ç³–+é¸¡è›‹ï¼Œåˆ¶ä½œæ—¶é—´3ç§’ï¼Œäº§å‡ºè›‹ç³•ç³Š

      { id: 'cake', name: 'è›‹ç³•', ingredients: ['cake_batter'], time: 5, output: 'cake' }
      // è›‹ç³•é…æ–¹ï¼šéœ€è¦è›‹ç³•ç³Šï¼Œåˆ¶ä½œæ—¶é—´5ç§’ï¼Œäº§å‡ºè›‹ç³•
    ];

    /**
     * å¸‚åœºç‰©å“é…ç½®
     * æ¯ä¸ªç‰©å“åŒ…å«ï¼šIDã€åç§°ã€è¡¨æƒ…ç¬¦å·ã€è´­ä¹°ä»·æ ¼ï¼ˆé‡‘å¸ï¼‰ã€æè¿°
     */
    const MARKET_ITEMS = [
      { id: 'flour', name: 'é¢ç²‰', emoji: 'ğŸŒ¾', price: 5, desc: 'åˆ¶ä½œé¢å›¢å¿…å¤‡' },
      // é¢ç²‰ï¼šè´­ä¹°ä»·æ ¼5é‡‘å¸

      { id: 'water', name: 'æ°´', emoji: 'ğŸ’§', price: 3, desc: 'åˆ¶ä½œé¢å›¢å¿…å¤‡' },
      // æ°´ï¼šè´­ä¹°ä»·æ ¼3é‡‘å¸ï¼ˆä¹Ÿå¯ä»¥å…è´¹æ‰“æ°´è·å¾—ï¼‰

      { id: 'milk', name: 'ç‰›å¥¶', emoji: 'ğŸ¥›', price: 10, desc: 'åˆ¶ä½œé»„æ²¹é¢åŒ…' },
      // ç‰›å¥¶ï¼šè´­ä¹°ä»·æ ¼10é‡‘å¸

      { id: 'sugar', name: 'ç³–', emoji: 'ğŸ¬', price: 8, desc: 'åˆ¶ä½œè›‹ç³•' },
      // ç³–ï¼šè´­ä¹°ä»·æ ¼8é‡‘å¸

      { id: 'egg', name: 'é¸¡è›‹', emoji: 'ğŸ¥š', price: 12, desc: 'åˆ¶ä½œè›‹ç³•' }
      // é¸¡è›‹ï¼šè´­ä¹°ä»·æ ¼12é‡‘å¸
    ];

    /**
     * å‡çº§å•†åº—é…ç½®
     * æ¯ä¸ªå‡çº§åŒ…å«ï¼šIDã€åç§°ã€è¡¨æƒ…ç¬¦å·ã€æè¿°ã€ä»·æ ¼ï¼ˆé‡‘å¸ï¼‰ã€æ•ˆæœå‡½æ•°
     */
    const UPGRADES = [
      { id: 'grow_speed', name: 'ç”Ÿé•¿åŠ é€Ÿ', emoji: 'âš¡', desc: 'æ‰€æœ‰ä½œç‰©ç”Ÿé•¿æ—¶é—´-20%', price: 1000, effect: () => { state.permanent.growSpeed *= 0.8; } },
      // ç”Ÿé•¿åŠ é€Ÿï¼šä»·æ ¼1000é‡‘å¸ï¼Œæ•ˆæœæ˜¯å°†ç”Ÿé•¿é€Ÿåº¦ç³»æ•°ä¹˜ä»¥0.8ï¼ˆå³æ—¶é—´å‡å°‘20%ï¼‰

      { id: 'craft_speed', name: 'åˆ¶ä½œåŠ é€Ÿ', emoji: 'ğŸ”¥', desc: 'åˆ¶ä½œæ—¶é—´-20%', price: 1500, effect: () => { state.permanent.craftSpeed *= 0.8; } },
      // åˆ¶ä½œåŠ é€Ÿï¼šä»·æ ¼1500é‡‘å¸ï¼Œæ•ˆæœæ˜¯å°†åˆ¶ä½œé€Ÿåº¦ç³»æ•°ä¹˜ä»¥0.8ï¼ˆå³æ—¶é—´å‡å°‘20%ï¼‰

      { id: 'well_speed', name: 'æ°´äº•åŠ é€Ÿ', emoji: 'ğŸš°', desc: 'æ‰“æ°´æ—¶é—´-30%', price: 800, effect: () => { state.permanent.wellSpeed *= 0.7; } },
      // æ°´äº•åŠ é€Ÿï¼šä»·æ ¼800é‡‘å¸ï¼Œæ•ˆæœæ˜¯å°†æ°´äº•é€Ÿåº¦ç³»æ•°ä¹˜ä»¥0.7ï¼ˆå³æ—¶é—´å‡å°‘30%ï¼‰

      { id: 'unlock_cow', name: 'è§£é”å¥¶ç‰›', emoji: 'ğŸ„', desc: 'å±€å†…å¯ç§æ¤å¥¶ç‰›', price: 200, effect: () => { state.permanent.unlockedCrops.push('cow'); } },
      // è§£é”å¥¶ç‰›ï¼šä»·æ ¼200é‡‘å¸ï¼Œæ•ˆæœæ˜¯å°†'cow'æ·»åŠ åˆ°å·²è§£é”ä½œç‰©æ•°ç»„

      { id: 'unlock_sugarcane', name: 'è§£é”ç”˜è”—', emoji: 'ğŸ‹', desc: 'å±€å†…å¯ç§æ¤ç”˜è”—', price: 800, effect: () => { state.permanent.unlockedCrops.push('sugarcane'); } },
      // è§£é”ç”˜è”—ï¼šä»·æ ¼800é‡‘å¸ï¼Œæ•ˆæœæ˜¯å°†'sugarcane'æ·»åŠ åˆ°å·²è§£é”ä½œç‰©æ•°ç»„

      { id: 'unlock_chicken', name: 'è§£é”æ¯é¸¡', emoji: 'ğŸ”', desc: 'å±€å†…å¯ç§æ¤æ¯é¸¡', price: 1500, effect: () => { state.permanent.unlockedCrops.push('chicken'); } }
      // è§£é”æ¯é¸¡ï¼šä»·æ ¼1500é‡‘å¸ï¼Œæ•ˆæœæ˜¯å°†'chicken'æ·»åŠ åˆ°å·²è§£é”ä½œç‰©æ•°ç»„
    ];

    /**
     * é¡¾å®¢ç±»å‹é…ç½®
     * æ¯ç§ç±»å‹åŒ…å«ï¼šè¡¨æƒ…ç¬¦å·ã€å¯èƒ½çš„åå­—æ•°ç»„
     * ç”¨äºéšæœºç”Ÿæˆä¸åŒå¤–è§‚å’Œåå­—çš„é¡¾å®¢
     */
    const CUSTOMER_TYPES = [
      { emoji: 'ğŸ‘¨', names: ['å¼ å…ˆç”Ÿ', 'æå…ˆç”Ÿ', 'ç‹å…ˆç”Ÿ'] },
      // ç”·æ€§é¡¾å®¢ï¼š3ä¸ªå¯èƒ½çš„åå­—

      { emoji: 'ğŸ‘©', names: ['å¼ å¥³å£«', 'æå¥³å£«', 'ç‹å¥³å£«'] },
      // å¥³æ€§é¡¾å®¢ï¼š3ä¸ªå¯èƒ½çš„åå­—

      { emoji: 'ğŸ‘´', names: ['è€çˆ·çˆ·', 'è€å¤§çˆ·'] },
      // è€å¹´ç”·æ€§é¡¾å®¢ï¼š2ä¸ªå¯èƒ½çš„åå­—

      { emoji: 'ğŸ‘µ', names: ['è€å¥¶å¥¶', 'è€å¤§å¨˜'] },
      // è€å¹´å¥³æ€§é¡¾å®¢ï¼š2ä¸ªå¯èƒ½çš„åå­—

      { emoji: 'ğŸ‘¦', names: ['å°æ˜', 'å°åˆš', 'å°å¼º'] },
      // ç”·å­©é¡¾å®¢ï¼š3ä¸ªå¯èƒ½çš„åå­—

      { emoji: 'ğŸ‘§', names: ['å°çº¢', 'å°ä¸½', 'å°ç¾'] }
      // å¥³å­©é¡¾å®¢ï¼š3ä¸ªå¯èƒ½çš„åå­—
    ];

    // ==================== æ¸¸æˆçŠ¶æ€ ====================
    /**
     * æ¸¸æˆä¸»çŠ¶æ€å¯¹è±¡
     * åŒ…å«æ‰€æœ‰æ¸¸æˆæ•°æ®ï¼šé‡‘å¸ã€å…³å¡ã€æ—¶é—´ã€æ°¸ä¹…å‡çº§ã€æœ¬å±€çŠ¶æ€ç­‰
     */
    const state = {
      gold: 100,                    // åˆå§‹é‡‘å¸æ•°é‡ï¼š100é‡‘å¸
      round: 1,                     // åˆå§‹å…³å¡æ•°ï¼šç¬¬1å…³
      time: 300,                    // æ¯å±€æ¸¸æˆæ—¶é—´ï¼š300ç§’ï¼ˆ5åˆ†é’Ÿï¼‰
      isPlaying: false,             // æ¸¸æˆæ˜¯å¦æ­£åœ¨è¿›è¡Œï¼šåˆå§‹ä¸ºfalse

      // æ°¸ä¹…å‡çº§ï¼ˆè·¨å…³å¡ä¿ç•™ï¼‰
      permanent: {
        growSpeed: 1,               // ç”Ÿé•¿é€Ÿåº¦ç³»æ•°ï¼š1è¡¨ç¤ºæ­£å¸¸é€Ÿåº¦ï¼Œ0.8è¡¨ç¤ºå¿«20%
        craftSpeed: 1,              // åˆ¶ä½œé€Ÿåº¦ç³»æ•°ï¼š1è¡¨ç¤ºæ­£å¸¸é€Ÿåº¦ï¼Œ0.8è¡¨ç¤ºå¿«20%
        wellSpeed: 1,               // æ°´äº•é€Ÿåº¦ç³»æ•°ï¼š1è¡¨ç¤ºæ­£å¸¸é€Ÿåº¦ï¼Œ0.7è¡¨ç¤ºå¿«30%
        unlockedCrops: ['wheat', 'cow', 'sugarcane', 'chicken']
        // å·²è§£é”çš„ä½œç‰©åˆ—è¡¨ï¼šåˆå§‹å…¨éƒ¨è§£é”ï¼ˆå°éº¦ã€å¥¶ç‰›ã€ç”˜è”—ã€æ¯é¸¡ï¼‰
      },

      // æœ¬å±€çŠ¶æ€ï¼ˆæ¯å±€é‡ç½®ï¼‰
      crops: [],                    // å†œç”°ä½œç‰©æ•°ç»„ï¼šå­˜å‚¨9ä¸ªæ ¼å­çš„ä½œç‰©çŠ¶æ€
      inventory: {},                // åº“å­˜å¯¹è±¡ï¼šé”®ä¸ºç‰©å“IDï¼Œå€¼ä¸ºæ•°é‡
      crafting: [],                 // åˆ¶ä½œé˜Ÿåˆ—æ•°ç»„ï¼šå­˜å‚¨æ­£åœ¨åˆ¶ä½œçš„ç‰©å“
      counter: {},                  // æŸœå°é¢åŒ…å¯¹è±¡ï¼šé”®ä¸ºé¢åŒ…IDï¼Œå€¼ä¸ºæ•°é‡
      customers: [],                // é¡¾å®¢æ•°ç»„ï¼šå­˜å‚¨å½“å‰ç­‰å¾…çš„é¡¾å®¢

      // æ°´äº•çŠ¶æ€
      well: {
        fetching: false,            // æ˜¯å¦æ­£åœ¨æ‰“æ°´ï¼šfalseè¡¨ç¤ºæœªæ‰“æ°´
        finishTime: 0               // æ‰“æ°´å®Œæˆæ—¶é—´æˆ³ï¼š0è¡¨ç¤ºæœªå¼€å§‹
      },

      // é€‰ä¸­çŠ¶æ€ï¼ˆç”¨äºUIäº¤äº’ï¼‰
      selectedSeed: null,           // é€‰ä¸­çš„ç§å­ç±»å‹ï¼šnullè¡¨ç¤ºæœªé€‰ä¸­
      selectedIngredient: null,     // é€‰ä¸­çš„åŸæ–™IDï¼šnullè¡¨ç¤ºæœªé€‰ä¸­
      selectedBread: null,          // é€‰ä¸­çš„é¢åŒ…IDï¼šnullè¡¨ç¤ºæœªé€‰ä¸­

      // æœ¬å±€ç»Ÿè®¡
      stats: {
        breadsSold: 0,              // æœ¬å±€å”®å‡ºé¢åŒ…æ•°é‡ï¼šåˆå§‹ä¸º0
        goldEarned: 0               // æœ¬å±€èµšå–é‡‘å¸æ•°é‡ï¼šåˆå§‹ä¸º0
      }
    };

    // ==================== åˆå§‹åŒ– ====================
    /**
     * æ¸¸æˆåˆå§‹åŒ–å‡½æ•°
     * åŠŸèƒ½ï¼šåˆ›å»ºå†œç”°æ ¼å­DOMå…ƒç´ ï¼Œå¯åŠ¨æ–°ä¸€å±€æ¸¸æˆ
     */
    function init() {
      // åˆå§‹åŒ–å†œç”°æ ¼å­ï¼ˆ9æ ¼3x3å¸ƒå±€ï¼‰
      const farmGrid = document.getElementById('farm-grid');
      farmGrid.innerHTML = '';  // æ¸…ç©ºç°æœ‰å†…å®¹

      // å¾ªç¯åˆ›å»º9ä¸ªå†œç”°æ ¼å­
      for (let i = 0; i < 9; i++) {
        const plot = document.createElement('div');
        plot.className = 'farm-plot';           // è®¾ç½®CSSç±»å
        plot.dataset.index = i;                 // è®¾ç½®data-indexå±æ€§ï¼Œå€¼ä¸º0-8
        plot.onclick = () => onPlotClick(i);    // ç»‘å®šç‚¹å‡»äº‹ä»¶ï¼Œä¼ å…¥æ ¼å­ç´¢å¼•
        farmGrid.appendChild(plot);             // æ·»åŠ åˆ°å†œç”°ç½‘æ ¼å®¹å™¨
      }

      // å¯åŠ¨æ–°ä¸€å±€æ¸¸æˆ
      startNewRound();
    }

    /**
     * å¼€å§‹æ–°ä¸€å±€æ¸¸æˆ
     * åŠŸèƒ½ï¼šé‡ç½®æœ¬å±€æ‰€æœ‰çŠ¶æ€ï¼Œæ›´æ–°UIï¼Œå¯åŠ¨æ¸¸æˆå¾ªç¯
     */
    function startNewRound() {
      // é‡ç½®æœ¬å±€çŠ¶æ€
      state.time = 300;                                    // é‡ç½®æ—¶é—´ä¸º300ç§’ï¼ˆ5åˆ†é’Ÿï¼‰
      state.isPlaying = true;                              // è®¾ç½®æ¸¸æˆä¸ºè¿›è¡Œä¸­
      state.crops = [];                                    // æ¸…ç©ºå†œç”°ä½œç‰©æ•°ç»„
      state.inventory = {};                                // æ¸…ç©ºåº“å­˜
      state.crafting = [];                                 // æ¸…ç©ºåˆ¶ä½œé˜Ÿåˆ—
      state.counter = {};                                  // æ¸…ç©ºæŸœå°é¢åŒ…
      state.customers = [];                                // æ¸…ç©ºé¡¾å®¢åˆ—è¡¨
      state.well = { fetching: false, finishTime: 0 };     // é‡ç½®æ°´äº•çŠ¶æ€
      state.selectedSeed = null;                           // æ¸…ç©ºé€‰ä¸­çš„ç§å­
      state.selectedIngredient = null;                     // æ¸…ç©ºé€‰ä¸­çš„åŸæ–™
      state.selectedBread = null;                          // æ¸…ç©ºé€‰ä¸­çš„é¢åŒ…
      state.stats = { breadsSold: 0, goldEarned: 0 };      // é‡ç½®æœ¬å±€ç»Ÿè®¡æ•°æ®

      // æ›´æ–°UIæ˜¾ç¤º
      updateUI();

      // å…³é—­æ‰€æœ‰å¼¹çª—
      document.getElementById('game-over-modal').classList.remove('active');
      document.getElementById('upgrade-modal').classList.remove('active');

      // å¼€å§‹æ¸¸æˆå¾ªç¯ï¼ˆè®¡æ—¶å™¨ã€ä½œç‰©ç”Ÿé•¿ã€åˆ¶ä½œç­‰ï¼‰
      startGameLoop();

      // æ˜¾ç¤ºå¼€å§‹æç¤º
      showToast('ç¬¬ ' + state.round + ' å±€å¼€å§‹ï¼ç§æ¤å°éº¦â†’æ‰“æ°´â†’åšé¢å›¢â†’çƒ¤é¢åŒ…ï¼');
    }

    // ==================== æ¸¸æˆå¾ªç¯ ====================
    let gameInterval;           // ä¸»æ¸¸æˆå¾ªç¯å®šæ—¶å™¨ï¼ˆæ¯ç§’æ‰§è¡Œä¸€æ¬¡ï¼‰
    let customerInterval;       // é¡¾å®¢ç”Ÿæˆå®šæ—¶å™¨ï¼ˆéšæœºé—´éš”ç”Ÿæˆé¡¾å®¢ï¼‰

    /**
     * å¯åŠ¨æ¸¸æˆå¾ªç¯
     * åŠŸèƒ½ï¼šå¯åŠ¨ä¸¤ä¸ªå®šæ—¶å™¨ï¼Œä¸€ä¸ªç”¨äºæ¸¸æˆä¸»å¾ªç¯ï¼ˆæ¯ç§’ï¼‰ï¼Œä¸€ä¸ªç”¨äºç”Ÿæˆé¡¾å®¢ï¼ˆéšæœºé—´éš”ï¼‰
     */
    function startGameLoop() {
      // æ¸…é™¤ä¹‹å‰çš„å®šæ—¶å™¨ï¼ˆé¿å…é‡å¤å¯åŠ¨ï¼‰
      clearInterval(gameInterval);
      clearInterval(customerInterval);

      // ä¸»æ¸¸æˆå¾ªç¯ï¼šæ¯1000æ¯«ç§’ï¼ˆ1ç§’ï¼‰æ‰§è¡Œä¸€æ¬¡
      gameInterval = setInterval(() => {
        // å¦‚æœæ¸¸æˆæœªè¿›è¡Œï¼Œåˆ™è·³è¿‡æœ¬æ¬¡å¾ªç¯
        if (!state.isPlaying) return;

        // æ—¶é—´å‡1ç§’
        state.time--;

        // å¦‚æœæ—¶é—´è€—å°½ï¼Œç»“æŸæ¸¸æˆ
        if (state.time <= 0) {
          endGame();
          return;
        }

        // æ›´æ–°ä½œç‰©ç”Ÿé•¿çŠ¶æ€
        updateCrops();

        // æ›´æ–°æ°´äº•æ‰“æ°´è¿›åº¦
        updateWell();

        // æ›´æ–°åˆ¶ä½œé˜Ÿåˆ—è¿›åº¦
        updateCrafting();

        // æ›´æ–°é¡¾å®¢è€å¿ƒå€¼
        updateCustomers();

        // æ›´æ–°è®¡æ—¶å™¨æ˜¾ç¤º
        updateTimer();
      }, 1000);  // é—´éš”1000æ¯«ç§’ï¼ˆ1ç§’ï¼‰

      // é¡¾å®¢ç”Ÿæˆå¾ªç¯ï¼šéšæœºé—´éš”3-8ç§’ç”Ÿæˆä¸€ä¸ªé¡¾å®¢
      customerInterval = setInterval(() => {
        // å¦‚æœæ¸¸æˆæœªè¿›è¡Œï¼Œåˆ™è·³è¿‡
        if (!state.isPlaying) return;

        // å¦‚æœå½“å‰é¡¾å®¢æ•°é‡å°‘äº5ä¸ªï¼Œåˆ™ç”Ÿæˆæ–°é¡¾å®¢
        if (state.customers.length < 5) {
          spawnCustomer();
        }
      }, 3000 + Math.random() * 5000);  // é—´éš”3000-8000æ¯«ç§’ï¼ˆ3-8ç§’éšæœºï¼‰
    }

    // ==================== æ°´äº•ç³»ç»Ÿ ====================
    /**
     * å¼€å§‹æ‰“æ°´
     * åŠŸèƒ½ï¼šç‚¹å‡»æ°´äº•æŒ‰é’®åï¼Œå¼€å§‹æ‰“æ°´å€’è®¡æ—¶ï¼Œå®Œæˆåè·å¾—1ä¸ªæ°´
     */
    function fetchWater() {
      // å¦‚æœæ­£åœ¨æ‰“æ°´ï¼Œåˆ™å¿½ç•¥ç‚¹å‡»
      if (state.well.fetching) return;

      // è®¡ç®—æ‰“æ°´æ‰€éœ€æ—¶é—´ï¼ˆç§’ï¼‰ï¼šåŸºç¡€3ç§’ Ã— æ°´äº•é€Ÿåº¦ç³»æ•°
      const fetchTime = Math.floor(3 * state.permanent.wellSpeed);

      // è®¾ç½®æ°´äº•çŠ¶æ€ä¸ºæ‰“æ°´ä¸­
      state.well.fetching = true;

      // è®¡ç®—æ‰“æ°´å®Œæˆæ—¶é—´æˆ³ï¼šå½“å‰æ—¶é—´ + æ‰“æ°´æ—¶é—´ï¼ˆæ¯«ç§’ï¼‰
      state.well.finishTime = Date.now() + fetchTime * 1000;

      // ç¦ç”¨æ‰“æ°´æŒ‰é’®ï¼Œé˜²æ­¢é‡å¤ç‚¹å‡»
      document.getElementById('well-btn').disabled = true;

      // æ›´æ”¹æŒ‰é’®æ–‡å­—ä¸º"æ‰“æ°´ä¸­..."
      document.getElementById('well-btn').textContent = 'æ‰“æ°´ä¸­...';

      // æ˜¾ç¤ºè¿›åº¦æ¡
      document.getElementById('well-progress').style.display = 'block';

      // æ˜¾ç¤ºæç¤ºä¿¡æ¯
      showToast('å¼€å§‹æ‰“æ°´ï¼Œéœ€è¦ ' + fetchTime + ' ç§’...');
    }

    /**
     * æ›´æ–°æ°´äº•çŠ¶æ€
     * åŠŸèƒ½ï¼šæ¯ç§’è°ƒç”¨ï¼Œæ›´æ–°æ‰“æ°´è¿›åº¦æ¡ï¼Œæ£€æŸ¥æ˜¯å¦å®Œæˆ
     */
    function updateWell() {
      // å¦‚æœæœªåœ¨æ‰“æ°´ï¼Œåˆ™ç›´æ¥è¿”å›
      if (!state.well.fetching) return;

      // è·å–å½“å‰æ—¶é—´æˆ³
      const now = Date.now();

      // è®¡ç®—æ‰“æ°´è¿›åº¦ï¼š(å½“å‰æ—¶é—´ - å¼€å§‹æ—¶é—´) / æ€»æ—¶é—´
      // å¼€å§‹æ—¶é—´ = å®Œæˆæ—¶é—´ - æ€»æ—¶é—´ï¼ˆ3000æ¯«ç§’ Ã— é€Ÿåº¦ç³»æ•°ï¼‰
      const progress = (now - (state.well.finishTime - 3000 * state.permanent.wellSpeed)) / (3000 * state.permanent.wellSpeed);

      // å°†è¿›åº¦è½¬æ¢ä¸ºç™¾åˆ†æ¯”ï¼ˆ0-100ï¼‰ï¼Œæœ€å¤§ä¸è¶…è¿‡100
      const percent = Math.min(100, Math.floor(progress * 100));

      // æ›´æ–°è¿›åº¦æ¡å®½åº¦
      document.getElementById('well-progress-fill').style.width = percent + '%';

      // æ£€æŸ¥æ˜¯å¦å®Œæˆæ‰“æ°´
      if (now >= state.well.finishTime) {
        // æ‰“æ°´å®Œæˆï¼Œé‡ç½®æ°´äº•çŠ¶æ€
        state.well.fetching = false;

        // åº“å­˜ä¸­æ°´çš„æ•°é‡+1ï¼ˆå¦‚æœä¸å­˜åœ¨åˆ™åˆå§‹åŒ–ä¸º0å†+1ï¼‰
        state.inventory.water = (state.inventory.water || 0) + 1;

        // æ¢å¤æ‰“æ°´æŒ‰é’®
        document.getElementById('well-btn').disabled = false;
        document.getElementById('well-btn').textContent = 'æ‰“æ°´';

        // éšè—è¿›åº¦æ¡
        document.getElementById('well-progress').style.display = 'none';

        // é‡ç½®è¿›åº¦æ¡å®½åº¦ä¸º0
        document.getElementById('well-progress-fill').style.width = '0%';

        // æ›´æ–°åº“å­˜æ˜¾ç¤º
        updateInventory();

        // æ›´æ–°é…æ–¹æ˜¾ç¤ºï¼ˆæ£€æŸ¥æ˜¯å¦å¯åˆ¶ä½œï¼‰
        updateRecipes();

        // æ˜¾ç¤ºè·å¾—æç¤º
        showToast('è·å¾— 1 ä¸ªæ°´ï¼');
      }
    }

    // ==================== å†œç”°ç³»ç»Ÿ ====================
    /**
     * æ›´æ–°ç§å­é€‰æ‹©æ 
     * åŠŸèƒ½ï¼šæ ¹æ®å·²è§£é”çš„ä½œç‰©ï¼ŒåŠ¨æ€ç”Ÿæˆç§å­é€‰æ‹©æŒ‰é’®
     */
    function updateSeedsBar() {
      const seedsBar = document.getElementById('seeds-bar');
      seedsBar.innerHTML = '';  // æ¸…ç©ºç°æœ‰å†…å®¹

      // éå†æ‰€æœ‰ä½œç‰©ç±»å‹
      for (const [type, data] of Object.entries(CROP_DATA)) {
        // åˆ›å»ºç§å­é¡¹å…ƒç´ 
        const seedItem = document.createElement('div');

        // è®¾ç½®CSSç±»åï¼šå¦‚æœå½“å‰é€‰ä¸­åˆ™æ·»åŠ 'selected'ç±»
        seedItem.className = 'seed-item' + (state.selectedSeed === type ? ' selected' : '');

        // æ£€æŸ¥è¯¥ä½œç‰©æ˜¯å¦å·²è§£é”
        const isUnlocked = state.permanent.unlockedCrops.includes(type);
        if (!isUnlocked) seedItem.classList.add('locked');  // æœªè§£é”åˆ™æ·»åŠ 'locked'ç±»

        // è®¾ç½®ç§å­é¡¹HTMLå†…å®¹ï¼šè¡¨æƒ…ç¬¦å·ã€åç§°ã€æ— é™ç¬¦å·
        seedItem.innerHTML = `
          <span>${data.emoji}</span>
          <span>${data.name}</span>
          <span class="unlimited">âˆ</span>
        `;

        // å¦‚æœå·²è§£é”ï¼Œç»‘å®šç‚¹å‡»äº‹ä»¶
        if (isUnlocked) {
          seedItem.onclick = () => selectSeed(type);
        }

        // æ·»åŠ åˆ°ç§å­æ 
        seedsBar.appendChild(seedItem);
      }
    }

    /**
     * é€‰æ‹©ç§å­
     * @param {string} type - ä½œç‰©ç±»å‹ï¼ˆwheat/cow/sugarcane/chickenï¼‰
     * åŠŸèƒ½ï¼šåˆ‡æ¢é€‰ä¸­çŠ¶æ€ï¼Œå–æ¶ˆå…¶ä»–é€‰ä¸­é¡¹
     */
    function selectSeed(type) {
      // å¦‚æœç‚¹å‡»çš„æ˜¯å·²é€‰ä¸­çš„ç§å­ï¼Œåˆ™å–æ¶ˆé€‰ä¸­ï¼›å¦åˆ™é€‰ä¸­è¯¥ç§å­
      state.selectedSeed = state.selectedSeed === type ? null : type;

      // å–æ¶ˆé€‰ä¸­çš„åŸæ–™å’Œé¢åŒ…
      state.selectedIngredient = null;
      state.selectedBread = null;

      // æ›´æ–°ç§å­æ æ˜¾ç¤º
      updateSeedsBar();

      // æ˜¾ç¤ºæç¤ºä¿¡æ¯
      showToast('å·²é€‰æ‹© ' + CROP_DATA[type].name + 'ï¼ˆæ— é™ï¼‰ï¼Œç‚¹å‡»ç©ºåœ°ç§æ¤');
    }

    /**
     * å†œç”°æ ¼å­ç‚¹å‡»äº‹ä»¶å¤„ç†
     * @param {number} index - æ ¼å­ç´¢å¼•ï¼ˆ0-8ï¼‰
     * åŠŸèƒ½ï¼šæ ¹æ®æ ¼å­çŠ¶æ€æ‰§è¡Œæ”¶è·æˆ–ç§æ¤æ“ä½œ
     */
    function onPlotClick(index) {
      const plot = state.crops[index];  // è·å–è¯¥æ ¼å­çš„ä½œç‰©çŠ¶æ€

      // æƒ…å†µ1ï¼šå¦‚æœæ ¼å­æœ‰ä½œç‰©ä¸”å·²æˆç†Ÿä¸”æœªæ”¶è·ï¼Œåˆ™æ‰§è¡Œæ”¶è·
      if (plot && plot.ready && !plot.harvested) {
        harvestCrop(index);
        return;
      }

      // æƒ…å†µ2ï¼šå¦‚æœæ ¼å­ä¸ºç©ºä¸”å·²é€‰ä¸­ç§å­ï¼Œåˆ™æ‰§è¡Œç§æ¤
      if (!plot && state.selectedSeed) {
        plantCrop(index, state.selectedSeed);
      }
    }

    /**
     * ç§æ¤ä½œç‰©
     * @param {number} index - æ ¼å­ç´¢å¼•ï¼ˆ0-8ï¼‰
     * @param {string} type - ä½œç‰©ç±»å‹ï¼ˆwheat/cow/sugarcane/chickenï¼‰
     * åŠŸèƒ½ï¼šåœ¨æŒ‡å®šæ ¼å­ç§æ¤ä½œç‰©ï¼Œè®¡ç®—æˆç†Ÿæ—¶é—´
     */
    function plantCrop(index, type) {
      const data = CROP_DATA[type];  // è·å–ä½œç‰©æ•°æ®

      // è®¡ç®—å®é™…ç”Ÿé•¿æ—¶é—´ï¼ˆç§’ï¼‰ï¼šåŸºç¡€ç”Ÿé•¿æ—¶é—´ Ã— ç”Ÿé•¿é€Ÿåº¦ç³»æ•°
      const growTime = Math.floor(data.growTime * state.permanent.growSpeed);

      // åœ¨æŒ‡å®šæ ¼å­åˆ›å»ºä½œç‰©å¯¹è±¡
      state.crops[index] = {
        type,                                      // ä½œç‰©ç±»å‹
        plantTime: Date.now(),                     // ç§æ¤æ—¶é—´æˆ³
        readyTime: Date.now() + growTime * 1000,   // æˆç†Ÿæ—¶é—´æˆ³ï¼ˆå½“å‰æ—¶é—´ + ç”Ÿé•¿æ—¶é—´æ¯«ç§’ï¼‰
        ready: false,                              // æ˜¯å¦æˆç†Ÿï¼šåˆå§‹ä¸ºfalse
        harvested: false                           // æ˜¯å¦å·²æ”¶è·ï¼šåˆå§‹ä¸ºfalse
      };

      // å–æ¶ˆé€‰ä¸­ç§å­
      state.selectedSeed = null;

      // æ›´æ–°UIæ˜¾ç¤º
      updateSeedsBar();
      updateFarmGrid();

      // æ˜¾ç¤ºæç¤ºä¿¡æ¯
      showToast('ç§æ¤äº† ' + data.name + 'ï¼Œéœ€è¦ ' + growTime + ' ç§’æˆç†Ÿ');
    }

    /**
     * æ”¶è·ä½œç‰©
     * @param {number} index - æ ¼å­ç´¢å¼•ï¼ˆ0-8ï¼‰
     * åŠŸèƒ½ï¼šæ”¶è·æˆç†Ÿçš„ä½œç‰©ï¼Œå°†äº§å‡ºç‰©å“æ·»åŠ åˆ°åº“å­˜
     */
    function harvestCrop(index) {
      const crop = state.crops[index];        // è·å–ä½œç‰©å¯¹è±¡
      const data = CROP_DATA[crop.type];      // è·å–ä½œç‰©æ•°æ®

      // æ ‡è®°ä¸ºå·²æ”¶è·
      crop.harvested = true;

      // æ·»åŠ äº§å‡ºç‰©å“åˆ°åº“å­˜
      const output = data.output;             // äº§å‡ºç‰©å“ID
      state.inventory[output] = (state.inventory[output] || 0) + data.outputCount;
      // åº“å­˜æ•°é‡å¢åŠ ï¼šå¦‚æœä¸å­˜åœ¨åˆ™åˆå§‹åŒ–ä¸º0ï¼Œç„¶ååŠ ä¸Šäº§å‡ºæ•°é‡

      // æ›´æ–°UIæ˜¾ç¤º
      updateFarmGrid();
      updateInventory();
      updateRecipes();

      // æ˜¾ç¤ºæ”¶è·æç¤º
      showToast('æ”¶è·äº† ' + data.outputCount + ' ä¸ª' + ITEM_DATA[output].name + 'ï¼');

      // å»¶è¿Ÿ300æ¯«ç§’åæ¸…ç©ºæ ¼å­ï¼ˆæ’­æ”¾æ”¶è·åŠ¨ç”»åï¼‰
      setTimeout(() => {
        state.crops[index] = null;
        updateFarmGrid();
      }, 300);
    }

    /**
     * æ›´æ–°ä½œç‰©ç”Ÿé•¿çŠ¶æ€
     * åŠŸèƒ½ï¼šæ¯ç§’è°ƒç”¨ï¼Œæ£€æŸ¥æ‰€æœ‰ä½œç‰©æ˜¯å¦æˆç†Ÿ
     */
    function updateCrops() {
      const now = Date.now();  // è·å–å½“å‰æ—¶é—´æˆ³
      let changed = false;     // æ ‡è®°æ˜¯å¦æœ‰ä½œç‰©çŠ¶æ€æ”¹å˜

      // éå†æ‰€æœ‰ä½œç‰©
      state.crops.forEach(crop => {
        // å¦‚æœä½œç‰©å­˜åœ¨ã€æœªæˆç†Ÿã€æœªæ”¶è·ï¼Œä¸”å½“å‰æ—¶é—´å·²è¾¾åˆ°æˆç†Ÿæ—¶é—´
        if (crop && !crop.ready && !crop.harvested && now >= crop.readyTime) {
          crop.ready = true;   // æ ‡è®°ä¸ºæˆç†Ÿ
          changed = true;      // æ ‡è®°æœ‰å˜åŒ–
        }
      });

      // å¦‚æœæœ‰ä½œç‰©çŠ¶æ€æ”¹å˜ï¼Œæ›´æ–°å†œç”°æ˜¾ç¤º
      if (changed) updateFarmGrid();
    }

    /**
     * æ›´æ–°å†œç”°ç½‘æ ¼æ˜¾ç¤º
     * åŠŸèƒ½ï¼šæ ¹æ®ä½œç‰©çŠ¶æ€æ›´æ–°æ¯ä¸ªæ ¼å­çš„æ˜¾ç¤ºå†…å®¹ï¼ˆç©ºåœ°ã€ç”Ÿé•¿ä¸­ã€æˆç†Ÿã€å·²æ”¶è·ï¼‰
     */
    function updateFarmGrid() {
      const plots = document.querySelectorAll('.farm-plot');  // è·å–æ‰€æœ‰å†œç”°æ ¼å­å…ƒç´ 

      // éå†æ‰€æœ‰æ ¼å­
      plots.forEach((plotEl, index) => {
        const crop = state.crops[index];  // è·å–è¯¥æ ¼å­çš„ä½œç‰©çŠ¶æ€
        plotEl.className = 'farm-plot';   // é‡ç½®CSSç±»å
        plotEl.innerHTML = '';            // æ¸…ç©ºå†…å®¹

        // æƒ…å†µ1ï¼šç©ºåœ°ï¼Œæ˜¾ç¤ºåŠé€æ˜çš„ç§å­å›¾æ ‡
        if (!crop) {
        plotEl.innerHTML = '<span style="font-size:1.8rem;opacity:0.3;">ğŸŒ±</span>';
        // å­—ä½“å¤§å°1.8rem (1.5 * 1.2)ï¼Œé€æ˜åº¦30%
          return;
        }

        const data = CROP_DATA[crop.type];  // è·å–ä½œç‰©æ•°æ®

        // æƒ…å†µ2ï¼šå·²æ”¶è·ï¼Œæ˜¾ç¤ºé—ªå…‰ç‰¹æ•ˆ
        if (crop.harvested) {
          plotEl.innerHTML = '<span style="font-size:1.8rem;opacity:0.3;">âœ¨</span>';
          // å­—ä½“å¤§å°1.8rem (1.5 * 1.2)ï¼Œé€æ˜åº¦30%
        }
        // æƒ…å†µ3ï¼šå·²æˆç†Ÿï¼Œæ˜¾ç¤ºä½œç‰©å›¾æ ‡å’Œ"å¯æ”¶è·"æç¤º
        else if (crop.ready) {
          plotEl.classList.add('planted', 'ready');  // æ·»åŠ 'planted'å’Œ'ready'ç±»
          plotEl.innerHTML = `
            <span class="crop-icon">${data.emoji}</span>
            <span class="plot-status">å¯æ”¶è·ï¼</span>
          `;
        }
        // æƒ…å†µ4ï¼šç”Ÿé•¿ä¸­ï¼Œæ˜¾ç¤ºè¿›åº¦æ¡å’Œç™¾åˆ†æ¯”
        else {
          plotEl.classList.add('planted');  // æ·»åŠ 'planted'ç±»

          // è®¡ç®—ç”Ÿé•¿è¿›åº¦ï¼š(å½“å‰æ—¶é—´ - ç§æ¤æ—¶é—´) / (æˆç†Ÿæ—¶é—´ - ç§æ¤æ—¶é—´)
          const progress = (Date.now() - crop.plantTime) / (crop.readyTime - crop.plantTime);

          // è½¬æ¢ä¸ºç™¾åˆ†æ¯”ï¼ˆ0-100ï¼‰ï¼Œæœ€å¤§ä¸è¶…è¿‡100
          const percent = Math.min(100, Math.floor(progress * 100));

          plotEl.innerHTML = `
            <span class="crop-icon">ğŸŒ±</span>
            <div class="progress-bar">
              <div class="progress-fill" style="width: ${percent}%"></div>
            </div>
            <span class="plot-status">${percent}%</span>
          `;
        }
      });
    }

    // ==================== å¸‚åœºç³»ç»Ÿ ====================
    /**
     * æ›´æ–°å¸‚åœºç‰©å“æ˜¾ç¤º
     * åŠŸèƒ½ï¼šæ ¹æ®ç©å®¶é‡‘å¸æ•°é‡ï¼ŒåŠ¨æ€ç”Ÿæˆå¯è´­ä¹°çš„ç‰©å“åˆ—è¡¨
     */
    function updateMarket() {
      const marketItems = document.getElementById('market-items');
      marketItems.innerHTML = '';  // æ¸…ç©ºç°æœ‰å†…å®¹

      // éå†æ‰€æœ‰å¸‚åœºç‰©å“
      MARKET_ITEMS.forEach(item => {
        const itemEl = document.createElement('div');
        itemEl.className = 'market-item';

        // æ£€æŸ¥ç©å®¶æ˜¯å¦æœ‰è¶³å¤Ÿé‡‘å¸è´­ä¹°
        const canAfford = state.gold >= item.price;

        // æ„å»ºç‰©å“HTMLï¼šå›¾æ ‡ã€åç§°ã€æè¿°ã€è´­ä¹°æŒ‰é’®
        itemEl.innerHTML = `
          <div class="market-item-icon">${item.emoji}</div>
          <div class="market-item-info">
            <div class="market-item-name">${item.name}</div>
            <div class="market-item-desc">${item.desc}</div>
          </div>
          <button class="market-btn" ${!canAfford ? 'disabled' : ''} onclick="buyItem('${item.id}')">
            ğŸ’°${item.price}
          </button>
        `;
        // å¦‚æœé‡‘å¸ä¸è¶³ï¼ŒæŒ‰é’®ä¼šè¢«ç¦ç”¨ï¼ˆdisabledå±æ€§ï¼‰

        marketItems.appendChild(itemEl);
      });
    }

    /**
     * è´­ä¹°å¸‚åœºç‰©å“
     * @param {string} itemId - ç‰©å“ID
     * åŠŸèƒ½ï¼šæ‰£é™¤é‡‘å¸ï¼Œå°†ç‰©å“æ·»åŠ åˆ°åº“å­˜
     */
    function buyItem(itemId) {
      // æŸ¥æ‰¾ç‰©å“æ•°æ®
      const item = MARKET_ITEMS.find(i => i.id === itemId);

      // æ£€æŸ¥ç‰©å“æ˜¯å¦å­˜åœ¨ä¸”é‡‘å¸æ˜¯å¦è¶³å¤Ÿ
      if (!item || state.gold < item.price) {
        showToast('é‡‘å¸ä¸è¶³ï¼');
        return;
      }

      // æ‰£é™¤é‡‘å¸
      state.gold -= item.price;

      // åº“å­˜ä¸­è¯¥ç‰©å“æ•°é‡+1
      state.inventory[itemId] = (state.inventory[itemId] || 0) + 1;

      // æ›´æ–°UIæ˜¾ç¤º
      updateHeader();      // æ›´æ–°é¡¶éƒ¨é‡‘å¸æ˜¾ç¤º
      updateMarket();      // æ›´æ–°å¸‚åœºæŒ‰é’®çŠ¶æ€
      updateInventory();   // æ›´æ–°åº“å­˜æ˜¾ç¤º
      updateRecipes();     // æ›´æ–°é…æ–¹å¯åˆ¶ä½œçŠ¶æ€

      // æ˜¾ç¤ºè´­ä¹°æç¤º
      showToast('è´­ä¹°äº† 1 ä¸ª' + item.name + 'ï¼');
    }

    // ==================== åˆ¶ä½œç³»ç»Ÿ ====================
    /**
     * æ›´æ–°åº“å­˜æ˜¾ç¤º
     * åŠŸèƒ½ï¼šæ˜¾ç¤ºç©å®¶å½“å‰æ‹¥æœ‰çš„æ‰€æœ‰åŸæ–™å’Œæ•°é‡
     */
    function updateInventory() {
      const invItems = document.getElementById('inventory-items');

      // æ£€æŸ¥æ˜¯å¦æœ‰åº“å­˜ç‰©å“
      const hasItems = Object.keys(state.inventory).length > 0;
      if (!hasItems) {
        // å¦‚æœæ²¡æœ‰ç‰©å“ï¼Œæ˜¾ç¤ºæç¤ºæ–‡å­—
        invItems.innerHTML = '<div style="color: #999; font-size: 0.7rem;">å»æ‰“æ°´æˆ–è´­ä¹°</div>';
        // ç°è‰²æ–‡å­—ï¼Œå­—ä½“å¤§å°0.7rem
        return;
      }

      // æ¸…ç©ºç°æœ‰å†…å®¹
      invItems.innerHTML = '';

      // éå†æ‰€æœ‰åº“å­˜ç‰©å“
      for (const [item, count] of Object.entries(state.inventory)) {
        if (count <= 0) continue;  // è·³è¿‡æ•°é‡ä¸º0æˆ–è´Ÿæ•°çš„ç‰©å“

        // åˆ›å»ºåº“å­˜ç‰©å“å…ƒç´ 
        const itemEl = document.createElement('div');
        itemEl.className = 'inv-item';
        itemEl.innerHTML = `
          <span>${ITEM_DATA[item].emoji}</span>
          <span class="count">${count}</span>
        `;
        itemEl.title = ITEM_DATA[item].name;  // é¼ æ ‡æ‚¬åœæ—¶æ˜¾ç¤ºç‰©å“åç§°
        invItems.appendChild(itemEl);
      }
    }

    /**
     * é€‰æ‹©åŸæ–™ï¼ˆæœªä½¿ç”¨çš„åŠŸèƒ½ï¼‰
     * @param {string} item - ç‰©å“ID
     * åŠŸèƒ½ï¼šåˆ‡æ¢é€‰ä¸­çŠ¶æ€
     */
    function selectIngredient(item) {
      // å¦‚æœç‚¹å‡»çš„æ˜¯å·²é€‰ä¸­çš„åŸæ–™ï¼Œåˆ™å–æ¶ˆé€‰ä¸­ï¼›å¦åˆ™é€‰ä¸­è¯¥åŸæ–™
      state.selectedIngredient = state.selectedIngredient === item ? null : item;

      // å–æ¶ˆå…¶ä»–é€‰ä¸­é¡¹
      state.selectedSeed = null;
      state.selectedBread = null;

      // æ›´æ–°UIæ˜¾ç¤º
      updateInventory();
      updateRecipes();

      // æ˜¾ç¤ºæç¤º
      showToast('å·²é€‰æ‹© ' + ITEM_DATA[item].name);
    }

    /**
     * æ›´æ–°é…æ–¹ä¹¦æ˜¾ç¤º
     * åŠŸèƒ½ï¼šæ ¹æ®åº“å­˜åŸæ–™ï¼Œæ˜¾ç¤ºæ‰€æœ‰é…æ–¹åŠå…¶å¯åˆ¶ä½œçŠ¶æ€
     */
    function updateRecipes() {
      const recipesList = document.getElementById('recipes-list');
      recipesList.innerHTML = '';  // æ¸…ç©ºç°æœ‰å†…å®¹

      // éå†æ‰€æœ‰é…æ–¹
      RECIPES.forEach(recipe => {
        const recipeEl = document.createElement('div');

        // æ£€æŸ¥æ˜¯å¦å¯ä»¥åˆ¶ä½œï¼šæ‰€æœ‰åŸæ–™æ•°é‡éƒ½å¤§äº0
        const canCraft = recipe.ingredients.every(ing =>
          (state.inventory[ing] || 0) > 0
        );

        // è®¾ç½®CSSç±»åï¼šå¦‚æœå¯åˆ¶ä½œåˆ™æ·»åŠ 'can-craft'ç±»
        recipeEl.className = 'recipe-item' + (canCraft ? ' can-craft' : '');

        // æ„å»ºåŸæ–™å›¾æ ‡HTML
        const ingHtml = recipe.ingredients.map(ing =>
          `<span class="recipe-ing">${ITEM_DATA[ing].emoji}</span>`
        ).join('');

        // è®¡ç®—å®é™…åˆ¶ä½œæ—¶é—´ï¼ˆç§’ï¼‰ï¼šåŸºç¡€æ—¶é—´ Ã— åˆ¶ä½œé€Ÿåº¦ç³»æ•°
        const time = Math.floor(recipe.time * state.permanent.craftSpeed);

        // æ„å»ºé…æ–¹HTMLï¼šåŸæ–™ â†’ ç»“æœ + æ—¶é—´
        recipeEl.innerHTML = `
          <div class="recipe-ingredients">${ingHtml}</div>
          <span class="recipe-arrow">â†’</span>
          <span class="recipe-result">${ITEM_DATA[recipe.output].emoji}</span>
          <span class="recipe-time">${time}ç§’</span>
        `;

        // ç»‘å®šç‚¹å‡»äº‹ä»¶ï¼šç‚¹å‡»é…æ–¹å¼€å§‹åˆ¶ä½œ
        recipeEl.onclick = () => startCrafting(recipe);
        recipesList.appendChild(recipeEl);
      });
    }

    /**
     * å¼€å§‹åˆ¶ä½œç‰©å“
     * @param {Object} recipe - é…æ–¹å¯¹è±¡
     * åŠŸèƒ½ï¼šæ£€æŸ¥åŸæ–™ï¼Œæ¶ˆè€—åŸæ–™ï¼Œå°†åˆ¶ä½œä»»åŠ¡åŠ å…¥é˜Ÿåˆ—
     */
    function startCrafting(recipe) {
      // æ£€æŸ¥æ˜¯å¦æœ‰è¶³å¤Ÿçš„åŸæ–™
      const hasIngredients = recipe.ingredients.every(ing =>
        (state.inventory[ing] || 0) > 0
      );

      // å¦‚æœåŸæ–™ä¸è¶³ï¼Œæ˜¾ç¤ºæç¤ºå¹¶è¿”å›
      if (!hasIngredients) {
        showToast('åŸæ–™ä¸è¶³ï¼');
        return;
      }

      // æ¶ˆè€—åŸæ–™ï¼šæ¯ç§åŸæ–™æ•°é‡-1
      recipe.ingredients.forEach(ing => {
        state.inventory[ing]--;
        // å¦‚æœæ•°é‡é™åˆ°0æˆ–ä»¥ä¸‹ï¼Œä»åº“å­˜ä¸­åˆ é™¤è¯¥ç‰©å“
        if (state.inventory[ing] <= 0) delete state.inventory[ing];
      });

      // è®¡ç®—åˆ¶ä½œæ—¶é—´ï¼ˆç§’ï¼‰ï¼šåŸºç¡€æ—¶é—´ Ã— åˆ¶ä½œé€Ÿåº¦ç³»æ•°
      const craftTime = Math.floor(recipe.time * state.permanent.craftSpeed);

      // å°†åˆ¶ä½œä»»åŠ¡æ·»åŠ åˆ°åˆ¶ä½œé˜Ÿåˆ—
      state.crafting.push({
        recipe,                                      // é…æ–¹å¯¹è±¡
        startTime: Date.now(),                       // å¼€å§‹æ—¶é—´æˆ³
        finishTime: Date.now() + craftTime * 1000,   // å®Œæˆæ—¶é—´æˆ³ï¼ˆå½“å‰æ—¶é—´ + åˆ¶ä½œæ—¶é—´æ¯«ç§’ï¼‰
        finished: false                              // æ˜¯å¦å®Œæˆï¼šåˆå§‹ä¸ºfalse
      });

      // å–æ¶ˆé€‰ä¸­çš„åŸæ–™
      state.selectedIngredient = null;

      // æ›´æ–°UIæ˜¾ç¤º
      updateInventory();
      updateRecipes();
      updateCraftingList();

      // æ˜¾ç¤ºå¼€å§‹åˆ¶ä½œæç¤º
      showToast('å¼€å§‹åˆ¶ä½œ ' + recipe.name + '...');
    }

    /**
     * æ›´æ–°åˆ¶ä½œé˜Ÿåˆ—çŠ¶æ€
     * åŠŸèƒ½ï¼šæ¯ç§’è°ƒç”¨ï¼Œæ£€æŸ¥åˆ¶ä½œä»»åŠ¡æ˜¯å¦å®Œæˆï¼Œå°†äº§å‡ºç‰©å“æ”¾å…¥æŸœå°æˆ–åº“å­˜
     */
    function updateCrafting() {
      const now = Date.now();  // è·å–å½“å‰æ—¶é—´æˆ³
      let changed = false;     // æ ‡è®°æ˜¯å¦æœ‰ä»»åŠ¡å®Œæˆ

      // éå†æ‰€æœ‰åˆ¶ä½œä»»åŠ¡
      state.crafting.forEach(craft => {
        // å¦‚æœä»»åŠ¡æœªå®Œæˆä¸”å½“å‰æ—¶é—´å·²è¾¾åˆ°å®Œæˆæ—¶é—´
        if (!craft.finished && now >= craft.finishTime) {
          craft.finished = true;  // æ ‡è®°ä¸ºå·²å®Œæˆ

          // è·å–äº§å‡ºç‰©å“ID
          const output = craft.recipe.output;

          // åˆ¤æ–­äº§å‡ºç‰©å“ç±»å‹
          if (['white_bread', 'butter_bread', 'sweet_bread', 'cake'].includes(output)) {
            // å¦‚æœæ˜¯æˆå“é¢åŒ…ï¼Œæ”¾åˆ°æŸœå°
            state.counter[output] = (state.counter[output] || 0) + 1;
            updateCounter();
          } else {
            // å¦‚æœæ˜¯åŠæˆå“ï¼ˆé¢å›¢ã€é»„æ²¹é¢å›¢ã€è›‹ç³•ç³Šï¼‰ï¼Œæ”¾åˆ°åº“å­˜
            state.inventory[output] = (state.inventory[output] || 0) + 1;
            updateInventory();
          }

          changed = true;  // æ ‡è®°æœ‰å˜åŒ–
          showToast(ITEM_DATA[output].name + ' åˆ¶ä½œå®Œæˆï¼');
        }
      });

      // æ¸…ç†å·²å®Œæˆçš„ä»»åŠ¡ï¼šè¿‡æ»¤æ‰finishedä¸ºtrueçš„ä»»åŠ¡
      state.crafting = state.crafting.filter(c => !c.finished);

      // å¦‚æœæœ‰ä»»åŠ¡å®Œæˆæˆ–é˜Ÿåˆ—ä¸ºç©ºï¼Œæ›´æ–°åˆ¶ä½œåˆ—è¡¨æ˜¾ç¤º
      if (changed || state.crafting.length === 0) {
        updateCraftingList();
      }
    }

    /**
     * æ›´æ–°åˆ¶ä½œé˜Ÿåˆ—æ˜¾ç¤º
     * åŠŸèƒ½ï¼šæ˜¾ç¤ºæ‰€æœ‰æ­£åœ¨åˆ¶ä½œçš„ç‰©å“åŠå…¶è¿›åº¦æ¡
     */
    function updateCraftingList() {
      const craftingList = document.getElementById('crafting-list');

      // å¦‚æœæ²¡æœ‰æ­£åœ¨åˆ¶ä½œçš„ç‰©å“ï¼Œæ˜¾ç¤ºæç¤ºæ–‡å­—
      if (state.crafting.length === 0) {
        craftingList.innerHTML = '<div style="color: #999; font-size: 0.75rem;">æš‚æ— åˆ¶ä½œä¸­çš„ç‰©å“</div>';
        // ç°è‰²æ–‡å­—ï¼Œå­—ä½“å¤§å°0.75rem
        return;
      }

      // æ¸…ç©ºç°æœ‰å†…å®¹
      craftingList.innerHTML = '';
      const now = Date.now();  // è·å–å½“å‰æ—¶é—´æˆ³

      // éå†æ‰€æœ‰åˆ¶ä½œä»»åŠ¡
      state.crafting.forEach(craft => {
        const recipe = craft.recipe;

        // è®¡ç®—åˆ¶ä½œè¿›åº¦ï¼š(å½“å‰æ—¶é—´ - å¼€å§‹æ—¶é—´) / (å®Œæˆæ—¶é—´ - å¼€å§‹æ—¶é—´)
        const progress = (now - craft.startTime) / (craft.finishTime - craft.startTime);

        // è½¬æ¢ä¸ºç™¾åˆ†æ¯”ï¼ˆ0-100ï¼‰ï¼Œæœ€å¤§ä¸è¶…è¿‡100
        const percent = Math.min(100, Math.floor(progress * 100));

        // åˆ›å»ºåˆ¶ä½œé¡¹å…ƒç´ 
        const craftEl = document.createElement('div');
        craftEl.className = 'crafting-item';
        craftEl.innerHTML = `
          <span style="font-size:1.25rem;">${ITEM_DATA[recipe.output].emoji}</span>
          <div class="crafting-progress">
            <div class="crafting-fill" style="width: ${percent}%"></div>
          </div>
          <span style="font-size:0.7rem;color:#666;">${percent}%</span>
        `;
        // ç‰©å“å›¾æ ‡å­—ä½“å¤§å°1.25remï¼Œç™¾åˆ†æ¯”æ–‡å­—å¤§å°0.7remï¼Œé¢œè‰²ä¸ºç°è‰²

        craftingList.appendChild(craftEl);
      });
    }

    // ==================== å”®å–ç³»ç»Ÿ ====================
    /**
     * æ›´æ–°æŸœå°é¢åŒ…æ˜¾ç¤º
     * åŠŸèƒ½ï¼šæ˜¾ç¤ºæ‰€æœ‰å·²åˆ¶ä½œå®Œæˆçš„é¢åŒ…åŠå…¶ä»·æ ¼å’Œæ•°é‡
     */
    function updateCounter() {
      const counterItems = document.getElementById('counter-items');

      // æ£€æŸ¥æ˜¯å¦æœ‰é¢åŒ…
      const hasBreads = Object.keys(state.counter).length > 0;
      if (!hasBreads) {
        // å¦‚æœæ²¡æœ‰é¢åŒ…ï¼Œæ˜¾ç¤ºæç¤ºæ–‡å­—
        counterItems.innerHTML = '<div style="color: #999; font-size: 0.75rem; width: 100%; text-align: center;">æš‚æ— é¢åŒ…ï¼Œå¿«å»åˆ¶ä½œå§ï¼</div>';
        // ç°è‰²æ–‡å­—ï¼Œå­—ä½“å¤§å°0.75remï¼Œå®½åº¦100%ï¼Œå±…ä¸­å¯¹é½
        return;
      }

      // æ¸…ç©ºç°æœ‰å†…å®¹
      counterItems.innerHTML = '';

      // éå†æ‰€æœ‰æŸœå°é¢åŒ…
      for (const [bread, count] of Object.entries(state.counter)) {
        if (count <= 0) continue;  // è·³è¿‡æ•°é‡ä¸º0æˆ–è´Ÿæ•°çš„é¢åŒ…

        // åˆ›å»ºé¢åŒ…é¡¹å…ƒç´ 
        const itemEl = document.createElement('div');

        // è®¾ç½®CSSç±»åï¼šå¦‚æœå½“å‰é€‰ä¸­åˆ™æ·»åŠ 'selected'ç±»
        itemEl.className = 'counter-item' + (state.selectedBread === bread ? ' selected' : '');

        // æ„å»ºé¢åŒ…HTMLï¼šå›¾æ ‡ã€ä»·æ ¼ã€æ•°é‡
        itemEl.innerHTML = `
          <span class="bread-icon">${ITEM_DATA[bread].emoji}</span>
          <span class="bread-price">ğŸ’°${ITEM_DATA[bread].price}</span>
          <span class="count">${count}</span>
        `;

        // ç»‘å®šç‚¹å‡»äº‹ä»¶ï¼šç‚¹å‡»é€‰ä¸­é¢åŒ…
        itemEl.onclick = () => selectBread(bread);
        counterItems.appendChild(itemEl);
      }
    }

    /**
     * é€‰æ‹©é¢åŒ…
     * @param {string} bread - é¢åŒ…ID
     * åŠŸèƒ½ï¼šåˆ‡æ¢é€‰ä¸­çŠ¶æ€ï¼Œå‡†å¤‡å‡ºå”®ç»™é¡¾å®¢
     */
    function selectBread(bread) {
      // å¦‚æœç‚¹å‡»çš„æ˜¯å·²é€‰ä¸­çš„é¢åŒ…ï¼Œåˆ™å–æ¶ˆé€‰ä¸­ï¼›å¦åˆ™é€‰ä¸­è¯¥é¢åŒ…
      state.selectedBread = state.selectedBread === bread ? null : bread;

      // å–æ¶ˆå…¶ä»–é€‰ä¸­é¡¹
      state.selectedSeed = null;
      state.selectedIngredient = null;

      // æ›´æ–°æŸœå°æ˜¾ç¤º
      updateCounter();

      // æ˜¾ç¤ºæç¤º
      showToast('å·²é€‰æ‹© ' + ITEM_DATA[bread].name + 'ï¼Œç‚¹å‡»é¡¾å®¢å‡ºå”®');
    }

    /**
     * ç”Ÿæˆæ–°é¡¾å®¢
     * åŠŸèƒ½ï¼šéšæœºç”Ÿæˆä¸€ä¸ªé¡¾å®¢ï¼ŒåŒ…æ‹¬å¤–è§‚ã€åå­—ã€éœ€æ±‚ã€è€å¿ƒå€¼
     */
    function spawnCustomer() {
      const types = CUSTOMER_TYPES;  // è·å–é¡¾å®¢ç±»å‹åˆ—è¡¨

      // éšæœºé€‰æ‹©ä¸€ä¸ªé¡¾å®¢ç±»å‹
      const type = types[Math.floor(Math.random() * types.length)];

      // ä»è¯¥ç±»å‹çš„åå­—åˆ—è¡¨ä¸­éšæœºé€‰æ‹©ä¸€ä¸ªåå­—
      const name = type.names[Math.floor(Math.random() * type.names.length)];

      // æ ¹æ®å·²è§£é”çš„ä½œç‰©å†³å®šé¡¾å®¢å¯èƒ½éœ€æ±‚çš„é¢åŒ…ç±»å‹
      let possibleWants = ['white_bread'];  // ç™½é¢åŒ…å§‹ç»ˆå¯ç”¨
      if (state.permanent.unlockedCrops.includes('cow')) possibleWants.push('butter_bread');
      // å¦‚æœè§£é”äº†å¥¶ç‰›ï¼Œæ·»åŠ é»„æ²¹é¢åŒ…
      if (state.permanent.unlockedCrops.includes('sugarcane')) possibleWants.push('sweet_bread');
      // å¦‚æœè§£é”äº†ç”˜è”—ï¼Œæ·»åŠ ç”œé¢åŒ…
      if (state.permanent.unlockedCrops.includes('chicken')) possibleWants.push('cake');
      // å¦‚æœè§£é”äº†æ¯é¸¡ï¼Œæ·»åŠ è›‹ç³•

      // ä»å¯èƒ½çš„éœ€æ±‚ä¸­éšæœºé€‰æ‹©ä¸€ä¸ª
      const want = possibleWants[Math.floor(Math.random() * possibleWants.length)];

      // åˆ›å»ºé¡¾å®¢å¯¹è±¡
      const customer = {
        id: Date.now() + Math.random(),  // å”¯ä¸€IDï¼šå½“å‰æ—¶é—´æˆ³ + éšæœºæ•°
        emoji: type.emoji,               // é¡¾å®¢è¡¨æƒ…ç¬¦å·
        name,                            // é¡¾å®¢åå­—
        want,                            // éœ€æ±‚çš„é¢åŒ…ç±»å‹
        patience: 30                     // è€å¿ƒå€¼ï¼š30ç§’
      };

      // å°†é¡¾å®¢æ·»åŠ åˆ°é¡¾å®¢åˆ—è¡¨
      state.customers.push(customer);

      // æ›´æ–°é¡¾å®¢åˆ—è¡¨æ˜¾ç¤º
      updateCustomersList();
    }

    /**
     * æ›´æ–°é¡¾å®¢çŠ¶æ€
     * åŠŸèƒ½ï¼šæ¯ç§’è°ƒç”¨ï¼Œæ‰€æœ‰é¡¾å®¢è€å¿ƒå€¼-1ï¼Œç§»é™¤è€å¿ƒè€—å°½çš„é¡¾å®¢
     */
    function updateCustomers() {
      let changed = false;  // æ ‡è®°æ˜¯å¦æœ‰é¡¾å®¢ç¦»å¼€

      // è¿‡æ»¤é¡¾å®¢åˆ—è¡¨ï¼šè€å¿ƒå€¼-1ï¼Œç§»é™¤è€å¿ƒå€¼<=0çš„é¡¾å®¢
      state.customers = state.customers.filter(c => {
        c.patience--;  // è€å¿ƒå€¼å‡1
        if (c.patience <= 0) changed = true;  // å¦‚æœè€å¿ƒè€—å°½ï¼Œæ ‡è®°æœ‰å˜åŒ–
        return c.patience > 0;  // åªä¿ç•™è€å¿ƒå€¼>0çš„é¡¾å®¢
      });

      // å¦‚æœæœ‰é¡¾å®¢ç¦»å¼€ï¼Œæ›´æ–°é¡¾å®¢åˆ—è¡¨æ˜¾ç¤º
      if (changed) updateCustomersList();
    }

    /**
     * æ›´æ–°é¡¾å®¢åˆ—è¡¨æ˜¾ç¤º
     * åŠŸèƒ½ï¼šæ˜¾ç¤ºæ‰€æœ‰ç­‰å¾…çš„é¡¾å®¢åŠå…¶éœ€æ±‚ã€è€å¿ƒå€¼
     */
    function updateCustomersList() {
      const customersList = document.getElementById('customers-list');

      // å¦‚æœæ²¡æœ‰é¡¾å®¢ï¼Œæ˜¾ç¤ºæç¤ºæ–‡å­—
      if (state.customers.length === 0) {
        customersList.innerHTML = '<div style="color: #999; font-size: 0.75rem; text-align: center; padding: 0.9rem;">ç­‰å¾…é¡¾å®¢å…‰ä¸´...</div>';
        // ç°è‰²æ–‡å­—ï¼Œå­—ä½“å¤§å°0.75remï¼Œå±…ä¸­å¯¹é½ï¼Œå†…è¾¹è·0.9rem
        return;
      }

      // æ¸…ç©ºç°æœ‰å†…å®¹
      customersList.innerHTML = '';

      // éå†æ‰€æœ‰é¡¾å®¢
      state.customers.forEach(customer => {
        const customerEl = document.createElement('div');
        customerEl.className = 'customer';

        // è·å–é¡¾å®¢éœ€æ±‚çš„ç‰©å“æ•°æ®
        const wantItem = ITEM_DATA[customer.want];

        // æ£€æŸ¥æŸœå°æ˜¯å¦æœ‰è¯¥é¢åŒ…
        const hasBread = (state.counter[customer.want] || 0) > 0;

        // æ„å»ºé¡¾å®¢HTMLï¼šå¤´åƒã€åå­—ã€éœ€æ±‚ã€è€å¿ƒå€¼
        customerEl.innerHTML = `
          <div class="customer-avatar">${customer.emoji}</div>
          <div class="customer-info">
            <div class="customer-name">${customer.name}</div>
            <div class="customer-want">
              æƒ³è¦: <span class="customer-want-emoji">${wantItem.emoji}</span>
              <span style="color:#8B4513;font-weight:bold;">ğŸ’°${wantItem.price}</span>
            </div>
          </div>
          <button class="customer-btn" ${!hasBread ? 'disabled' : ''} onclick="sellBread('${customer.id}')">
            ${hasBread ? 'å‡ºå”®' : 'ç¼ºè´§'}
          </button>
        `;
        // ä»·æ ¼æ–‡å­—é¢œè‰²ä¸ºæ£•è‰²(#8B4513)ï¼ŒåŠ ç²—æ˜¾ç¤º
        // å¦‚æœæŸœå°æ²¡æœ‰è¯¥é¢åŒ…ï¼ŒæŒ‰é’®ä¼šè¢«ç¦ç”¨ï¼Œæ˜¾ç¤º"ç¼ºè´§"

        customersList.appendChild(customerEl);
      });
    }

    /**
     * å‡ºå”®é¢åŒ…ç»™é¡¾å®¢
     * @param {string|number} customerId - é¡¾å®¢ID
     * åŠŸèƒ½ï¼šå°†é¢åŒ…å–ç»™é¡¾å®¢ï¼Œè·å¾—é‡‘å¸ï¼Œç§»é™¤é¡¾å®¢
     */
    function sellBread(customerId) {
      // æŸ¥æ‰¾é¡¾å®¢
      const customer = state.customers.find(c => c.id == customerId);
      if (!customer) return;  // å¦‚æœé¡¾å®¢ä¸å­˜åœ¨ï¼Œç›´æ¥è¿”å›

      // è·å–é¡¾å®¢éœ€æ±‚çš„é¢åŒ…ç±»å‹
      const want = customer.want;

      // æ£€æŸ¥æŸœå°æ˜¯å¦æœ‰è¯¥é¢åŒ…
      if ((state.counter[want] || 0) <= 0) {
        showToast('æŸœå°æ²¡æœ‰ ' + ITEM_DATA[want].name + 'ï¼');
        return;
      }

      // å‡ºå”®é¢åŒ…ï¼šæŸœå°æ•°é‡-1
      state.counter[want]--;
      if (state.counter[want] <= 0) delete state.counter[want];  // å¦‚æœæ•°é‡ä¸º0ï¼Œåˆ é™¤è¯¥é¡¹

      // è·å¾—é‡‘å¸
      const price = ITEM_DATA[want].price;
      state.gold += price;                  // æ€»é‡‘å¸å¢åŠ 
      state.stats.goldEarned += price;      // æœ¬å±€èµšå–é‡‘å¸å¢åŠ 
      state.stats.breadsSold++;             // æœ¬å±€å”®å‡ºé¢åŒ…æ•°é‡+1

      // ç§»é™¤é¡¾å®¢ï¼šä»é¡¾å®¢åˆ—è¡¨ä¸­è¿‡æ»¤æ‰è¯¥é¡¾å®¢
      state.customers = state.customers.filter(c => c.id != customerId);

      // å–æ¶ˆé€‰ä¸­çš„é¢åŒ…
      state.selectedBread = null;

      // æ›´æ–°UIæ˜¾ç¤º
      updateCounter();
      updateCustomersList();
      updateHeader();
      updateMarket();

      // æ˜¾ç¤ºå‡ºå”®æç¤º
      showToast('å”®å‡º ' + ITEM_DATA[want].name + 'ï¼Œè·å¾— ğŸ’°' + price + 'ï¼');
    }

    // ==================== UIæ›´æ–° ====================
    /**
     * æ›´æ–°æ‰€æœ‰UIå…ƒç´ 
     * åŠŸèƒ½ï¼šè°ƒç”¨æ‰€æœ‰UIæ›´æ–°å‡½æ•°ï¼Œåˆ·æ–°æ•´ä¸ªæ¸¸æˆç•Œé¢
     */
    function updateUI() {
      updateHeader();          // æ›´æ–°é¡¶éƒ¨çŠ¶æ€æ ï¼ˆé‡‘å¸ã€å…³å¡ï¼‰
      updateSeedsBar();        // æ›´æ–°ç§å­é€‰æ‹©æ 
      updateFarmGrid();        // æ›´æ–°å†œç”°ç½‘æ ¼
      updateInventory();       // æ›´æ–°åº“å­˜æ˜¾ç¤º
      updateRecipes();         // æ›´æ–°é…æ–¹ä¹¦
      updateCraftingList();    // æ›´æ–°åˆ¶ä½œé˜Ÿåˆ—
      updateMarket();          // æ›´æ–°å¸‚åœºç‰©å“
      updateCounter();         // æ›´æ–°æŸœå°é¢åŒ…
      updateCustomersList();   // æ›´æ–°é¡¾å®¢åˆ—è¡¨
    }

    /**
     * æ›´æ–°é¡¶éƒ¨çŠ¶æ€æ 
     * åŠŸèƒ½ï¼šæ›´æ–°é‡‘å¸æ•°é‡å’Œå…³å¡æ•°æ˜¾ç¤º
     */
    function updateHeader() {
      document.getElementById('gold-display').textContent = state.gold;    // æ˜¾ç¤ºå½“å‰é‡‘å¸æ•°
      document.getElementById('round-display').textContent = state.round;  // æ˜¾ç¤ºå½“å‰å…³å¡æ•°
    }

    /**
     * æ›´æ–°è®¡æ—¶å™¨æ˜¾ç¤º
     * åŠŸèƒ½ï¼šå°†å‰©ä½™ç§’æ•°è½¬æ¢ä¸º"åˆ†:ç§’"æ ¼å¼æ˜¾ç¤º
     */
    function updateTimer() {
      const minutes = Math.floor(state.time / 60);  // è®¡ç®—åˆ†é’Ÿæ•°ï¼šæ€»ç§’æ•° / 60
      const seconds = state.time % 60;              // è®¡ç®—ç§’æ•°ï¼šæ€»ç§’æ•° % 60
      document.getElementById('time-display').textContent =
        `${minutes}:${seconds.toString().padStart(2, '0')}`;
      // æ ¼å¼åŒ–ä¸º"åˆ†:ç§’"ï¼Œç§’æ•°ä¸è¶³2ä½æ—¶å‰é¢è¡¥0ï¼ˆå¦‚ï¼š5:09ï¼‰
    }

    /**
     * æ˜¾ç¤ºæç¤ºä¿¡æ¯
     * @param {string} message - æç¤ºæ–‡å­—
     * åŠŸèƒ½ï¼šåœ¨å±å¹•ä¸Šæ˜¾ç¤ºä¸´æ—¶æç¤ºä¿¡æ¯ï¼Œ2ç§’åè‡ªåŠ¨æ¶ˆå¤±
     */
    function showToast(message) {
      const toast = document.getElementById('toast');
      toast.textContent = message;       // è®¾ç½®æç¤ºæ–‡å­—
      toast.classList.add('show');       // æ·»åŠ 'show'ç±»ï¼Œæ˜¾ç¤ºæç¤ºæ¡†
      setTimeout(() => toast.classList.remove('show'), 2000);  // 2000æ¯«ç§’ï¼ˆ2ç§’ï¼‰åç§»é™¤'show'ç±»ï¼Œéšè—æç¤ºæ¡†
    }

    // ==================== æ¸¸æˆç»“æŸ ====================
    /**
     * ç»“æŸæ¸¸æˆ
     * åŠŸèƒ½ï¼šåœæ­¢æ¸¸æˆå¾ªç¯ï¼Œæ˜¾ç¤ºæœ¬å±€ç»Ÿè®¡æ•°æ®ï¼Œæ‰“å¼€æ¸¸æˆç»“æŸå¼¹çª—
     */
    function endGame() {
      state.isPlaying = false;           // è®¾ç½®æ¸¸æˆçŠ¶æ€ä¸ºæœªè¿›è¡Œ
      clearInterval(gameInterval);       // æ¸…é™¤ä¸»æ¸¸æˆå¾ªç¯å®šæ—¶å™¨
      clearInterval(customerInterval);   // æ¸…é™¤é¡¾å®¢ç”Ÿæˆå®šæ—¶å™¨

      // æ›´æ–°æ¸¸æˆç»“æŸå¼¹çª—ä¸­çš„ç»Ÿè®¡æ•°æ®
      document.getElementById('round-gold').textContent = state.stats.goldEarned;    // æœ¬å±€æ”¶ç›Š
      document.getElementById('round-breads').textContent = state.stats.breadsSold;  // å”®å‡ºé¢åŒ…æ•°
      document.getElementById('total-gold').textContent = state.gold;                // æ€»é‡‘å¸æ•°

      // æ˜¾ç¤ºæ¸¸æˆç»“æŸå¼¹çª—
      document.getElementById('game-over-modal').classList.add('active');
    }

    /**
     * è¿›å…¥ä¸‹ä¸€å±€ï¼ˆæ˜¾ç¤ºå‡çº§å•†åº—ï¼‰
     * åŠŸèƒ½ï¼šå…³é—­æ¸¸æˆç»“æŸå¼¹çª—ï¼Œæ‰“å¼€å‡çº§å•†åº—å¼¹çª—
     */
    function nextRound() {
      document.getElementById('game-over-modal').classList.remove('active');  // å…³é—­æ¸¸æˆç»“æŸå¼¹çª—
      document.getElementById('upgrade-modal').classList.add('active');       // æ‰“å¼€å‡çº§å•†åº—å¼¹çª—
      updateUpgradeShop();  // æ›´æ–°å‡çº§å•†åº—æ˜¾ç¤º
    }
    window.nextRound = nextRound;  // æš´éœ²åˆ°å…¨å±€ä½œç”¨åŸŸï¼Œä¾›HTML onclickè°ƒç”¨

    /**
     * æ›´æ–°å‡çº§å•†åº—æ˜¾ç¤º
     * åŠŸèƒ½ï¼šæ˜¾ç¤ºæ‰€æœ‰å¯è´­ä¹°çš„å‡çº§é¡¹ï¼Œæ ¹æ®é‡‘å¸å’Œè§£é”çŠ¶æ€æ›´æ–°æŒ‰é’®çŠ¶æ€
     */
    function updateUpgradeShop() {
      const shop = document.getElementById('upgrade-shop');
      shop.innerHTML = '';  // æ¸…ç©ºç°æœ‰å†…å®¹

      // éå†æ‰€æœ‰å‡çº§é¡¹
      UPGRADES.forEach(upgrade => {
        const upgradeEl = document.createElement('div');
        upgradeEl.className = 'upgrade-item';

        // æ£€æŸ¥æ˜¯å¦æœ‰è¶³å¤Ÿé‡‘å¸è´­ä¹°
        const canAfford = state.gold >= upgrade.price;

        // æ£€æŸ¥æ˜¯å¦å·²è§£é”ï¼ˆä»…é’ˆå¯¹ä½œç‰©è§£é”ç±»å‡çº§ï¼‰
        const isUnlocked =
          (upgrade.id === 'unlock_cow' && state.permanent.unlockedCrops.includes('cow')) ||
          (upgrade.id === 'unlock_sugarcane' && state.permanent.unlockedCrops.includes('sugarcane')) ||
          (upgrade.id === 'unlock_chicken' && state.permanent.unlockedCrops.includes('chicken'));

        // æ„å»ºå‡çº§é¡¹HTMLï¼šå›¾æ ‡ã€åç§°ã€æè¿°ã€è´­ä¹°æŒ‰é’®
        upgradeEl.innerHTML = `
          <div class="upgrade-icon">${upgrade.emoji}</div>
          <div class="upgrade-info">
            <div class="upgrade-name">${upgrade.name}</div>
            <div class="upgrade-desc">${upgrade.desc}</div>
          </div>
          <button class="upgrade-btn" ${!canAfford || isUnlocked ? 'disabled' : ''} onclick="buyUpgrade('${upgrade.id}')">
            ${isUnlocked ? 'å·²è§£é”' : 'ğŸ’°' + upgrade.price}
          </button>
        `;
        // å¦‚æœé‡‘å¸ä¸è¶³æˆ–å·²è§£é”ï¼ŒæŒ‰é’®ä¼šè¢«ç¦ç”¨
        // å·²è§£é”çš„æ˜¾ç¤º"å·²è§£é”"ï¼Œæœªè§£é”çš„æ˜¾ç¤ºä»·æ ¼

        shop.appendChild(upgradeEl);
      });
    }

    /**
     * è´­ä¹°å‡çº§
     * @param {string} upgradeId - å‡çº§é¡¹ID
     * åŠŸèƒ½ï¼šæ‰£é™¤é‡‘å¸ï¼Œæ‰§è¡Œå‡çº§æ•ˆæœï¼Œæ›´æ–°æ˜¾ç¤º
     */
    function buyUpgrade(upgradeId) {
      // æŸ¥æ‰¾å‡çº§é¡¹
      const upgrade = UPGRADES.find(u => u.id === upgradeId);

      // æ£€æŸ¥å‡çº§æ˜¯å¦å­˜åœ¨ä¸”é‡‘å¸æ˜¯å¦è¶³å¤Ÿ
      if (!upgrade || state.gold < upgrade.price) return;

      // æ‰£é™¤é‡‘å¸
      state.gold -= upgrade.price;

      // æ‰§è¡Œå‡çº§æ•ˆæœå‡½æ•°ï¼ˆä¿®æ”¹æ°¸ä¹…å‡çº§æ•°æ®ï¼‰
      upgrade.effect();

      // æ›´æ–°UIæ˜¾ç¤º
      updateHeader();        // æ›´æ–°é¡¶éƒ¨é‡‘å¸æ˜¾ç¤º
      updateUpgradeShop();   // æ›´æ–°å‡çº§å•†åº—æŒ‰é’®çŠ¶æ€

      // æ˜¾ç¤ºè´­ä¹°æç¤º
      showToast('è´­ä¹°äº† ' + upgrade.name + 'ï¼');
    }

    /**
     * å¼€å§‹ä¸‹ä¸€å±€æ¸¸æˆ
     * åŠŸèƒ½ï¼šå…³å¡æ•°+1ï¼Œå¯åŠ¨æ–°ä¸€å±€
     */
    function startNextRound() {
      state.round++;  // å…³å¡æ•°+1
      startNewRound();  // å¯åŠ¨æ–°ä¸€å±€æ¸¸æˆ
    }
    window.startNextRound = startNextRound;  // æš´éœ²åˆ°å…¨å±€ä½œç”¨åŸŸï¼Œä¾›HTML onclickè°ƒç”¨

    // ==================== å¯åŠ¨æ¸¸æˆ ====================
    /**
     * é¡µé¢åŠ è½½å®Œæˆåè‡ªåŠ¨æ‰§è¡Œ
     * åŠŸèƒ½ï¼šåˆå§‹åŒ–æ¸¸æˆ
     */
    window.onload = init;

    /**
     * æš´éœ²å­˜æ¡£å‡½æ•°åˆ°å…¨å±€ä½œç”¨åŸŸ
     * ä¾›HTMLä¸­çš„å­˜æ¡£æŒ‰é’®è°ƒç”¨
     */
    window.saveGameWithUser = saveGameWithUser;

    // è‡ªåŠ¨åŠ è½½å­˜æ¡£ï¼ˆé¡µé¢åŠ è½½æ—¶å°è¯•æ¢å¤æœ€åä¸€æ¬¡å­˜æ¡£ï¼‰
    // tryAutoLoad();  // æ³¨é‡Šæ‰è‡ªåŠ¨åŠ è½½åŠŸèƒ½ï¼Œé¿å…æ¯æ¬¡åˆ·æ–°éƒ½è‡ªåŠ¨åŠ è½½

    /**
     * ç›‘å¬DOMå†…å®¹åŠ è½½å®Œæˆäº‹ä»¶
     * åŠŸèƒ½ï¼šé¡µé¢DOMåŠ è½½å®Œæˆåï¼Œè‡ªåŠ¨å°è¯•åŠ è½½æœ€åä¸€æ¬¡å­˜æ¡£
     */
    window.addEventListener('DOMContentLoaded', tryAutoLoad);
  </script>
</body>
</html>
